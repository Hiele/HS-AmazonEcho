# -*- coding: iso8859-1 -*-
## -----------------------------------------------------
## Amazon Echo (10013)   ### V0.1
##
## erstellt am: 2016-11-25 15:53
## -----------------------------------------------------
## Copyright © 2016, Werner Lindbüchl, All rights reserved.
##
## This program is free software; you can redistribute it and/or modify it under the terms
## of the GNU General Public License as published by the Free Software Foundation; either
## version 3 of the License, or (at your option) any later version.
##
## This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
## without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
## See the GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License along with this program;
## if not, see <http://www.gnu.de/documents/gpl-3.0.de.html>.

## -- 
## --  

#5000|"Text"|Remanent(1/0)|Anz.Eingänge|.n.|Anzahl Ausgänge|.n.|.n.
5000|"#WJL\Amazon Echo (10013)_V0.1"|0|3|"E1 Https-Server Start/Stop"|"E2 Https-Server Port"|"E3 Access Token"|1|"A1 Systemlog"|"V0.1"

#5001|Anzahl Eingänge|Ausgänge|Offset|Speicher|Berechnung bei Start
5001|3|1|1|1|1

# Eingaenge
#5002|Index Eingang|Default Wert|0=numerisch 1=alphanummerisch
5002|1|0|0	#* E1 Https-Server Start/Stop 
5002|2|0|0	#* E2 Https-Server Port 
5002|3|0|1	#* E3 Access Token 

# Speicher
#5003|Speicher|Initwert|Remanent
5003|1||0		  #* Klassenspeicher 

# Ausgaenge
#5004|ausgang|Initwert|runden binär (0/1)|typ (1-send/2-sbc)|0=numerisch 1=alphanummerisch
5004|1|""|0|1|1 

#################################################

5012|0|"OC[1]"|"eval(compile(__import__('base64').decodestring('CmlmIE9DWzFdPT0xOgogIGdsb2JhbCBhc0RpY3QKICBkZWYgYXNEaWN0KG8pOgogICAgICByZXR1cm4gby5fX2RpY3RfXwogIGdsb2JhbCBIVFRQU2VydmVyCiAgZ2xvYmFsIEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBmcm9tIEJhc2VIVFRQU2VydmVyIGltcG9ydCBIVFRQU2VydmVyLEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBnbG9iYWwgVGhyZWFkaW5nTWl4SW4KICBmcm9tIFNvY2tldFNlcnZlciBpbXBvcnQgVGhyZWFkaW5nTWl4SW4KICBnbG9iYWwgQW1hem9uRWNob1dlYkNhbGxiYWNrCiAgY2xhc3MgQW1hem9uRWNob1dlYkNhbGxiYWNrKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcEl0ZW0sIGNhbGxiYWNrLCBuYW1lLCB0eXBlPSd0ZXh0L2h0bWwnKToKICAgICAgc2VsZi5sb2dpayA9IHBJdGVtCiAgICAgIHNlbGYuY2FsbGJhY2sgPSBjYWxsYmFjawogICAgICBzZWxmLk1DID0gcEl0ZW0uTUMKICAgICAgc2VsZi5VcmxQZmFkID0gbmFtZS51cHBlcigpCiAgICAgIHNlbGYuRGF0TmFtZSA9ICJPUFQvJXMiICUgKHNlbGYuVXJsUGZhZCkKICAgICAgc2VsZi5EYXRMZW4gPSAwCiAgICAgIHNlbGYuVHlwID0gdHlwZQogICAgICBzZWxmLmlzUXVhZCA9IDAKICAgICAgc2VsZi5NQy5HVUkuRXh0RGF0VXJsW3NlbGYuVXJsUGZhZF0gPSBzZWxmCiAgICBkZWYgZ2V0RGF0ZW4oc2VsZik6CiAgICAgIHJldHVybgogICAgZGVmIGdldFF1YWREYXRlbihzZWxmKToKICAgICAgcmV0dXJuIAogICAgZGVmIGdldERhdGVuU3RyZWFtKHNlbGYsIHN0cmVhbSk6CiAgICAgIHNlbGYuRGF0TGVuID0gc2VsZi5jYWxsYmFjayhzdHJlYW0pCiAgICBkZWYgZ2V0UXVhZERhdGVuU3RyZWFtKHNlbGYsIHN0cmVhbSk6CiAgICAgIHNlbGYuZ2V0RGF0ZW5TdHJlYW0oc3RyZWFtKQogIGdsb2JhbCBBbWF6b25FY2hvCiAgY2xhc3MgQW1hem9uRWNobyhUaHJlYWRpbmdNaXhJbiwgSFRUUFNlcnZlcik6CiAgICBQQVRIX0JBU0UgPSAiL3RtcC8iCiAgICBGSUxFTkFNRV9DRVJUID0gImFtYXpvbkVjaG9TU0wuY2VydCIKICAgIEZJTEVQQVRIX0NFUlQgPSBQQVRIX0JBU0UgKyBGSUxFTkFNRV9DRVJUCiAgICBGSUxFTkFNRV9BUFBMSUFOQ0VTID0gImFtYXpvbkVjaG9BcHBsaWFuY2VzLmpzIgogICAgRklMRVBBVEhfQVBQTElBTkNFUyA9IFBBVEhfQkFTRSArIEZJTEVOQU1FX0FQUExJQU5DRVMKICAgIFVSTF9CQVNFID0gImFtYXpvbkVjaG8vIgogICAgVVJMX1NIT1dfU1NMID0gVVJMX0JBU0UgKyAic3NsQ2VydC5odG0iCiAgICBhbGxvd19yZXVzZV9hZGRyZXNzID0gVHJ1ZQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGxvY2Fscyk6CiAgICAgIHNlbGYubG9jYWxzID0gbG9jYWxzOwogICAgICBzZWxmLmxvZ2lrID0gbG9jYWxzWydwSXRlbSddCiAgICAgIHNlbGYuTUMgPSBzZWxmLmxvZ2lrLk1DCiAgICAgIHNlbGYuaXAgPSBzZWxmLk1DLkV0aGVybmV0LklQQWRyCiAgICAgIEVOID0gbG9jYWxzWydFTiddCiAgICAgIHNlbGYucG9ydCA9IGludChFTlsyXSkKICAgICAgc2VsZi5hY2Nlc3NUb2tlbiA9IEVOWzNdCiAgICAgIHNlbGYuaWQgPSAnQW1hem9uX0VjaG9fU2VydmVyJwogICAgICBzZWxmLnNlcnZlclRocmVhZCA9IE5vbmUKICAgICAgc2VsZi5jZXJ0VGV4dCA9IHNlbGYuZ2V0U1NMQ2VydChzZWxmLmlwLCBzZWxmLkZJTEVOQU1FX0NFUlQpCiAgICAgIHNlbGYuaW5pdEFwcGxpYW5jZXMoKQogICAgICBBbWF6b25FY2hvV2ViQ2FsbGJhY2soc2VsZi5sb2dpaywgc2VsZi53ZWJDYWxsYmFja1NTTENlcnQsIHNlbGYuVVJMX1NIT1dfU1NMKQogICAgICBzZWxmLmluaXRfZGVidWdfZW50cnkoKTsKICAgIGRlZiBpbml0QXBwbGlhbmNlcyhzZWxmKToKICAgICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihzZWxmLkZJTEVQQVRIX0FQUExJQU5DRVMsICdyJykgYXMgbXlmaWxlOgogICAgICAgICAgZGF0YT1teWZpbGUucmVhZCgpCiAgICAgICAgaW1wb3J0IGpzb24KICAgICAgICBzZWxmLmNvbmYgPSBqc29uLmxvYWRzKGRhdGEsIGVuY29kaW5nPSJpc284ODU5LTEiKQogICAgICBleGNlcHQ6CiAgICAgICAgc2VsZi5jb25mID0gIiIKICAgICAgc2VsZi5hcHBsaWFuY2VzID0gW10KICAgICAgaWYgc2VsZi5jb25mID09ICIiOgogICAgICAgIHNlbGYuZGlzY292ZXJBcHBsaWFuY2VzKCkKICAgIGRlZiBkaXNjb3ZlckFwcGxpYW5jZXMoc2VsZik6CiAgICAgIGltcG9ydCByZQogICAgICByZWdleCA9IHJlLmNvbXBpbGUoIiguKilcW1xzKihTd2l0Y2hhYmxlfExpZ2h0aW5nKVxzKlxdXHMqJCIpCiAgICAgIGZvciBpa28gaW4gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3Q6IAogICAgICAgIGtvID0gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3RbaWtvXQogICAgICAgIG1hdGNoID0gcmVnZXguc2VhcmNoKGtvLlJQQ1RleHQpCiAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICBhcHBsaWFuY2UgPSBBbWF6b25FY2hvLktOWEFwcGxpYW5jZShrbywgbWF0Y2guZ3JvdXBzKClbMF0uc3RyaXAoKSwgbWF0Y2guZ3JvdXBzKClbMV0pCiAgICAgICAgICBzZWxmLmFwcGxpYW5jZXMuYXBwZW5kKGFwcGxpYW5jZSkKICAgIGNsYXNzIEtOWEFwcGxpYW5jZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwga28sIGZyaWVuZGx5TmFtZSwgdHlwZSk6CiAgICAgICAgc2VsZi5rbyA9IGtvCiAgICAgICAgc2VsZi5mcmllbmRseU5hbWUgPSBmcmllbmRseU5hbWUKICAgICAgICBzZWxmLnR5cGUgPSB0eXBlCiAgICBkZWYgZGlzY292ZXJ5KHNlbGYsIG1lc3NhZ2VJZCk6CiAgICAgIHJlc3BvbnNlT2JqZWN0ID0gQW1hem9uRWNoby5EaXNjb3ZlcnlSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgIGlmIHNlbGYuY29uZiAhPSAiIjoKICAgICAgICBpZCA9IDAKICAgICAgICBmb3IgZGV2aWNlIGluIHNlbGYuY29uZjoKICAgICAgICAgIHJvb20gPSBkZXZpY2UuZ2V0KCdyb29tJykKICAgICAgICAgIGlkICs9IDEKICAgICAgICAgIGlkU3RyID0gc3RyKGlkKQogICAgICAgICAgamQgPSAwCiAgICAgICAgICBmb3IgYXBwbGlhbmNlIGluIGRldmljZVsnYXBwbGlhbmNlcyddOgogICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgIHR5cGUgPSAnU3dpdGNoYWJsZScKICAgICAgICAgICAgcGVyY2VudCA9IGFwcGxpYW5jZS5nZXQoJ3BlcmNlbnQnKTsKICAgICAgICAgICAgaWYgcGVyY2VudCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICB0eXBlID0gJ0xpZ2h0aW5nJwogICAgICAgICAgICBpZiByb29tICE9ICIiOgogICAgICAgICAgICAgIGlmIGpkID09IDE6CiAgICAgICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciwgcm9vbSwgdHlwZSkKICAgICAgICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgICAgICAgICAgbmFtZSA9IHJvb20gKyAiICIgKyBhcHBsaWFuY2VbJ25hbWUnXQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgIG5hbWUgPSBhcHBsaWFuY2VbJ25hbWUnXQogICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciArICJfIiArIHN0cihqZCksIG5hbWUsIHR5cGUpCiAgICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgICAgICAgIGFsaWFzZXMgPSBhcHBsaWFuY2UuZ2V0KCdhbGlhc2VzJyk7CiAgICAgICAgICAgIGlmIGFsaWFzZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgZm9yIGFsaWFzIGluIGFsaWFzZXM6CiAgICAgICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciArICJfIiArIHN0cihqZCksIGFsaWFzLCB0eXBlKQogICAgICAgICAgICAgICAgcmVzcG9uc2VPYmplY3QuYWRkQXBwbGlhbmNlKGRpc2NvdmVyeUFwcGxpYW5jZSkKICAgICAgZWxzZToKICAgICAgICBmb3IgYXBwbGlhbmNlIGluIHNlbGYuYXBwbGlhbmNlczoKICAgICAgICAgIGtvID0gYXBwbGlhbmNlLmtvCiAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShzdHIoa28uSUQpLCBhcHBsaWFuY2UuZnJpZW5kbHlOYW1lLCBhcHBsaWFuY2UudHlwZSkKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgIHJldHVybiByZXNwb25zZU9iamVjdAogICAgZGVmIGNvbnRyb2woc2VsZiwgbWVzc2FnZUlkLCBhcHBsaWFuY2VJZCwgcmVxdWVzdCwgdmFsdWUpOgogICAgICByZXNwb25zZU9iamVjdCA9IEFtYXpvbkVjaG8uQ29udHJvbFJlc3BvbnNlKG1lc3NhZ2VJZCkKICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5zdXBwb3J0ZWRPcGVyYXRpb25FcnJvciIpCiAgICAgIGFwcGxpYW5jZSA9IHNlbGYuZmluZEFwcGxpYW5jZShhcHBsaWFuY2VJZCkKICAgICAgaWYgYXBwbGlhbmNlIGlzIG5vdCBOb25lOgogICAgICAgIG9uVmFsdWUgPSAxLjAKICAgICAgICBvZmZWYWx1ZSA9IDAuMAogICAgICAgIGlmIHR5cGUoYXBwbGlhbmNlKSBpcyBub3QgQW1hem9uRWNoby5LTlhBcHBsaWFuY2U6CiAgICAgICAgICBvbk9mZktvID0gc2VsZi5maW5kS28oYXBwbGlhbmNlWydvbk9mZiddKQogICAgICAgICAgaWYgb25PZmZLbyBpcyBOb25lOgogICAgICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJOb1N1Y2hUYXJnZXRFcnJvciIpCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZU9iamVjdAogICAgICAgICAgcGVyY2VudCA9IGFwcGxpYW5jZS5nZXQoJ3BlcmNlbnQnKTsKICAgICAgICAgIGlmIHBlcmNlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGFwcGxpYW5jZVR5cGUgPSAiTGlnaHRpbmciCiAgICAgICAgICAgIHBlcmNlbnRLbyA9IHNlbGYuZmluZEtvKGFwcGxpYW5jZVsncGVyY2VudCddKQogICAgICAgICAgZWxzZToKICAgICAgICAgICAgYXBwbGlhbmNlVHlwZSA9ICJTd2l0Y2hhYmxlIgogICAgICAgICAgYXBwbGlhbmNlVmFsdWUgPSBhcHBsaWFuY2UuZ2V0KCd2YWx1ZScpCiAgICAgICAgICBpZiBhcHBsaWFuY2VWYWx1ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgb25WYWx1ZSA9IGFwcGxpYW5jZVZhbHVlCiAgICAgICAgZWxzZToKICAgICAgICAgIGFwcGxpYW5jZVR5cGUgPSBhcHBsaWFuY2UudHlwZQogICAgICAgICAgb25PZmZLbyA9IHBlcmNlbnRLbyA9IGFwcGxpYW5jZS5rbwogICAgICAgICAgaWYgYXBwbGlhbmNlVHlwZSA9PSAiTGlnaHRpbmciOgogICAgICAgICAgICBvblZhbHVlID0gMTAwLjAKICAgICAgICBpZiBhcHBsaWFuY2VUeXBlID09ICJMaWdodGluZyI6CiAgICAgICAgICBpZiByZXF1ZXN0ID09ICdUdXJuT25SZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YU2V0VmFsdWUob25PZmZLbywgb25WYWx1ZSwgIlR1cm5PbkNvbmZpcm1hdGlvbiIsIHJlc3BvbnNlT2JqZWN0KQogICAgICAgICAgZWxpZiByZXF1ZXN0ID09ICdUdXJuT2ZmUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKG9uT2ZmS28sIG9mZlZhbHVlLCAiVHVybk9mZkNvbmZpcm1hdGlvbiIsIHJlc3BvbnNlT2JqZWN0KQogICAgICAgICAgZWxpZiByZXF1ZXN0ID09ICdTZXRQZXJjZW50YWdlUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFBlcmNlbnQocGVyY2VudEtvLCB2YWx1ZSwgIlNldFBlcmNlbnRhZ2VDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnSW5jcmVtZW50UGVyY2VudGFnZVJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhBZGRQZXJjZW50KHBlcmNlbnRLbywgdmFsdWUsIDEsICJJbmNyZW1lbnRQZXJjZW50YWdlQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgICBlbGlmIHJlcXVlc3QgPT0gJ0RlY3JlbWVudFBlcmNlbnRhZ2VSZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YQWRkUGVyY2VudChwZXJjZW50S28sIHZhbHVlLCAtMSwgIkRlY3JlbWVudFBlcmNlbnRhZ2VDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbGlmIGFwcGxpYW5jZVR5cGUgPT0gIlN3aXRjaGFibGUiOgogICAgICAgICAgaWYgcmVxdWVzdCA9PSAnVHVybk9uUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKG9uT2ZmS28sIG9uVmFsdWUsICJUdXJuT25Db25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnVHVybk9mZlJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShvbk9mZktvLCBvZmZWYWx1ZSwgIlR1cm5PZmZDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbHNlOgogICAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgIGVsc2U6CiAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiTm9TdWNoVGFyZ2V0RXJyb3IiKQogICAgICByZXR1cm4gcmVzcG9uc2VPYmplY3QKICAgIGRlZiBfS05YQWRkUGVyY2VudChzZWxmLCBrbywgdmFsdWUsIHNpZ24sIG5hbWUsIHJlc3BvbnNlT2JqZWN0KToKICAgICAgdHJ5OgogICAgICAgIGZ2YWx1ZSA9IGtvLmdldFdlcnQoKSArIChzaWduICogZmxvYXQodmFsdWUpKQogICAgICAgIGlmIGZ2YWx1ZSA8IDAuMDoKICAgICAgICAgIGZ2YWx1ZSA9IDAuMAogICAgICAgIGVsaWYgZnZhbHVlID4gMTAwLjA6CiAgICAgICAgICBmdmFsdWUgPSAxMDAuMAogICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKGtvLCBmdmFsdWUsIG5hbWUsIHJlc3BvbnNlT2JqZWN0KQogICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJVbnN1cHBvcnRlZFRhcmdldFNldHRpbmdFcnJvciIpCiAgICBkZWYgX0tOWFNldFBlcmNlbnQoc2VsZiwga28sIHZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCk6CiAgICAgIHRyeToKICAgICAgICBmdmFsdWUgPSBmbG9hdCh2YWx1ZSkKICAgICAgICBpZiBmdmFsdWUgPj0gMC4wIGFuZCBmdmFsdWUgPD0gMTAwLjA6CiAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShrbywgZnZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbHNlOgogICAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVmFsdWVPdXRPZlJhbmdlRXJyb3IiKQogICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJVbnN1cHBvcnRlZFRhcmdldFNldHRpbmdFcnJvciIpCiAgICBkZWYgX0tOWFNldFZhbHVlKHNlbGYsIGtvLCBmdmFsdWUsIG5hbWUsIHJlc3BvbnNlT2JqZWN0KToKICAgICAgc2VsZi5sb2dpay5NQy5UYWdMaXN0LnNldFdlcnQoRkxBR19FSUJfTE9HSUssIGtvLCBmdmFsdWUpCiAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUobmFtZSkKICAgIGRlZiBmaW5kQXBwbGlhbmNlKHNlbGYsIGFwcGxpYW5jZUlkKToKICAgICAgaWYgc2VsZi5jb25mICE9ICIiOgogICAgICAgIGlkID0gMAogICAgICAgIGZvciBkZXZpY2UgaW4gc2VsZi5jb25mOgogICAgICAgICAgcm9vbSA9IGRldmljZVsncm9vbSddCiAgICAgICAgICBpZCArPSAxCiAgICAgICAgICBpZFN0ciA9IHN0cihpZCkKICAgICAgICAgIGlmIGFwcGxpYW5jZUlkID09IGlkU3RyOgogICAgICAgICAgICByZXR1cm4gZGV2aWNlWydhcHBsaWFuY2VzJ11bMF0KICAgICAgICAgIGpkID0gMAogICAgICAgICAgZm9yIGFwcGxpYW5jZSBpbiBkZXZpY2VbJ2FwcGxpYW5jZXMnXToKICAgICAgICAgICAgamQgKz0gMQogICAgICAgICAgICBpZiBhcHBsaWFuY2VJZCA9PSBpZFN0ciArICJfIiArIHN0cihqZCk6CiAgICAgICAgICAgICAgcmV0dXJuIGFwcGxpYW5jZQogICAgICAgICAgICBhbGlhc2VzID0gYXBwbGlhbmNlLmdldCgnYWxpYXNlcycpOwogICAgICAgICAgICBpZiBhbGlhc2VzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgIGZvciBhbGlhcyBpbiBhbGlhc2VzOgogICAgICAgICAgICAgICAgamQgKz0gMQogICAgICAgICAgICAgICAgaWYgYXBwbGlhbmNlSWQgPT0gaWRTdHIgKyAiXyIgKyBzdHIoamQpOgogICAgICAgICAgICAgICAgICByZXR1cm4gYXBwbGlhbmNlCiAgICAgIGVsc2U6CiAgICAgICAgZm9yIGFwcGxpYW5jZSBpbiBzZWxmLmFwcGxpYW5jZXM6CiAgICAgICAgICBrbyA9IGFwcGxpYW5jZS5rbwogICAgICAgICAgaWYgc3RyKGtvLklEKSA9PSBhcHBsaWFuY2VJZDoKICAgICAgICAgICAgcmV0dXJuIGFwcGxpYW5jZQogICAgICByZXR1cm4gTm9uZQogICAgZGVmIGZpbmRLbyhzZWxmLCBncnBBZHJTdHIpOgogICAgICBmb3IgaWtvIGluIHNlbGYuTUMuVGFnTGlzdC5UYWdMaXN0OiAKICAgICAgICBrbyA9IHNlbGYuTUMuVGFnTGlzdC5UYWdMaXN0W2lrb10KICAgICAgICBpZiBrby5HcnBBZHJTdHIgPT0gZ3JwQWRyU3RyOgogICAgICAgICAgcmV0dXJuIGtvCiAgICAgIHJldHVybiBOb25lOwogICAgY2xhc3MgSGVhZGVyKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtZXNzYWdlSWQsIG5hbWUsIG5hbWVzcGFjZSwgcGF5bG9hZFZlcnNpb24pOgogICAgICAgIHNlbGYubWVzc2FnZUlkID0gbWVzc2FnZUlkCiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHNlbGYubmFtZXNwYWNlID0gbmFtZXNwYWNlCiAgICAgICAgc2VsZi5wYXlsb2FkVmVyc2lvbiA9IHBheWxvYWRWZXJzaW9uCiAgICBjbGFzcyBDb250cm9sUmVzcG9uc2UoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIG1lc3NhZ2VJZCk6CiAgICAgICAgc2VsZi5oZWFkZXIgPSBBbWF6b25FY2hvLkhlYWRlcihtZXNzYWdlSWQsICIiLCAiQWxleGEuQ29ubmVjdGVkSG9tZS5Db250cm9sIiwgIjIiKQogICAgICAgIHNlbGYucGF5bG9hZCA9IHt9CiAgICAgIGRlZiBzZXROYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYuaGVhZGVyLm5hbWUgPSBuYW1lCiAgICBjbGFzcyBEaXNjb3ZlcnlSZXNwb25zZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwgbWVzc2FnZUlkKToKICAgICAgICBzZWxmLmhlYWRlciA9IEFtYXpvbkVjaG8uSGVhZGVyKG1lc3NhZ2VJZCwgIkRpc2NvdmVyQXBwbGlhbmNlc1Jlc3BvbnNlIiwgIkFsZXhhLkNvbm5lY3RlZEhvbWUuRGlzY292ZXJ5IiwgIjIiKQogICAgICAgIHNlbGYucGF5bG9hZCA9IEFtYXpvbkVjaG8uRGlzY292ZXJ5UGF5bG9hZCgpCiAgICAgIGRlZiBzZXROYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYuaGVhZGVyLm5hbWUgPSBuYW1lCiAgICAgIGRlZiBhZGRBcHBsaWFuY2Uoc2VsZiwgYXBwbGlhbmNlKToKICAgICAgICBzZWxmLnBheWxvYWQuZGlzY292ZXJlZEFwcGxpYW5jZXMuYXBwZW5kKGFwcGxpYW5jZSkKICAgIGNsYXNzIERpc2NvdmVyeVBheWxvYWQoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuZGlzY292ZXJlZEFwcGxpYW5jZXMgPSBbXQogICAgY2xhc3MgRGlzY292ZXJ5QXBwbGlhbmNlKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhcHBsaWFuY2VJZCwgZnJpZW5kbHlOYW1lLCBhcHBsaWFuY2VUeXBlKToKICAgICAgICBzZWxmLmFwcGxpYW5jZUlkID0gYXBwbGlhbmNlSWQKICAgICAgICBzZWxmLmZyaWVuZGx5RGVzY3JpcHRpb24gPSBmcmllbmRseU5hbWUKICAgICAgICBzZWxmLmZyaWVuZGx5TmFtZSA9IGZyaWVuZGx5TmFtZQogICAgICAgIHNlbGYuaXNSZWFjaGFibGUgPSBUcnVlCiAgICAgICAgc2VsZi5tYW51ZmFjdHVyZXJOYW1lID0gIm4uYS4iCiAgICAgICAgc2VsZi5tb2RlbE5hbWUgPSAibi5hLiIKICAgICAgICBzZWxmLnZlcnNpb24gPSAiMS4wIgogICAgICAgIGlmIGFwcGxpYW5jZVR5cGUgPT0gIlN3aXRjaGFibGUiOgogICAgICAgICAgc2VsZi5hY3Rpb25zID0gWyJ0dXJuT24iLCAidHVybk9mZiJdCiAgICAgICAgZWxpZiBhcHBsaWFuY2VUeXBlID09ICJMaWdodGluZyI6CiAgICAgICAgICBzZWxmLmFjdGlvbnMgPSBbInR1cm5PbiIsICJ0dXJuT2ZmIiwgImluY3JlbWVudFBlcmNlbnRhZ2UiLCAiZGVjcmVtZW50UGVyY2VudGFnZSIsICJzZXRQZXJjZW50YWdlIl0KICAgICAgICBlbGlmIGFwcGxpY2FuY2VUeXBlID09ICJUaGVybW9zdGF0IjoKICAgICAgICAgIHNlbGYuYWN0aW9ucyA9IFsiaW5jcmVtZW50VGFyZ2V0VGVtcGVyYXR1cmUiLCAiZGVjcmVtZW50VGFyZ2V0VGVtcGVyYXR1cmUiLCAic2V0VGFyZ2V0VGVtcGVyYXR1cmUiXQogICAgY2xhc3MgSFRUUFJlcXVlc3RIYW5kbGVyKEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIpOgogICAgICBkZWYgYWRkcmVzc19zdHJpbmcoc2VsZik6CiAgICAgICAgICBob3N0LCBwb3J0ID0gc2VsZi5jbGllbnRfYWRkcmVzc1s6Ml0KICAgICAgICAgIHJldHVybiBob3N0CiAgICAgIGRlZiBsb2dfcmVxdWVzdChzZWxmLCBjb2RlPU5vbmUsIHNpemU9Tm9uZSk6CiAgICAgICAgcGFzcwogICAgICBkZWYgbG9nX21lc3NhZ2Uoc2VsZiwgZm9ybWF0LCAqYXJncyk6CiAgICAgICAgcGFzcwogICAgICBkZWYgZG9fUE9TVChzZWxmKToKICAgICAgICBzZWxmLnBvc3R2YXJzID0gc2VsZi5wYXJzZV9QT1NUKCkKICAgICAgICBzZWxmLmRvX1JFUSgpCiAgICAgIGRlZiBwYXJzZV9QT1NUKHNlbGYpOgogICAgICAgIGZyb20gY2dpIGltcG9ydCBwYXJzZV9oZWFkZXIsIHBhcnNlX211bHRpcGFydAogICAgICAgIGZyb20gdXJscGFyc2UgaW1wb3J0IHBhcnNlX3FzCiAgICAgICAgY3R5cGUsIHBkaWN0ID0gcGFyc2VfaGVhZGVyKHNlbGYuaGVhZGVyc1snY29udGVudC10eXBlJ10pCiAgICAgICAgaWYgY3R5cGUgPT0gJ211bHRpcGFydC9mb3JtLWRhdGEnOgogICAgICAgICAgICBwb3N0dmFycyA9IHBhcnNlX211bHRpcGFydChzZWxmLnJmaWxlLCBwZGljdCkKICAgICAgICBlbGlmIGN0eXBlID09ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnOgogICAgICAgICAgICBsZW5ndGggPSBpbnQoc2VsZi5oZWFkZXJzWydjb250ZW50LWxlbmd0aCddKQogICAgICAgICAgICBwb3N0dmFycyA9IHBhcnNlX3FzKAogICAgICAgICAgICAgICAgICAgIHNlbGYucmZpbGUucmVhZChsZW5ndGgpLCAKICAgICAgICAgICAgICAgICAgICBrZWVwX2JsYW5rX3ZhbHVlcz0xKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBvc3R2YXJzID0ge30KICAgICAgICByZXR1cm4gcG9zdHZhcnMKICAgICAgZGVmIGRvX0dFVChzZWxmKToKICAgICAgICBzZWxmLnBvc3R2YXJzID0gTm9uZQogICAgICAgIHNlbGYuZG9fUkVRKCkKICAgICAgZGVmIGRvX1JFUShzZWxmKToKICAgICAgICBhY2Nlc3NUb2tlbiA9IE5vbmUKICAgICAgICBtZXNzYWdlSWQgPSBOb25lCiAgICAgICAgdHJ5OgogICAgICAgICAgaWR4ID0gc2VsZi5wYXRoLmluZGV4KCI/IikKICAgICAgICAgIHNlbGYuY29tbWFuZCA9IHNlbGYucGF0aFsxOmlkeF0KICAgICAgICAgIHJlcVBhcmFtcyA9IHNlbGYuX2J1aWxkUmVxUGFyYW1NYXAoc2VsZi5wYXRoW2lkeCsxOl0pCiAgICAgICAgICBhY2Nlc3NUb2tlbiA9IHJlcVBhcmFtcy5nZXQoJ2FjY2Vzc1Rva2VuJykKICAgICAgICAgIG1lc3NhZ2VJZCA9IHJlcVBhcmFtcy5nZXQoJ21lc3NhZ2VJZCcpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICBzZWxmLmNvbW1hbmQgPSBzZWxmLnBhdGhbMTpdCiAgICAgICAgaWYgc2VsZi5jb21tYW5kID09ICdjb25maWcnOgogICAgICAgICAgaWYgYWNjZXNzVG9rZW4gIT0gc2VsZi5zZXJ2ZXIuYWNjZXNzVG9rZW46CiAgICAgICAgICAgIHNlbGYuc2VuZF9lcnJvcig0MDEsICdNaXNzaW5nIG9yIGludmFsaWQgYWNjZXNzIHRva2VuJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICBzZWxmLl9jb25maWcoKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgbWVzc2FnZUlkIGlzIE5vbmU6CiAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UoIiIsICJVbmV4cGVjdGVkSW5mb3JtYXRpb25SZWNlaXZlZEVycm9yIikKICAgICAgICAgIHJldHVybgogICAgICAgIGlmIGFjY2Vzc1Rva2VuIGlzIE5vbmU6CiAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UobWVzc2FnZUlkLCAiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBhY2Nlc3NUb2tlbiAhPSBzZWxmLnNlcnZlci5hY2Nlc3NUb2tlbjoKICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZShtZXNzYWdlSWQsICJJbnZhbGlkQWNjZXNzVG9rZW5FcnJvciIpCiAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBzZWxmLmNvbW1hbmQgPT0gJ2NvbnRyb2wnOgogICAgICAgICAgdHJ5OgogICAgICAgICAgICByZXF1ZXN0ID0gcmVxUGFyYW1zWydyZXF1ZXN0J10KICAgICAgICAgICAgYXBwbGlhbmNlSWQgPSByZXFQYXJhbXNbJ2FwcGxpYW5jZUlkJ10KICAgICAgICAgICAgdmFsdWUgPSByZXFQYXJhbXMuZ2V0KCd2YWx1ZScsIE5vbmUpCiAgICAgICAgICBleGNlcHQgKEtleUVycm9yKToKICAgICAgICAgICAgc2VsZi5fc2VuZEpzb25FcnJvclJlc3BvbnNlKG1lc3NhZ2VJZCwgIlVuZXhwZWN0ZWRJbmZvcm1hdGlvblJlY2VpdmVkRXJyb3IiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gc2VsZi5zZXJ2ZXIuY29udHJvbChtZXNzYWdlSWQsIGFwcGxpYW5jZUlkLCByZXF1ZXN0LCB2YWx1ZSkKICAgICAgICAgIHNlbGYuX3NlbmRKc29uUmVzcG9uc2UocmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxpZiBzZWxmLmNvbW1hbmQgPT0gJ2Rpc2NvdmVyeSc6CiAgICAgICAgICByZXNwb25zZU9iamVjdCA9IHNlbGYuc2VydmVyLmRpc2NvdmVyeShtZXNzYWdlSWQpCiAgICAgICAgICBzZWxmLl9zZW5kSnNvblJlc3BvbnNlKHJlc3BvbnNlT2JqZWN0KQogICAgICAgIGVsc2U6CiAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UobWVzc2FnZUlkLCAiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgIGRlZiBfY29uZmlnKHNlbGYpOgogICAgICAgIGltcG9ydCBqc29uCiAgICAgICAgbXNnID0gIiIKICAgICAgICBpZiBzZWxmLnBvc3R2YXJzIGlzIG5vdCBOb25lOgogICAgICAgICAgY29uZkxpc3QgPSBzZWxmLnBvc3R2YXJzLmdldCgnY29uZicsIE5vbmUpCiAgICAgICAgICBpZiBjb25mTGlzdCBpcyBub3QgTm9uZToKICAgICAgICAgICAgc2VsZi5zZXJ2ZXIubG9nKCJTYXZpbmcgYXBwbGlhbmNlcyBjb25maWd1cmF0aW9uIHRvIHswfSIuZm9ybWF0KHNlbGYuc2VydmVyLkZJTEVQQVRIX0FQUExJQU5DRVMpLCBzZXZlcml0eT0iaW5mbyIpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICBzZWxmLnNlcnZlci5jb25mID0ganNvbi5sb2Fkcyhjb25mTGlzdFswXSwgZW5jb2Rpbmc9Imlzbzg4NTktMSIpCiAgICAgICAgICAgICAgd2l0aCBvcGVuKHNlbGYuc2VydmVyLkZJTEVQQVRIX0FQUExJQU5DRVMsICJ3YiIpIGFzIG91dHB1dDoKICAgICAgICAgICAgICAgIG91dHB1dC53cml0ZShjb25mTGlzdFswXSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgIG1zZyA9ICJGYWlsZWQgdG8gcGFyc2UgYXBwbGlhbmNlcyBjb25maWd1cmF0aW9uLiIKICAgICAgICAgICAgICBzZWxmLnNlcnZlci5NQy5EZWJ1Zy5zZXRFcnIoc3lzLmV4Y19pbmZvKCksIG1zZykKICAgICAgICBzZWxmLnNlbmRfcmVzcG9uc2UoMjAwKQogICAgICAgIHNlbGYuc2VuZF9oZWFkZXIoJ0NvbnRlbnQtVHlwZScsICd0ZXh0L2h0bWw7IGNoYXJzZXQ9SVNPLTg4NTktMScpCiAgICAgICAgc2VsZi5lbmRfaGVhZGVycygpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPGh0bWw+PGhlYWQ+PG1ldGEgY2hhcnNldD0nSVNPLTg4NTktMSc+PC9oZWFkPjxib2R5PiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPGZvcm0gbWV0aG9kPSdwb3N0JyBlbmN0eXBlPSdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnIGFjY2VwdC1jaGFyc2V0PSdJU08tODg1OS0xJz4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjx0YWJsZSBzdHlsZT0nd2lkdGg6MTAwJTtoZWlnaHQ6MTAwJSc+PHRyPjx0ZD48aDE+QW1hem9uIEVjaG8gLSBBcHBsaWFuY2VzPC9oMT48L3RkPjwvdHI+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8dHIgc3R5bGU9J2hlaWdodDo5OSUnPjx0ZD48dGV4dGFyZWEgbmFtZT0nY29uZicgc3R5bGU9J3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCUnPiIpCiAgICAgICAgaWYgc2VsZi5zZXJ2ZXIuY29uZiAhPSAiIjoKICAgICAgICAgIHJlc3AgPSBqc29uLmR1bXBzKHNlbGYuc2VydmVyLmNvbmYsIGRlZmF1bHQ9YXNEaWN0LCBlbmNvZGluZz0iaXNvODg1OS0xIikKICAgICAgICBlbHNlOgogICAgICAgICAgcmVzcCA9ICIiCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZShyZXNwKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjwvdGV4dGFyZWE+PC90ZD48L3RyPiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPHRyPjx0ZD48aW5wdXQgdHlwZT0nc3VibWl0Jy8+PC90ZD48L3RyPiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPHRyPjx0ZCBzdHlsZT0nY29sb3I6cmVkJz4iICsgbXNnICsgIjwvdGQ+PC90cj4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjwvZm9ybT48L2JvZHk+PC9odG1sPiIpCiAgICAgIGRlZiBfc2VuZEpzb25FcnJvclJlc3BvbnNlKHNlbGYsIG1lc3NhZ2VJZCwgZXJyb3JNZXNzYWdlKToKICAgICAgICByZXNwb25zZU9iamVjdCA9IE5vbmUKICAgICAgICBpZiBzZWxmLmNvbW1hbmQgPT0gJ2NvbnRyb2wnOgogICAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBBbWF6b25FY2hvLkNvbnRyb2xSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgICAgZWxpZiBzZWxmLmNvbW1hbmQgPT0gJ2Rpc2NvdmVyeSc6CiAgICAgICAgICByZXNwb25zZU9iamVjdCA9IEFtYXpvbkVjaG8uRGlzY292ZXJ5UmVzcG9uc2UobWVzc2FnZUlkKQogICAgICAgIGVsc2U6CiAgICAgICAgICBzZWxmLnNlbmRfZXJyb3IoNDA0LCAnTm90IEZvdW5kJykKICAgICAgICAgIHJldHVybgogICAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoZXJyb3JNZXNzYWdlKQogICAgICAgIHNlbGYuX3NlbmRKc29uUmVzcG9uc2UocmVzcG9uc2VPYmplY3QpCiAgICAgIGRlZiBfc2VuZEpzb25SZXNwb25zZShzZWxmLCByZXNwb25zZU9iamVjdCk6CiAgICAgICAgaW1wb3J0IGpzb24KICAgICAgICByZXNwID0ganNvbi5kdW1wcyhyZXNwb25zZU9iamVjdCwgZGVmYXVsdD1hc0RpY3QsIGVuY29kaW5nPSJpc284ODU5LTEiKQogICAgICAgIHNlbGYuc2VuZF9yZXNwb25zZSgyMDApCiAgICAgICAgc2VsZi5zZW5kX2hlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgnKQogICAgICAgIHNlbGYuZW5kX2hlYWRlcnMoKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUocmVzcCkKICAgICAgZGVmIF9idWlsZFJlcVBhcmFtTWFwKHNlbGYsIHF1ZXJ5KToKICAgICAgICBpbXBvcnQgdXJsbGliCiAgICAgICAgcmVxX3BhcmFtcyA9IHt9CiAgICAgICAgcGFyYW1zID0gcXVlcnkuc3BsaXQoJyYnKQogICAgICAgIGZvciBwYXJhbSBpbiBwYXJhbXM6CiAgICAgICAgICBpZHggPSBwYXJhbS5maW5kKCc9JykKICAgICAgICAgIHJlcV9wYXJhbXNbcGFyYW1bMDppZHhdXSA9IHVybGxpYi51bnF1b3RlX3BsdXMocGFyYW1baWR4ICsgMTpdKQogICAgICAgIHJldHVybiByZXFfcGFyYW1zCiAgICBkZWYgc3RhcnQoc2VsZik6CiAgICAgIHNlbGYubG9nKCJTdGFydCAiLCBzZXZlcml0eT0iaW5mbyIpCiAgICAgIGlmIHNlbGYuc2VydmVyVGhyZWFkIGlzIE5vbmU6CiAgICAgICAgSFRUUFNlcnZlci5fX2luaXRfXyhzZWxmLCAoc2VsZi5pcCwgc2VsZi5wb3J0KSwgc2VsZi5IVFRQUmVxdWVzdEhhbmRsZXIpCiAgICAgICAgaWYgc2VsZi5jZXJ0VGV4dCAhPSAiIjoKICAgICAgICAgIHdpdGggb3BlbihzZWxmLkZJTEVQQVRIX0NFUlQsICJ3YiIpIGFzIG91dHB1dDoKICAgICAgICAgICAgb3V0cHV0LndyaXRlKHNlbGYuY2VydFRleHQpCiAgICAgICAgICBpbXBvcnQgc3NsCiAgICAgICAgICBzZWxmLnNvY2tldCA9IHNzbC53cmFwX3NvY2tldChzZWxmLnNvY2tldCwgY2VydGZpbGU9c2VsZi5GSUxFUEFUSF9DRVJULCBzZXJ2ZXJfc2lkZT1UcnVlKQogICAgICAgIGZyb20gaHNfcXVldWUgaW1wb3J0IGhzX3RocmVhZGluZyBhcyB0aHJlYWRpbmcKICAgICAgICBzZWxmLnNlcnZlclRocmVhZCA9IHRocmVhZGluZy5UaHJlYWQodGFyZ2V0PXNlbGYuc2VydmVfZm9yZXZlciwgbmFtZT0nYW1hem9uX2VjaG9fc2VydmVyJykKICAgICAgICBzZWxmLnNlcnZlclRocmVhZC5kYWVtb24gPSBUcnVlCiAgICAgICAgc2VsZi5zZXJ2ZXJUaHJlYWQuc3RhcnQoKQogICAgZGVmIHN0b3Aoc2VsZik6CiAgICAgIHNlbGYubG9nKCJTdG9wICIsIHNldmVyaXR5PSJpbmZvIikKICAgICAgaWYgbm90IHNlbGYuc2VydmVyVGhyZWFkIGlzIE5vbmU6CiAgICAgICAgSFRUUFNlcnZlci5zaHV0ZG93bihzZWxmKQogICAgICAgIHNlbGYuc29ja2V0LmNsb3NlKCkKICAgICAgICBzZWxmLnNlcnZlclRocmVhZCA9IE5vbmUKICAgIGRlZiBnZXRTU0xDZXJ0KHNlbGYsIGlwLCBjZXJ0RmlsZW5hbWUpOgogICAgICB0cnk6CiAgICAgICAgaW1wb3J0IHVybGxpYjIKICAgICAgICB1cmwgPSAiaHR0cDovL3swfS9vcHQvezF9Ii5mb3JtYXQoaXAsIGNlcnRGaWxlbmFtZSkKICAgICAgICByZXEgPSB1cmxsaWIyLlJlcXVlc3QodXJsKQogICAgICAgIHJlcyA9IHVybGxpYjIudXJsb3BlbihyZXEpCiAgICAgICAgaWYgcmVzLmdldGNvZGUoKSA9PSAyMDA6CiAgICAgICAgICByZXR1cm4gcmVzLmZwLnJlYWQoKQogICAgICBleGNlcHQ6CiAgICAgICAgcGFzcwogICAgICByZXR1cm4gIiIKICAgIGRlZiB3ZWJDYWxsYmFja1NTTENlcnQoc2VsZiwgc3RyZWFtPUZhbHNlKToKICAgICAgaHRtbCA9ICI8aHRtbD48aGVhZD4iCiAgICAgIGh0bWwgKz0gIjxtZXRhIGNoYXJzZXQ9J0lTTy04ODU5LTEnLz4iCiAgICAgIGh0bWwgKz0gIjxtZXRhIGh0dHAtZXF1aXY9J2NhY2hlLWNvbnRyb2wnIGNvbnRlbnQ9J21heC1hZ2U9MCcvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0nY2FjaGUtY29udHJvbCcgY29udGVudD0nbm8tY2FjaGUnLz4iCiAgICAgIGh0bWwgKz0gIjxtZXRhIGh0dHAtZXF1aXY9J2V4cGlyZXMnIGNvbnRlbnQ9JzAnLz4iCiAgICAgIGh0bWwgKz0gIjxtZXRhIGh0dHAtZXF1aXY9J2V4cGlyZXMnIGNvbnRlbnQ9J1R1ZSwgMDEgSmFuIDE5ODAgMTowMDowMCBHTVQnLz4iCiAgICAgIGh0bWwgKz0gIjxtZXRhIGh0dHAtZXF1aXY9J3ByYWdtYScgY29udGVudD0nbm8tY2FjaGUnLz4iCiAgICAgIGh0bWwgKz0gIjwvaGVhZD48Ym9keT4iCiAgICAgIGh0bWwgKz0gIjxoMT5BbWF6b24gRWNobyAtIFNTTCBDZXJ0aWZpY2F0ZTwvaDE+IgogICAgICBodG1sICs9ICI8cHJlPjxjb2RlPiIKICAgICAgaHRtbCArPSBzZWxmLmNlcnRUZXh0CiAgICAgIGh0bWwgKz0gIjwvcHJlPjwvY29kZT4iCiAgICAgIGh0bWwgKz0gIjwvYm9keT48L2h0bWw+IgogICAgICBpZiBzdHJlYW06CiAgICAgICAgICBzdHJlYW0ud3JpdGUoaHRtbCkKICAgICAgc2VsZi5EYXRMZW4gPSBsZW4oaHRtbCkKICAgIGRlZiBpbml0X2RlYnVnX2VudHJ5KHNlbGYpOgogICAgICBwcm90byA9ICJodHRwIgogICAgICBpZiBzZWxmLmNlcnRUZXh0ICE9ICIiOgogICAgICAgIHByb3RvID0gImh0dHBzIgogICAgICBpbXBvcnQgdXJsbGliCiAgICAgIHNlbGYuTUMuRGVidWcuYWRkR3J1cHBlKAogICAgICAgIFtzZWxmLmlkLCBzZWxmLmlkXSwKICAgICAgICAgIFsgCiAgICAgICAgICAgIFsiMFZFUlNJT05JTkZPIiwiVmVyc2lvbiIsMSwnVjAuMSAtICgyMDE2LTExLTI1IDE1OjUzKSddLAogICAgICAgICAgICBbIjFQT1JUIiwiUG9ydCIsMSxzdHIoc2VsZi5wb3J0KV0sCiAgICAgICAgICAgIFsiMlNTTCIsIlNTTC1DZXJ0aWZpY2F0ZSIsMSwiPGEgaHJlZj0nL29wdC97MH0nPnNob3c8L2E+PGJyPiIuZm9ybWF0KHNlbGYuVVJMX1NIT1dfU1NMKV0sCiAgICAgICAgICAgIFsiM0NPTkZJRyIsIkFwcGxpYW5jZXMgY29uZmlndXJhdGlvbiIsMSwiPGEgaHJlZj0nezB9Oi8vezF9OnsyfS9jb25maWc/YWNjZXNzVG9rZW49ezN9Jz5lZGl0PC9hPjxicj4iLmZvcm1hdChwcm90bywgc2VsZi5pcCwgc2VsZi5wb3J0LCB1cmxsaWIucXVvdGVfcGx1cyhzZWxmLmFjY2Vzc1Rva2VuKSldLAogICAgICAgICAgXSAgIAogICAgICApCiAgICBkZWYgZGVidWcoc2VsZiwgbXNnLCBsdmw9NSk6CiAgICAgIGltcG9ydCB0aW1lCiAgICAgIHNlbGYubG9nKG1zZywgc2V2ZXJpdHk9J2RlYnVnJykKICAgICAgcHJpbnQgIiVzIERFQlVHOiAlciIgJSAodGltZS5zdHJmdGltZSgiJUg6JU06JVMiKSwgbXNnLCApCiAgICBkZWYgbG9nKHNlbGYsIG1zZywgc2V2ZXJpdHk9J2luZm8nKToKICAgICAgaW1wb3J0IHRpbWUKICAgICAgZnJvbSBoYXNobGliIGltcG9ydCBtZDUKICAgICAgX21zZ191aWQgPSBtZDUoICIlcyVzIiAlICggc2VsZi5pZCwgdGltZS50aW1lKCkgKSApLmhleGRpZ2VzdCgpCiAgICAgIF9tc2cgPSAnPGxvZz48aWQ+JXM8L2lkPjxmYWNpbGl0eT5BbWF6b25fRWNob19TZXJ2ZXI8L2ZhY2lsaXR5PjxzZXZlcml0eT4lczwvc2V2ZXJpdHk+PG1lc3NhZ2U+JXM8L21lc3NhZ2U+PC9sb2c+JyAlIChfbXNnX3VpZCwgc2V2ZXJpdHksIG1zZykKICAgICAgc2VsZi5zZW5kVG9PdXRwdXQoMSxfbXNnKQogICAgZGVmIHNlbmRUb091dHB1dChzZWxmLCBvdXQsIG1zZyk6CiAgICAgIG91dCAtPSAxCiAgICAgIHNlbGYubG9jYWxzWyJBTiJdW291dF0gPSBtc2cKICAgICAgc2VsZi5sb2NhbHNbIkFDIl1bb3V0XSA9IDEgIAo='),'<10013_Amazon Echo (10013)>','exec'))"|""|0|0|0|0
## MD5 der Formelzeile: 1f188ac336cf496ae9b74116e2f9238b
### Klasse AmazonEcho
################################
## Quelltext nicht Öffentlich ##
################################




## Klasse auf SN1 
5012|1|"EI"|"1"|"10"|0|1|0|0
5012|0|"OC[1]"|"AmazonEcho(locals())"|""|0|0|1|0

#5012|abbruch bei bed. (0/1)|bedingung|formel|zeit|pin-ausgang|pin-offset|pin-speicher|pin-neg.ausgang
5012|0|"(OC[1] or EC[1]) and EN[1]"|"SN[1].start()"|""|0|0|0|0
5012|0|"EC[1] and not EN[1]"|"SN[1].stop()"|""|0|0|0|0



