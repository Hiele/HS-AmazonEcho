# -*- coding: iso8859-1 -*-
## -----------------------------------------------------
## Amazon Echo (10013)   ### V0.1
##
## erstellt am: 2016-12-01 12:56
## -----------------------------------------------------
## Copyright © 2016, Werner Lindbüchl, All rights reserved.
##
## This program is free software; you can redistribute it and/or modify it under the terms
## of the GNU General Public License as published by the Free Software Foundation; either
## version 3 of the License, or (at your option) any later version.
##
## This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
## without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
## See the GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License along with this program;
## if not, see <http://www.gnu.de/documents/gpl-3.0.de.html>.

## -- 
## --  

#5000|"Text"|Remanent(1/0)|Anz.Eingänge|.n.|Anzahl Ausgänge|.n.|.n.
5000|"#WJL\Amazon Echo (10013)_V0.1"|1|3|"E1 Https-Server Start/Stop"|"E2 Https-Server Port"|"E3 Access Token"|1|"A1 Systemlog"|"V0.1"

#5001|Anzahl Eingänge|Ausgänge|Offset|Speicher|Berechnung bei Start
5001|3|1|1|2|1

# Eingaenge
#5002|Index Eingang|Default Wert|0=numerisch 1=alphanummerisch
5002|1|0|0	#* E1 Https-Server Start/Stop 
5002|2|0|0	#* E2 Https-Server Port 
5002|3|0|1	#* E3 Access Token 

# Speicher
#5003|Speicher|Initwert|Remanent
5003|1||0		  #* 
5003|2||1		  #* 

# Ausgaenge
#5004|ausgang|Initwert|runden binär (0/1)|typ (1-send/2-sbc)|0=numerisch 1=alphanummerisch
5004|1|""|0|1|1 

#################################################

5012|0|"OC[1]"|"eval(compile(__import__('base64').decodestring('CmlmIE9DWzFdPT0xOgogIGdsb2JhbCBIUwogIEhTID0gVHJ1ZQogIGdsb2JhbCBhc0RpY3QKICBkZWYgYXNEaWN0KG8pOgogICAgICByZXR1cm4gby5fX2RpY3RfXwogIGdsb2JhbCBIVFRQU2VydmVyCiAgZ2xvYmFsIEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBmcm9tIEJhc2VIVFRQU2VydmVyIGltcG9ydCBIVFRQU2VydmVyLEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBnbG9iYWwgVGhyZWFkaW5nTWl4SW4KICBmcm9tIFNvY2tldFNlcnZlciBpbXBvcnQgVGhyZWFkaW5nTWl4SW4KICBnbG9iYWwganNvbgogIGltcG9ydCBqc29uCiAgZ2xvYmFsIEFtYXpvbkVjaG9XZWJDYWxsYmFjawogIGNsYXNzIEFtYXpvbkVjaG9XZWJDYWxsYmFjayhvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBJdGVtLCBjYWxsYmFjaywgbmFtZSwgdHlwZT0ndGV4dC9odG1sJyk6CiAgICAgIHNlbGYubG9naWsgPSBwSXRlbQogICAgICBzZWxmLmNhbGxiYWNrID0gY2FsbGJhY2sKICAgICAgc2VsZi5NQyA9IHBJdGVtLk1DCiAgICAgIHNlbGYuVXJsUGZhZCA9IG5hbWUudXBwZXIoKQogICAgICBzZWxmLkRhdE5hbWUgPSAiT1BULyVzIiAlIChzZWxmLlVybFBmYWQpCiAgICAgIHNlbGYuRGF0TGVuID0gMAogICAgICBzZWxmLlR5cCA9IHR5cGUKICAgICAgc2VsZi5pc1F1YWQgPSAwCiAgICAgIHNlbGYuTUMuR1VJLkV4dERhdFVybFtzZWxmLlVybFBmYWRdID0gc2VsZgogICAgZGVmIGdldERhdGVuKHNlbGYpOgogICAgICByZXR1cm4KICAgIGRlZiBnZXRRdWFkRGF0ZW4oc2VsZik6CiAgICAgIHJldHVybiAKICAgIGRlZiBnZXREYXRlblN0cmVhbShzZWxmLCBzdHJlYW0pOgogICAgICBzZWxmLkRhdExlbiA9IHNlbGYuY2FsbGJhY2soc3RyZWFtKQogICAgZGVmIGdldFF1YWREYXRlblN0cmVhbShzZWxmLCBzdHJlYW0pOgogICAgICBzZWxmLmdldERhdGVuU3RyZWFtKHN0cmVhbSkKICBnbG9iYWwgQW1hem9uRWNobwogIGNsYXNzIEFtYXpvbkVjaG8oVGhyZWFkaW5nTWl4SW4sIEhUVFBTZXJ2ZXIpOgogICAgaWYgSFM6CiAgICAgIFBBVEhfQkFTRSA9ICIvdG1wLyIKICAgIGVsc2U6CiAgICAgIFBBVEhfQkFTRSA9ICIiCiAgICBGSUxFTkFNRV9DRVJUID0gImFtYXpvbkVjaG9TU0wuY2VydCIKICAgIEZJTEVQQVRIX0NFUlQgPSBQQVRIX0JBU0UgKyBGSUxFTkFNRV9DRVJUCiAgICBVUkxfQkFTRSA9ICJhbWF6b25FY2hvLyIKICAgIFVSTF9TSE9XX1NTTCA9IFVSTF9CQVNFICsgInNzbENlcnQuaHRtIgogICAgYWxsb3dfcmV1c2VfYWRkcmVzcyA9IFRydWUKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBsb2NhbHMpOgogICAgICBzZWxmLmxvY2FscyA9IGxvY2FsczsKICAgICAgc2VsZi5sb2dpayA9IGxvY2Fsc1sncEl0ZW0nXQogICAgICBzZWxmLk1DID0gc2VsZi5sb2dpay5NQwogICAgICBzZWxmLmlwID0gc2VsZi5NQy5FdGhlcm5ldC5JUEFkcgogICAgICBFTiA9IGxvY2Fsc1snRU4nXQogICAgICBzZWxmLnBvcnQgPSBpbnQoRU5bMl0pCiAgICAgIHNlbGYuYWNjZXNzVG9rZW4gPSBFTlszXQogICAgICBzZWxmLmlkID0gJ0FtYXpvbl9FY2hvX1NlcnZlcicKICAgICAgc2VsZi5zZXJ2ZXJUaHJlYWQgPSBOb25lCiAgICAgIHNlbGYuY2VydFRleHQgPSBzZWxmLmdldFNTTENlcnQoc2VsZi5pcCwgc2VsZi5GSUxFTkFNRV9DRVJUKQogICAgICBzZWxmLmluaXRBcHBsaWFuY2VzKCkKICAgICAgQW1hem9uRWNob1dlYkNhbGxiYWNrKHNlbGYubG9naWssIHNlbGYud2ViQ2FsbGJhY2tTU0xDZXJ0LCBzZWxmLlVSTF9TSE9XX1NTTCkKICAgICAgc2VsZi5pbml0X2RlYnVnX2VudHJ5KCk7CiAgICBkZWYgcmVhZEFwcGxpYW5jZXNDb25mKHNlbGYpOgogICAgICB0cnk6CiAgICAgICAgYXBwbGlhbmNlc0NvbmYgPSBzZWxmLmxvY2Fsc1snU04nXVsyXQogICAgICAgIHNlbGYuY29uZiA9IGpzb24ubG9hZHMoYXBwbGlhbmNlc0NvbmYsIGVuY29kaW5nPSJpc284ODU5LTEiKQogICAgICBleGNlcHQ6CiAgICAgICAgc2VsZi5jb25mID0gTm9uZQogICAgZGVmIHNhdmVBcHBsaWFuY2VzQ29uZihzZWxmLCBhcHBsaWFuY2VzQ29uZik6CiAgICAgIHNlbGYubG9nKCJTYXZpbmcgYXBwbGlhbmNlcyBjb25maWd1cmF0aW9uLiIsIHNldmVyaXR5PSJpbmZvIikKICAgICAgbXNnID0gIiIKICAgICAgdHJ5OgogICAgICAgIGlmIGFwcGxpYW5jZXNDb25mICE9ICIiOgogICAgICAgICAgc2VsZi5jb25mID0ganNvbi5sb2FkcyhhcHBsaWFuY2VzQ29uZiwgZW5jb2Rpbmc9Imlzbzg4NTktMSIpCiAgICAgICAgZWxzZToKICAgICAgICAgIHNlbGYuY29uZiA9IE5vbmUKICAgICAgICBzZWxmLmxvZ2lrLlNwZWljaGVyV2VydFsxXSA9IGFwcGxpYW5jZXNDb25mCiAgICAgICAgc2VsZi5NQy5TaWNoUXVldWUucHV0KFsxMDAsIHNlbGYubG9naWssIHNlbGYubG9naWsuU3BlaWNoZXJXZXJ0XSkKICAgICAgZXhjZXB0OgogICAgICAgIG1zZyA9ICJGYWlsZWQgdG8gcGFyc2UgYXBwbGlhbmNlcyBjb25maWd1cmF0aW9uLiIKICAgICAgICBzZWxmLk1DLkRlYnVnLnNldEVycihzeXMuZXhjX2luZm8oKSwgbXNnKQogICAgICByZXR1cm4gbXNnCiAgICBkZWYgaW5pdEFwcGxpYW5jZXMoc2VsZik6CiAgICAgIHNlbGYucmVhZEFwcGxpYW5jZXNDb25mKCkKICAgICAgc2VsZi5hcHBsaWFuY2VzID0gW10KICAgICAgaWYgc2VsZi5jb25mIGlzIE5vbmU6CiAgICAgICAgc2VsZi5kaXNjb3ZlckFwcGxpYW5jZXMoKQogICAgZGVmIGRpc2NvdmVyQXBwbGlhbmNlcyhzZWxmKToKICAgICAgaW1wb3J0IHJlCiAgICAgIHJlZ2V4ID0gcmUuY29tcGlsZSgiKC4qKVxbXHMqKFN3aXRjaGFibGV8TGlnaHRpbmcpXHMqXF1ccyokIikKICAgICAgZm9yIGlrbyBpbiBzZWxmLk1DLlRhZ0xpc3QuVGFnTGlzdDogCiAgICAgICAga28gPSBzZWxmLk1DLlRhZ0xpc3QuVGFnTGlzdFtpa29dCiAgICAgICAgbWF0Y2ggPSByZWdleC5zZWFyY2goa28uUlBDVGV4dCkKICAgICAgICBpZiBtYXRjaDoKICAgICAgICAgIGFwcGxpYW5jZSA9IEFtYXpvbkVjaG8uS05YQXBwbGlhbmNlKGtvLCBtYXRjaC5ncm91cHMoKVswXS5zdHJpcCgpLCBtYXRjaC5ncm91cHMoKVsxXSkKICAgICAgICAgIHNlbGYuYXBwbGlhbmNlcy5hcHBlbmQoYXBwbGlhbmNlKQogICAgY2xhc3MgS05YQXBwbGlhbmNlKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBrbywgZnJpZW5kbHlOYW1lLCB0eXBlKToKICAgICAgICBzZWxmLmtvID0ga28KICAgICAgICBzZWxmLmZyaWVuZGx5TmFtZSA9IGZyaWVuZGx5TmFtZQogICAgICAgIHNlbGYudHlwZSA9IHR5cGUKICAgIGRlZiBkaXNjb3Zlcnkoc2VsZiwgbWVzc2FnZUlkKToKICAgICAgcmVzcG9uc2VPYmplY3QgPSBBbWF6b25FY2hvLkRpc2NvdmVyeVJlc3BvbnNlKG1lc3NhZ2VJZCkKICAgICAgaWYgc2VsZi5jb25mIGlzIG5vdCBOb25lOgogICAgICAgIGlkID0gMAogICAgICAgIGZvciBkZXZpY2UgaW4gc2VsZi5jb25mOgogICAgICAgICAgcm9vbSA9IGRldmljZS5nZXQoJ3Jvb20nKQogICAgICAgICAgaWQgKz0gMQogICAgICAgICAgaWRTdHIgPSBzdHIoaWQpCiAgICAgICAgICBqZCA9IDAKICAgICAgICAgIGZvciBhcHBsaWFuY2UgaW4gZGV2aWNlLmdldCgnYXBwbGlhbmNlcycpOgogICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgIHR5cGUgPSAnU3dpdGNoYWJsZScKICAgICAgICAgICAgcGVyY2VudCA9IGFwcGxpYW5jZS5nZXQoJ3BlcmNlbnQnKTsKICAgICAgICAgICAgaWYgcGVyY2VudCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICB0eXBlID0gJ0xpZ2h0aW5nJwogICAgICAgICAgICBpZiByb29tIGlzIG5vdCBOb25lIGFuZCByb29tICE9ICIiOgogICAgICAgICAgICAgIGlmIGpkID09IDE6CiAgICAgICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciwgcm9vbSwgdHlwZSkKICAgICAgICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgICAgICAgICAgbmFtZSA9IGFwcGxpYW5jZS5nZXQoJ25hbWUnKQogICAgICAgICAgICAgIGlmIG5hbWUgaXMgTm9uZToKICAgICAgICAgICAgICAgIG5hbWUgPSByb29tCiAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG5hbWUgPSByb29tICsgIiAiICsgbmFtZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgIG5hbWUgPSBhcHBsaWFuY2UuZ2V0KCduYW1lJykKICAgICAgICAgICAgICBpZiBuYW1lIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciArICJfIiArIHN0cihqZCksIG5hbWUsIHR5cGUpCiAgICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgICAgICAgIGFsaWFzZXMgPSBhcHBsaWFuY2UuZ2V0KCdhbGlhc2VzJyk7CiAgICAgICAgICAgIGlmIGFsaWFzZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgZm9yIGFsaWFzIGluIGFsaWFzZXM6CiAgICAgICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciArICJfIiArIHN0cihqZCksIGFsaWFzLCB0eXBlKQogICAgICAgICAgICAgICAgcmVzcG9uc2VPYmplY3QuYWRkQXBwbGlhbmNlKGRpc2NvdmVyeUFwcGxpYW5jZSkKICAgICAgZWxzZToKICAgICAgICBmb3IgYXBwbGlhbmNlIGluIHNlbGYuYXBwbGlhbmNlczoKICAgICAgICAgIGtvID0gYXBwbGlhbmNlLmtvCiAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShzdHIoa28uSUQpLCBhcHBsaWFuY2UuZnJpZW5kbHlOYW1lLCBhcHBsaWFuY2UudHlwZSkKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgIHJldHVybiByZXNwb25zZU9iamVjdAogICAgZGVmIGNvbnRyb2woc2VsZiwgbWVzc2FnZUlkLCBhcHBsaWFuY2VJZCwgcmVxdWVzdCwgdmFsdWUpOgogICAgICByZXNwb25zZU9iamVjdCA9IEFtYXpvbkVjaG8uQ29udHJvbFJlc3BvbnNlKG1lc3NhZ2VJZCkKICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5zdXBwb3J0ZWRPcGVyYXRpb25FcnJvciIpCiAgICAgIGFwcGxpYW5jZSA9IHNlbGYuZmluZEFwcGxpYW5jZShhcHBsaWFuY2VJZCkKICAgICAgaWYgYXBwbGlhbmNlIGlzIG5vdCBOb25lOgogICAgICAgIG9uVmFsdWUgPSAxLjAKICAgICAgICBvZmZWYWx1ZSA9IDAuMAogICAgICAgIGlmIHR5cGUoYXBwbGlhbmNlKSBpcyBub3QgQW1hem9uRWNoby5LTlhBcHBsaWFuY2U6CiAgICAgICAgICBvbk9mZktvID0gc2VsZi5maW5kS28oYXBwbGlhbmNlWydvbk9mZiddKQogICAgICAgICAgaWYgb25PZmZLbyBpcyBOb25lOgogICAgICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJOb1N1Y2hUYXJnZXRFcnJvciIpCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZU9iamVjdAogICAgICAgICAgcGVyY2VudCA9IGFwcGxpYW5jZS5nZXQoJ3BlcmNlbnQnKTsKICAgICAgICAgIGlmIHBlcmNlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGFwcGxpYW5jZVR5cGUgPSAiTGlnaHRpbmciCiAgICAgICAgICAgIHBlcmNlbnRLbyA9IHNlbGYuZmluZEtvKGFwcGxpYW5jZVsncGVyY2VudCddKQogICAgICAgICAgZWxzZToKICAgICAgICAgICAgYXBwbGlhbmNlVHlwZSA9ICJTd2l0Y2hhYmxlIgogICAgICAgICAgYXBwbGlhbmNlVmFsdWUgPSBhcHBsaWFuY2UuZ2V0KCd2YWx1ZScpCiAgICAgICAgICBpZiBhcHBsaWFuY2VWYWx1ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgb25WYWx1ZSA9IGFwcGxpYW5jZVZhbHVlCiAgICAgICAgZWxzZToKICAgICAgICAgIGFwcGxpYW5jZVR5cGUgPSBhcHBsaWFuY2UudHlwZQogICAgICAgICAgb25PZmZLbyA9IHBlcmNlbnRLbyA9IGFwcGxpYW5jZS5rbwogICAgICAgICAgaWYgYXBwbGlhbmNlVHlwZSA9PSAiTGlnaHRpbmciOgogICAgICAgICAgICBvblZhbHVlID0gMTAwLjAKICAgICAgICBpZiBhcHBsaWFuY2VUeXBlID09ICJMaWdodGluZyI6CiAgICAgICAgICBpZiByZXF1ZXN0ID09ICdUdXJuT25SZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YU2V0VmFsdWUob25PZmZLbywgb25WYWx1ZSwgIlR1cm5PbkNvbmZpcm1hdGlvbiIsIHJlc3BvbnNlT2JqZWN0KQogICAgICAgICAgZWxpZiByZXF1ZXN0ID09ICdUdXJuT2ZmUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKG9uT2ZmS28sIG9mZlZhbHVlLCAiVHVybk9mZkNvbmZpcm1hdGlvbiIsIHJlc3BvbnNlT2JqZWN0KQogICAgICAgICAgZWxpZiByZXF1ZXN0ID09ICdTZXRQZXJjZW50YWdlUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFBlcmNlbnQocGVyY2VudEtvLCB2YWx1ZSwgIlNldFBlcmNlbnRhZ2VDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnSW5jcmVtZW50UGVyY2VudGFnZVJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhBZGRQZXJjZW50KHBlcmNlbnRLbywgdmFsdWUsIDEsICJJbmNyZW1lbnRQZXJjZW50YWdlQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgICBlbGlmIHJlcXVlc3QgPT0gJ0RlY3JlbWVudFBlcmNlbnRhZ2VSZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YQWRkUGVyY2VudChwZXJjZW50S28sIHZhbHVlLCAtMSwgIkRlY3JlbWVudFBlcmNlbnRhZ2VDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbGlmIGFwcGxpYW5jZVR5cGUgPT0gIlN3aXRjaGFibGUiOgogICAgICAgICAgaWYgcmVxdWVzdCA9PSAnVHVybk9uUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKG9uT2ZmS28sIG9uVmFsdWUsICJUdXJuT25Db25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnVHVybk9mZlJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShvbk9mZktvLCBvZmZWYWx1ZSwgIlR1cm5PZmZDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbHNlOgogICAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgIGVsc2U6CiAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiTm9TdWNoVGFyZ2V0RXJyb3IiKQogICAgICByZXR1cm4gcmVzcG9uc2VPYmplY3QKICAgIGRlZiBfS05YQWRkUGVyY2VudChzZWxmLCBrbywgdmFsdWUsIHNpZ24sIG5hbWUsIHJlc3BvbnNlT2JqZWN0KToKICAgICAgdHJ5OgogICAgICAgIGZ2YWx1ZSA9IGtvLmdldFdlcnQoKSArIChzaWduICogZmxvYXQodmFsdWUpKQogICAgICAgIGlmIGZ2YWx1ZSA8IDAuMDoKICAgICAgICAgIGZ2YWx1ZSA9IDAuMAogICAgICAgIGVsaWYgZnZhbHVlID4gMTAwLjA6CiAgICAgICAgICBmdmFsdWUgPSAxMDAuMAogICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKGtvLCBmdmFsdWUsIG5hbWUsIHJlc3BvbnNlT2JqZWN0KQogICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJVbnN1cHBvcnRlZFRhcmdldFNldHRpbmdFcnJvciIpCiAgICBkZWYgX0tOWFNldFBlcmNlbnQoc2VsZiwga28sIHZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCk6CiAgICAgIHRyeToKICAgICAgICBmdmFsdWUgPSBmbG9hdCh2YWx1ZSkKICAgICAgICBpZiBmdmFsdWUgPj0gMC4wIGFuZCBmdmFsdWUgPD0gMTAwLjA6CiAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShrbywgZnZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbHNlOgogICAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVmFsdWVPdXRPZlJhbmdlRXJyb3IiKQogICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJVbnN1cHBvcnRlZFRhcmdldFNldHRpbmdFcnJvciIpCiAgICBkZWYgX0tOWFNldFZhbHVlKHNlbGYsIGtvLCBmdmFsdWUsIG5hbWUsIHJlc3BvbnNlT2JqZWN0KToKICAgICAgc2VsZi5sb2dpay5NQy5UYWdMaXN0LnNldFdlcnQoRkxBR19FSUJfTE9HSUssIGtvLCBmdmFsdWUpCiAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUobmFtZSkKICAgIGRlZiBmaW5kQXBwbGlhbmNlKHNlbGYsIGFwcGxpYW5jZUlkKToKICAgICAgaWYgc2VsZi5jb25mIGlzIG5vdCBOb25lOgogICAgICAgIGlkID0gMAogICAgICAgIGZvciBkZXZpY2UgaW4gc2VsZi5jb25mOgogICAgICAgICAgcm9vbSA9IGRldmljZS5nZXQoJ3Jvb20nKQogICAgICAgICAgaWQgKz0gMQogICAgICAgICAgaWRTdHIgPSBzdHIoaWQpCiAgICAgICAgICBpZiBhcHBsaWFuY2VJZCA9PSBpZFN0cjoKICAgICAgICAgICAgcmV0dXJuIGRldmljZVsnYXBwbGlhbmNlcyddWzBdCiAgICAgICAgICBqZCA9IDAKICAgICAgICAgIGZvciBhcHBsaWFuY2UgaW4gZGV2aWNlWydhcHBsaWFuY2VzJ106CiAgICAgICAgICAgIGpkICs9IDEKICAgICAgICAgICAgaWYgYXBwbGlhbmNlSWQgPT0gaWRTdHIgKyAiXyIgKyBzdHIoamQpOgogICAgICAgICAgICAgIHJldHVybiBhcHBsaWFuY2UKICAgICAgICAgICAgYWxpYXNlcyA9IGFwcGxpYW5jZS5nZXQoJ2FsaWFzZXMnKTsKICAgICAgICAgICAgaWYgYWxpYXNlcyBpcyBub3QgTm9uZToKICAgICAgICAgICAgICBmb3IgYWxpYXMgaW4gYWxpYXNlczoKICAgICAgICAgICAgICAgIGpkICs9IDEKICAgICAgICAgICAgICAgIGlmIGFwcGxpYW5jZUlkID09IGlkU3RyICsgIl8iICsgc3RyKGpkKToKICAgICAgICAgICAgICAgICAgcmV0dXJuIGFwcGxpYW5jZQogICAgICBlbHNlOgogICAgICAgIGZvciBhcHBsaWFuY2UgaW4gc2VsZi5hcHBsaWFuY2VzOgogICAgICAgICAga28gPSBhcHBsaWFuY2Uua28KICAgICAgICAgIGlmIHN0cihrby5JRCkgPT0gYXBwbGlhbmNlSWQ6CiAgICAgICAgICAgIHJldHVybiBhcHBsaWFuY2UKICAgICAgcmV0dXJuIE5vbmUKICAgIGRlZiBmaW5kS28oc2VsZiwgZ3JwQWRyU3RyKToKICAgICAgZm9yIGlrbyBpbiBzZWxmLk1DLlRhZ0xpc3QuVGFnTGlzdDogCiAgICAgICAga28gPSBzZWxmLk1DLlRhZ0xpc3QuVGFnTGlzdFtpa29dCiAgICAgICAgaWYga28uR3JwQWRyU3RyID09IGdycEFkclN0cjoKICAgICAgICAgIHJldHVybiBrbwogICAgICByZXR1cm4gTm9uZTsKICAgIGNsYXNzIEhlYWRlcigpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwgbWVzc2FnZUlkLCBuYW1lLCBuYW1lc3BhY2UsIHBheWxvYWRWZXJzaW9uKToKICAgICAgICBzZWxmLm1lc3NhZ2VJZCA9IG1lc3NhZ2VJZAogICAgICAgIHNlbGYubmFtZSA9IG5hbWUKICAgICAgICBzZWxmLm5hbWVzcGFjZSA9IG5hbWVzcGFjZQogICAgICAgIHNlbGYucGF5bG9hZFZlcnNpb24gPSBwYXlsb2FkVmVyc2lvbgogICAgY2xhc3MgQ29udHJvbFJlc3BvbnNlKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtZXNzYWdlSWQpOgogICAgICAgIHNlbGYuaGVhZGVyID0gQW1hem9uRWNoby5IZWFkZXIobWVzc2FnZUlkLCAiIiwgIkFsZXhhLkNvbm5lY3RlZEhvbWUuQ29udHJvbCIsICIyIikKICAgICAgICBzZWxmLnBheWxvYWQgPSB7fQogICAgICBkZWYgc2V0TmFtZShzZWxmLCBuYW1lKToKICAgICAgICBzZWxmLmhlYWRlci5uYW1lID0gbmFtZQogICAgY2xhc3MgRGlzY292ZXJ5UmVzcG9uc2UoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIG1lc3NhZ2VJZCk6CiAgICAgICAgc2VsZi5oZWFkZXIgPSBBbWF6b25FY2hvLkhlYWRlcihtZXNzYWdlSWQsICJEaXNjb3ZlckFwcGxpYW5jZXNSZXNwb25zZSIsICJBbGV4YS5Db25uZWN0ZWRIb21lLkRpc2NvdmVyeSIsICIyIikKICAgICAgICBzZWxmLnBheWxvYWQgPSBBbWF6b25FY2hvLkRpc2NvdmVyeVBheWxvYWQoKQogICAgICBkZWYgc2V0TmFtZShzZWxmLCBuYW1lKToKICAgICAgICBzZWxmLmhlYWRlci5uYW1lID0gbmFtZQogICAgICBkZWYgYWRkQXBwbGlhbmNlKHNlbGYsIGFwcGxpYW5jZSk6CiAgICAgICAgc2VsZi5wYXlsb2FkLmRpc2NvdmVyZWRBcHBsaWFuY2VzLmFwcGVuZChhcHBsaWFuY2UpCiAgICBjbGFzcyBEaXNjb3ZlcnlQYXlsb2FkKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmRpc2NvdmVyZWRBcHBsaWFuY2VzID0gW10KICAgIGNsYXNzIERpc2NvdmVyeUFwcGxpYW5jZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwgYXBwbGlhbmNlSWQsIGZyaWVuZGx5TmFtZSwgYXBwbGlhbmNlVHlwZSk6CiAgICAgICAgc2VsZi5hcHBsaWFuY2VJZCA9IGFwcGxpYW5jZUlkCiAgICAgICAgc2VsZi5mcmllbmRseURlc2NyaXB0aW9uID0gZnJpZW5kbHlOYW1lCiAgICAgICAgc2VsZi5mcmllbmRseU5hbWUgPSBmcmllbmRseU5hbWUKICAgICAgICBzZWxmLmlzUmVhY2hhYmxlID0gVHJ1ZQogICAgICAgIHNlbGYubWFudWZhY3R1cmVyTmFtZSA9ICJuLmEuIgogICAgICAgIHNlbGYubW9kZWxOYW1lID0gIm4uYS4iCiAgICAgICAgc2VsZi52ZXJzaW9uID0gIjEuMCIKICAgICAgICBpZiBhcHBsaWFuY2VUeXBlID09ICJTd2l0Y2hhYmxlIjoKICAgICAgICAgIHNlbGYuYWN0aW9ucyA9IFsidHVybk9uIiwgInR1cm5PZmYiXQogICAgICAgIGVsaWYgYXBwbGlhbmNlVHlwZSA9PSAiTGlnaHRpbmciOgogICAgICAgICAgc2VsZi5hY3Rpb25zID0gWyJ0dXJuT24iLCAidHVybk9mZiIsICJpbmNyZW1lbnRQZXJjZW50YWdlIiwgImRlY3JlbWVudFBlcmNlbnRhZ2UiLCAic2V0UGVyY2VudGFnZSJdCiAgICAgICAgZWxpZiBhcHBsaWNhbmNlVHlwZSA9PSAiVGhlcm1vc3RhdCI6CiAgICAgICAgICBzZWxmLmFjdGlvbnMgPSBbImluY3JlbWVudFRhcmdldFRlbXBlcmF0dXJlIiwgImRlY3JlbWVudFRhcmdldFRlbXBlcmF0dXJlIiwgInNldFRhcmdldFRlbXBlcmF0dXJlIl0KICAgIGNsYXNzIEhUVFBSZXF1ZXN0SGFuZGxlcihCYXNlSFRUUFJlcXVlc3RIYW5kbGVyKToKICAgICAgZGVmIGFkZHJlc3Nfc3RyaW5nKHNlbGYpOgogICAgICAgICAgaG9zdCwgcG9ydCA9IHNlbGYuY2xpZW50X2FkZHJlc3NbOjJdCiAgICAgICAgICByZXR1cm4gaG9zdAogICAgICBkZWYgbG9nX3JlcXVlc3Qoc2VsZiwgY29kZT1Ob25lLCBzaXplPU5vbmUpOgogICAgICAgIHBhc3MKICAgICAgZGVmIGxvZ19tZXNzYWdlKHNlbGYsIGZvcm1hdCwgKmFyZ3MpOgogICAgICAgIHBhc3MKICAgICAgZGVmIGRvX1BPU1Qoc2VsZik6CiAgICAgICAgc2VsZi5wb3N0dmFycyA9IHNlbGYucGFyc2VfUE9TVCgpCiAgICAgICAgc2VsZi5kb19SRVEoKQogICAgICBkZWYgcGFyc2VfUE9TVChzZWxmKToKICAgICAgICBmcm9tIGNnaSBpbXBvcnQgcGFyc2VfaGVhZGVyLCBwYXJzZV9tdWx0aXBhcnQKICAgICAgICBmcm9tIHVybHBhcnNlIGltcG9ydCBwYXJzZV9xcwogICAgICAgIGN0eXBlLCBwZGljdCA9IHBhcnNlX2hlYWRlcihzZWxmLmhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddKQogICAgICAgIGlmIGN0eXBlID09ICdtdWx0aXBhcnQvZm9ybS1kYXRhJzoKICAgICAgICAgICAgcG9zdHZhcnMgPSBwYXJzZV9tdWx0aXBhcnQoc2VsZi5yZmlsZSwgcGRpY3QpCiAgICAgICAgZWxpZiBjdHlwZSA9PSAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJzoKICAgICAgICAgICAgbGVuZ3RoID0gaW50KHNlbGYuaGVhZGVyc1snY29udGVudC1sZW5ndGgnXSkKICAgICAgICAgICAgcG9zdHZhcnMgPSBwYXJzZV9xcygKICAgICAgICAgICAgICAgICAgICBzZWxmLnJmaWxlLnJlYWQobGVuZ3RoKSwgCiAgICAgICAgICAgICAgICAgICAga2VlcF9ibGFua192YWx1ZXM9MSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwb3N0dmFycyA9IHt9CiAgICAgICAgcmV0dXJuIHBvc3R2YXJzCiAgICAgIGRlZiBkb19HRVQoc2VsZik6CiAgICAgICAgc2VsZi5wb3N0dmFycyA9IE5vbmUKICAgICAgICBzZWxmLmRvX1JFUSgpCiAgICAgIGRlZiBkb19SRVEoc2VsZik6CiAgICAgICAgYWNjZXNzVG9rZW4gPSBOb25lCiAgICAgICAgbWVzc2FnZUlkID0gTm9uZQogICAgICAgIHRyeToKICAgICAgICAgIGlkeCA9IHNlbGYucGF0aC5pbmRleCgiPyIpCiAgICAgICAgICBzZWxmLmNvbW1hbmQgPSBzZWxmLnBhdGhbMTppZHhdCiAgICAgICAgICByZXFQYXJhbXMgPSBzZWxmLl9idWlsZFJlcVBhcmFtTWFwKHNlbGYucGF0aFtpZHgrMTpdKQogICAgICAgICAgYWNjZXNzVG9rZW4gPSByZXFQYXJhbXMuZ2V0KCdhY2Nlc3NUb2tlbicpCiAgICAgICAgICBtZXNzYWdlSWQgPSByZXFQYXJhbXMuZ2V0KCdtZXNzYWdlSWQnKQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgc2VsZi5jb21tYW5kID0gc2VsZi5wYXRoWzE6XQogICAgICAgIGlmIHNlbGYuY29tbWFuZCA9PSAnY29uZmlnJzoKICAgICAgICAgIGlmIGFjY2Vzc1Rva2VuICE9IHNlbGYuc2VydmVyLmFjY2Vzc1Rva2VuOgogICAgICAgICAgICBzZWxmLnNlbmRfZXJyb3IoNDAxLCAnTWlzc2luZyBvciBpbnZhbGlkIGFjY2VzcyB0b2tlbicpCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgc2VsZi5fY29uZmlnKCkKICAgICAgICAgIHJldHVybgogICAgICAgIGlmIG1lc3NhZ2VJZCBpcyBOb25lOgogICAgICAgICAgc2VsZi5fc2VuZEpzb25FcnJvclJlc3BvbnNlKCIiLCAiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBhY2Nlc3NUb2tlbiBpcyBOb25lOgogICAgICAgICAgc2VsZi5fc2VuZEpzb25FcnJvclJlc3BvbnNlKG1lc3NhZ2VJZCwgIlVuZXhwZWN0ZWRJbmZvcm1hdGlvblJlY2VpdmVkRXJyb3IiKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgYWNjZXNzVG9rZW4gIT0gc2VsZi5zZXJ2ZXIuYWNjZXNzVG9rZW46CiAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UobWVzc2FnZUlkLCAiSW52YWxpZEFjY2Vzc1Rva2VuRXJyb3IiKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgc2VsZi5jb21tYW5kID09ICdjb250cm9sJzoKICAgICAgICAgIHRyeToKICAgICAgICAgICAgcmVxdWVzdCA9IHJlcVBhcmFtc1sncmVxdWVzdCddCiAgICAgICAgICAgIGFwcGxpYW5jZUlkID0gcmVxUGFyYW1zWydhcHBsaWFuY2VJZCddCiAgICAgICAgICAgIHZhbHVlID0gcmVxUGFyYW1zLmdldCgndmFsdWUnLCBOb25lKQogICAgICAgICAgZXhjZXB0IChLZXlFcnJvcik6CiAgICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZShtZXNzYWdlSWQsICJVbmV4cGVjdGVkSW5mb3JtYXRpb25SZWNlaXZlZEVycm9yIikKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICByZXNwb25zZU9iamVjdCA9IHNlbGYuc2VydmVyLmNvbnRyb2wobWVzc2FnZUlkLCBhcHBsaWFuY2VJZCwgcmVxdWVzdCwgdmFsdWUpCiAgICAgICAgICBzZWxmLl9zZW5kSnNvblJlc3BvbnNlKHJlc3BvbnNlT2JqZWN0KQogICAgICAgIGVsaWYgc2VsZi5jb21tYW5kID09ICdkaXNjb3ZlcnknOgogICAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBzZWxmLnNlcnZlci5kaXNjb3ZlcnkobWVzc2FnZUlkKQogICAgICAgICAgc2VsZi5fc2VuZEpzb25SZXNwb25zZShyZXNwb25zZU9iamVjdCkKICAgICAgICBlbHNlOgogICAgICAgICAgc2VsZi5fc2VuZEpzb25FcnJvclJlc3BvbnNlKG1lc3NhZ2VJZCwgIlVuZXhwZWN0ZWRJbmZvcm1hdGlvblJlY2VpdmVkRXJyb3IiKQogICAgICBkZWYgX2NvbmZpZyhzZWxmKToKICAgICAgICBtc2cgPSAiIgogICAgICAgIGlmIHNlbGYucG9zdHZhcnMgaXMgbm90IE5vbmU6CiAgICAgICAgICBjb25mTGlzdCA9IHNlbGYucG9zdHZhcnMuZ2V0KCdjb25mJywgTm9uZSkKICAgICAgICAgIGlmIGNvbmZMaXN0IGlzIG5vdCBOb25lOgogICAgICAgICAgICBtc2cgPSBzZWxmLnNlcnZlci5zYXZlQXBwbGlhbmNlc0NvbmYoY29uZkxpc3RbMF0uc3RyaXAoKSkKICAgICAgICBzZWxmLnNlbmRfcmVzcG9uc2UoMjAwKQogICAgICAgIHNlbGYuc2VuZF9oZWFkZXIoJ0NvbnRlbnQtVHlwZScsICd0ZXh0L2h0bWw7IGNoYXJzZXQ9SVNPLTg4NTktMScpCiAgICAgICAgc2VsZi5lbmRfaGVhZGVycygpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPGh0bWw+PGhlYWQ+PG1ldGEgY2hhcnNldD0nSVNPLTg4NTktMSc+PC9oZWFkPjxib2R5PiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPGZvcm0gbWV0aG9kPSdwb3N0JyBlbmN0eXBlPSdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnIGFjY2VwdC1jaGFyc2V0PSdJU08tODg1OS0xJz4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjx0YWJsZSBzdHlsZT0nd2lkdGg6MTAwJTtoZWlnaHQ6MTAwJSc+PHRyPjx0ZD48aDE+QW1hem9uIEVjaG8gLSBBcHBsaWFuY2VzPC9oMT48L3RkPjwvdHI+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8dHIgc3R5bGU9J2hlaWdodDo5OSUnPjx0ZD48dGV4dGFyZWEgbmFtZT0nY29uZicgc3R5bGU9J3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCUnPiIpCiAgICAgICAgaWYgc2VsZi5zZXJ2ZXIuY29uZiBpcyBub3QgTm9uZToKICAgICAgICAgIHJlc3AgPSBqc29uLmR1bXBzKHNlbGYuc2VydmVyLmNvbmYsIGRlZmF1bHQ9YXNEaWN0LCBlbmNvZGluZz0iaXNvODg1OS0xIikKICAgICAgICBlbHNlOgogICAgICAgICAgcmVzcCA9ICIiCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZShyZXNwKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjwvdGV4dGFyZWE+PC90ZD48L3RyPiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPHRyPjx0ZD48aW5wdXQgdHlwZT0nc3VibWl0Jy8+PC90ZD48L3RyPiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPHRyPjx0ZCBzdHlsZT0nY29sb3I6cmVkJz4iICsgbXNnICsgIjwvdGQ+PC90cj4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjwvZm9ybT48L2JvZHk+PC9odG1sPiIpCiAgICAgIGRlZiBfc2VuZEpzb25FcnJvclJlc3BvbnNlKHNlbGYsIG1lc3NhZ2VJZCwgZXJyb3JNZXNzYWdlKToKICAgICAgICByZXNwb25zZU9iamVjdCA9IE5vbmUKICAgICAgICBpZiBzZWxmLmNvbW1hbmQgPT0gJ2NvbnRyb2wnOgogICAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBBbWF6b25FY2hvLkNvbnRyb2xSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgICAgZWxpZiBzZWxmLmNvbW1hbmQgPT0gJ2Rpc2NvdmVyeSc6CiAgICAgICAgICByZXNwb25zZU9iamVjdCA9IEFtYXpvbkVjaG8uRGlzY292ZXJ5UmVzcG9uc2UobWVzc2FnZUlkKQogICAgICAgIGVsc2U6CiAgICAgICAgICBzZWxmLnNlbmRfZXJyb3IoNDA0LCAnTm90IEZvdW5kJykKICAgICAgICAgIHJldHVybgogICAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoZXJyb3JNZXNzYWdlKQogICAgICAgIHNlbGYuX3NlbmRKc29uUmVzcG9uc2UocmVzcG9uc2VPYmplY3QpCiAgICAgIGRlZiBfc2VuZEpzb25SZXNwb25zZShzZWxmLCByZXNwb25zZU9iamVjdCk6CiAgICAgICAgcmVzcCA9IGpzb24uZHVtcHMocmVzcG9uc2VPYmplY3QsIGRlZmF1bHQ9YXNEaWN0LCBlbmNvZGluZz0iaXNvODg1OS0xIikKICAgICAgICBzZWxmLnNlbmRfcmVzcG9uc2UoMjAwKQogICAgICAgIHNlbGYuc2VuZF9oZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JykKICAgICAgICBzZWxmLmVuZF9oZWFkZXJzKCkKICAgICAgICBzZWxmLndmaWxlLndyaXRlKHJlc3ApCiAgICAgIGRlZiBfYnVpbGRSZXFQYXJhbU1hcChzZWxmLCBxdWVyeSk6CiAgICAgICAgaW1wb3J0IHVybGxpYgogICAgICAgIHJlcV9wYXJhbXMgPSB7fQogICAgICAgIHBhcmFtcyA9IHF1ZXJ5LnNwbGl0KCcmJykKICAgICAgICBmb3IgcGFyYW0gaW4gcGFyYW1zOgogICAgICAgICAgaWR4ID0gcGFyYW0uZmluZCgnPScpCiAgICAgICAgICByZXFfcGFyYW1zW3BhcmFtWzA6aWR4XV0gPSB1cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtW2lkeCArIDE6XSkKICAgICAgICByZXR1cm4gcmVxX3BhcmFtcwogICAgZGVmIHN0YXJ0KHNlbGYpOgogICAgICBzZWxmLmxvZygiU3RhcnQgIiwgc2V2ZXJpdHk9ImluZm8iKQogICAgICBpZiBzZWxmLnNlcnZlclRocmVhZCBpcyBOb25lOgogICAgICAgIEhUVFBTZXJ2ZXIuX19pbml0X18oc2VsZiwgKHNlbGYuaXAsIHNlbGYucG9ydCksIHNlbGYuSFRUUFJlcXVlc3RIYW5kbGVyKQogICAgICAgIGlmIHNlbGYuY2VydFRleHQgIT0gIiI6CiAgICAgICAgICB3aXRoIG9wZW4oc2VsZi5GSUxFUEFUSF9DRVJULCAid2IiKSBhcyBvdXRwdXQ6CiAgICAgICAgICAgIG91dHB1dC53cml0ZShzZWxmLmNlcnRUZXh0KQogICAgICAgICAgaW1wb3J0IHNzbAogICAgICAgICAgc2VsZi5zb2NrZXQgPSBzc2wud3JhcF9zb2NrZXQoc2VsZi5zb2NrZXQsIGNlcnRmaWxlPXNlbGYuRklMRVBBVEhfQ0VSVCwgc2VydmVyX3NpZGU9VHJ1ZSkKICAgICAgICBmcm9tIGhzX3F1ZXVlIGltcG9ydCBoc190aHJlYWRpbmcgYXMgdGhyZWFkaW5nCiAgICAgICAgc2VsZi5zZXJ2ZXJUaHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zZWxmLnNlcnZlX2ZvcmV2ZXIsIG5hbWU9J2FtYXpvbl9lY2hvX3NlcnZlcicpCiAgICAgICAgc2VsZi5zZXJ2ZXJUaHJlYWQuZGFlbW9uID0gVHJ1ZQogICAgICAgIHNlbGYuc2VydmVyVGhyZWFkLnN0YXJ0KCkKICAgIGRlZiBzdG9wKHNlbGYpOgogICAgICBzZWxmLmxvZygiU3RvcCAiLCBzZXZlcml0eT0iaW5mbyIpCiAgICAgIGlmIG5vdCBzZWxmLnNlcnZlclRocmVhZCBpcyBOb25lOgogICAgICAgIEhUVFBTZXJ2ZXIuc2h1dGRvd24oc2VsZikKICAgICAgICBzZWxmLnNvY2tldC5jbG9zZSgpCiAgICAgICAgc2VsZi5zZXJ2ZXJUaHJlYWQgPSBOb25lCiAgICBkZWYgZ2V0U1NMQ2VydChzZWxmLCBpcCwgY2VydEZpbGVuYW1lKToKICAgICAgaWYgSFM6CiAgICAgICAgdHJ5OgogICAgICAgICAgaW1wb3J0IHVybGxpYjIKICAgICAgICAgIHVybCA9ICJodHRwOi8vezB9L29wdC97MX0iLmZvcm1hdChpcCwgY2VydEZpbGVuYW1lKQogICAgICAgICAgcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCkKICAgICAgICAgIHJlcyA9IHVybGxpYjIudXJsb3BlbihyZXEpCiAgICAgICAgICBpZiByZXMuZ2V0Y29kZSgpID09IDIwMDoKICAgICAgICAgICAgcmV0dXJuIHJlcy5mcC5yZWFkKCkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICBwYXNzCiAgICAgIGVsc2U6CiAgICAgICAgd2l0aCBvcGVuKCdhbWF6b25FY2hvU1NMLmNlcnQnLCAncicpIGFzIG15ZmlsZToKICAgICAgICAgIGNlcnRUZXh0PW15ZmlsZS5yZWFkKCkKICAgICAgICByZXR1cm4gY2VydFRleHQKICAgICAgcmV0dXJuICIiCiAgICBkZWYgd2ViQ2FsbGJhY2tTU0xDZXJ0KHNlbGYsIHN0cmVhbT1GYWxzZSk6CiAgICAgIGh0bWwgPSAiPGh0bWw+PGhlYWQ+IgogICAgICBodG1sICs9ICI8bWV0YSBjaGFyc2V0PSdJU08tODg1OS0xJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdjYWNoZS1jb250cm9sJyBjb250ZW50PSdtYXgtYWdlPTAnLz4iCiAgICAgIGh0bWwgKz0gIjxtZXRhIGh0dHAtZXF1aXY9J2NhY2hlLWNvbnRyb2wnIGNvbnRlbnQ9J25vLWNhY2hlJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdleHBpcmVzJyBjb250ZW50PScwJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdleHBpcmVzJyBjb250ZW50PSdUdWUsIDAxIEphbiAxOTgwIDE6MDA6MDAgR01UJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdwcmFnbWEnIGNvbnRlbnQ9J25vLWNhY2hlJy8+IgogICAgICBodG1sICs9ICI8L2hlYWQ+PGJvZHk+IgogICAgICBodG1sICs9ICI8aDE+QW1hem9uIEVjaG8gLSBTU0wgQ2VydGlmaWNhdGU8L2gxPiIKICAgICAgaHRtbCArPSAiPHByZT48Y29kZT4iCiAgICAgIGh0bWwgKz0gc2VsZi5jZXJ0VGV4dAogICAgICBodG1sICs9ICI8L3ByZT48L2NvZGU+IgogICAgICBodG1sICs9ICI8L2JvZHk+PC9odG1sPiIKICAgICAgaWYgc3RyZWFtOgogICAgICAgICAgc3RyZWFtLndyaXRlKGh0bWwpCiAgICAgIHNlbGYuRGF0TGVuID0gbGVuKGh0bWwpCiAgICBkZWYgaW5pdF9kZWJ1Z19lbnRyeShzZWxmKToKICAgICAgcHJvdG8gPSAiaHR0cCIKICAgICAgaWYgc2VsZi5jZXJ0VGV4dCAhPSAiIjoKICAgICAgICBwcm90byA9ICJodHRwcyIKICAgICAgaW1wb3J0IHVybGxpYgogICAgICBzZWxmLk1DLkRlYnVnLmFkZEdydXBwZSgKICAgICAgICBbc2VsZi5pZCwgc2VsZi5pZF0sCiAgICAgICAgICBbIAogICAgICAgICAgICBbIjBWRVJTSU9OSU5GTyIsIlZlcnNpb24iLDEsJ1YwLjEgLSAoMjAxNi0xMi0wMSAxMjo1NiknXSwKICAgICAgICAgICAgWyIxUE9SVCIsIlBvcnQiLDEsc3RyKHNlbGYucG9ydCldLAogICAgICAgICAgICBbIjJTU0wiLCJTU0wtQ2VydGlmaWNhdGUiLDEsIjxhIGhyZWY9Jy9vcHQvezB9Jz5zaG93PC9hPjxicj4iLmZvcm1hdChzZWxmLlVSTF9TSE9XX1NTTCldLAogICAgICAgICAgICBbIjNDT05GSUciLCJBcHBsaWFuY2VzIGNvbmZpZ3VyYXRpb24iLDEsIjxhIGhyZWY9J3swfTovL3sxfTp7Mn0vY29uZmlnP2FjY2Vzc1Rva2VuPXszfSc+ZWRpdDwvYT48YnI+Ii5mb3JtYXQocHJvdG8sIHNlbGYuaXAsIHNlbGYucG9ydCwgdXJsbGliLnF1b3RlX3BsdXMoc2VsZi5hY2Nlc3NUb2tlbikpXSwKICAgICAgICAgIF0gICAKICAgICAgKQogICAgZGVmIGRlYnVnKHNlbGYsIG1zZywgbHZsPTUpOgogICAgICBpbXBvcnQgdGltZQogICAgICBzZWxmLmxvZyhtc2csIHNldmVyaXR5PSdkZWJ1ZycpCiAgICAgIHByaW50ICIlcyBERUJVRzogJXIiICUgKHRpbWUuc3RyZnRpbWUoIiVIOiVNOiVTIiksIG1zZywgKQogICAgZGVmIGxvZyhzZWxmLCBtc2csIHNldmVyaXR5PSdpbmZvJyk6CiAgICAgIGltcG9ydCB0aW1lCiAgICAgIGZyb20gaGFzaGxpYiBpbXBvcnQgbWQ1CiAgICAgIF9tc2dfdWlkID0gbWQ1KCAiJXMlcyIgJSAoIHNlbGYuaWQsIHRpbWUudGltZSgpICkgKS5oZXhkaWdlc3QoKQogICAgICBfbXNnID0gJzxsb2c+PGlkPiVzPC9pZD48ZmFjaWxpdHk+QW1hem9uX0VjaG9fU2VydmVyPC9mYWNpbGl0eT48c2V2ZXJpdHk+JXM8L3NldmVyaXR5PjxtZXNzYWdlPiVzPC9tZXNzYWdlPjwvbG9nPicgJSAoX21zZ191aWQsIHNldmVyaXR5LCBtc2cpCiAgICAgIHNlbGYuc2VuZFRvT3V0cHV0KDEsX21zZykKICAgIGRlZiBzZW5kVG9PdXRwdXQoc2VsZiwgb3V0LCBtc2cpOgogICAgICBvdXQgLT0gMQogICAgICBzZWxmLmxvY2Fsc1siQU4iXVtvdXRdID0gbXNnCiAgICAgIHNlbGYubG9jYWxzWyJBQyJdW291dF0gPSAxICAK'),'<10013_Amazon Echo (10013)>','exec'))"|""|0|0|0|0
## MD5 der Formelzeile: a4436cc16b86df70ae1ba0d114ef6ddb
### Klasse AmazonEcho
################################
## Quelltext nicht Öffentlich ##
################################




## Klasse auf SN1 
5012|1|"EI"|"1"|"10"|0|1|0|0
5012|0|"OC[1]"|"AmazonEcho(locals())"|""|0|0|1|0

#5012|abbruch bei bed. (0/1)|bedingung|formel|zeit|pin-ausgang|pin-offset|pin-speicher|pin-neg.ausgang
5012|0|"(OC[1] or EC[1]) and EN[1]"|"SN[1].start()"|""|0|0|0|0
5012|0|"EC[1] and not EN[1]"|"SN[1].stop()"|""|0|0|0|0



