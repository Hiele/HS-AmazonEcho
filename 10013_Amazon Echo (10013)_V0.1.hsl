# -*- coding: iso8859-1 -*-
## -----------------------------------------------------
## Amazon Echo (10013)   ### V0.1
##
## erstellt am: 2016-11-26 09:51
## -----------------------------------------------------
## Copyright © 2016, Werner Lindbüchl, All rights reserved.
##
## This program is free software; you can redistribute it and/or modify it under the terms
## of the GNU General Public License as published by the Free Software Foundation; either
## version 3 of the License, or (at your option) any later version.
##
## This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
## without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
## See the GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License along with this program;
## if not, see <http://www.gnu.de/documents/gpl-3.0.de.html>.

## -- 
## --  

#5000|"Text"|Remanent(1/0)|Anz.Eingänge|.n.|Anzahl Ausgänge|.n.|.n.
5000|"#WJL\Amazon Echo (10013)_V0.1"|1|3|"E1 Https-Server Start/Stop"|"E2 Https-Server Port"|"E3 Access Token"|1|"A1 Systemlog"|"V0.1"

#5001|Anzahl Eingänge|Ausgänge|Offset|Speicher|Berechnung bei Start
5001|3|1|1|2|1

# Eingaenge
#5002|Index Eingang|Default Wert|0=numerisch 1=alphanummerisch
5002|1|0|0	#* E1 Https-Server Start/Stop 
5002|2|0|0	#* E2 Https-Server Port 
5002|3|0|1	#* E3 Access Token 

# Speicher
#5003|Speicher|Initwert|Remanent
5003|1||0		  #* 
5003|2||1		  #* 

# Ausgaenge
#5004|ausgang|Initwert|runden binär (0/1)|typ (1-send/2-sbc)|0=numerisch 1=alphanummerisch
5004|1|""|0|1|1 

#################################################

5012|0|"OC[1]"|"eval(compile(__import__('base64').decodestring('CmlmIE9DWzFdPT0xOgogIGdsb2JhbCBhc0RpY3QKICBkZWYgYXNEaWN0KG8pOgogICAgICByZXR1cm4gby5fX2RpY3RfXwogIGdsb2JhbCBIVFRQU2VydmVyCiAgZ2xvYmFsIEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBmcm9tIEJhc2VIVFRQU2VydmVyIGltcG9ydCBIVFRQU2VydmVyLEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBnbG9iYWwgVGhyZWFkaW5nTWl4SW4KICBmcm9tIFNvY2tldFNlcnZlciBpbXBvcnQgVGhyZWFkaW5nTWl4SW4KICBnbG9iYWwganNvbgogIGltcG9ydCBqc29uCiAgZ2xvYmFsIEFtYXpvbkVjaG9XZWJDYWxsYmFjawogIGNsYXNzIEFtYXpvbkVjaG9XZWJDYWxsYmFjayhvYmplY3QpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHBJdGVtLCBjYWxsYmFjaywgbmFtZSwgdHlwZT0ndGV4dC9odG1sJyk6CiAgICAgIHNlbGYubG9naWsgPSBwSXRlbQogICAgICBzZWxmLmNhbGxiYWNrID0gY2FsbGJhY2sKICAgICAgc2VsZi5NQyA9IHBJdGVtLk1DCiAgICAgIHNlbGYuVXJsUGZhZCA9IG5hbWUudXBwZXIoKQogICAgICBzZWxmLkRhdE5hbWUgPSAiT1BULyVzIiAlIChzZWxmLlVybFBmYWQpCiAgICAgIHNlbGYuRGF0TGVuID0gMAogICAgICBzZWxmLlR5cCA9IHR5cGUKICAgICAgc2VsZi5pc1F1YWQgPSAwCiAgICAgIHNlbGYuTUMuR1VJLkV4dERhdFVybFtzZWxmLlVybFBmYWRdID0gc2VsZgogICAgZGVmIGdldERhdGVuKHNlbGYpOgogICAgICByZXR1cm4KICAgIGRlZiBnZXRRdWFkRGF0ZW4oc2VsZik6CiAgICAgIHJldHVybiAKICAgIGRlZiBnZXREYXRlblN0cmVhbShzZWxmLCBzdHJlYW0pOgogICAgICBzZWxmLkRhdExlbiA9IHNlbGYuY2FsbGJhY2soc3RyZWFtKQogICAgZGVmIGdldFF1YWREYXRlblN0cmVhbShzZWxmLCBzdHJlYW0pOgogICAgICBzZWxmLmdldERhdGVuU3RyZWFtKHN0cmVhbSkKICBnbG9iYWwgQW1hem9uRWNobwogIGNsYXNzIEFtYXpvbkVjaG8oVGhyZWFkaW5nTWl4SW4sIEhUVFBTZXJ2ZXIpOgogICAgUEFUSF9CQVNFID0gIi90bXAvIgogICAgRklMRU5BTUVfQ0VSVCA9ICJhbWF6b25FY2hvU1NMLmNlcnQiCiAgICBGSUxFUEFUSF9DRVJUID0gUEFUSF9CQVNFICsgRklMRU5BTUVfQ0VSVAogICAgVVJMX0JBU0UgPSAiYW1hem9uRWNoby8iCiAgICBVUkxfU0hPV19TU0wgPSBVUkxfQkFTRSArICJzc2xDZXJ0Lmh0bSIKICAgIGFsbG93X3JldXNlX2FkZHJlc3MgPSBUcnVlCiAgICBkZWYgX19pbml0X18oc2VsZiwgbG9jYWxzKToKICAgICAgc2VsZi5sb2NhbHMgPSBsb2NhbHM7CiAgICAgIHNlbGYubG9naWsgPSBsb2NhbHNbJ3BJdGVtJ10KICAgICAgc2VsZi5NQyA9IHNlbGYubG9naWsuTUMKICAgICAgc2VsZi5pcCA9IHNlbGYuTUMuRXRoZXJuZXQuSVBBZHIKICAgICAgRU4gPSBsb2NhbHNbJ0VOJ10KICAgICAgc2VsZi5wb3J0ID0gaW50KEVOWzJdKQogICAgICBzZWxmLmFjY2Vzc1Rva2VuID0gRU5bM10KICAgICAgc2VsZi5pZCA9ICdBbWF6b25fRWNob19TZXJ2ZXInCiAgICAgIHNlbGYuc2VydmVyVGhyZWFkID0gTm9uZQogICAgICBzZWxmLmNlcnRUZXh0ID0gc2VsZi5nZXRTU0xDZXJ0KHNlbGYuaXAsIHNlbGYuRklMRU5BTUVfQ0VSVCkKICAgICAgc2VsZi5pbml0QXBwbGlhbmNlcygpCiAgICAgIEFtYXpvbkVjaG9XZWJDYWxsYmFjayhzZWxmLmxvZ2lrLCBzZWxmLndlYkNhbGxiYWNrU1NMQ2VydCwgc2VsZi5VUkxfU0hPV19TU0wpCiAgICAgIHNlbGYuaW5pdF9kZWJ1Z19lbnRyeSgpOwogICAgZGVmIHJlYWRBcHBsaWFuY2VzQ29uZihzZWxmKToKICAgICAgdHJ5OgogICAgICAgIGFwcGxpYW5jZXNDb25mID0gc2VsZi5sb2NhbHNbJ1NOJ11bMl0KICAgICAgICBzZWxmLmNvbmYgPSBqc29uLmxvYWRzKGFwcGxpYW5jZXNDb25mLCBlbmNvZGluZz0iaXNvODg1OS0xIikKICAgICAgZXhjZXB0OgogICAgICAgIHNlbGYuY29uZiA9IE5vbmUKICAgIGRlZiBzYXZlQXBwbGlhbmNlc0NvbmYoc2VsZiwgYXBwbGlhbmNlc0NvbmYpOgogICAgICBzZWxmLmxvZygiU2F2aW5nIGFwcGxpYW5jZXMgY29uZmlndXJhdGlvbi4iLCBzZXZlcml0eT0iaW5mbyIpCiAgICAgIG1zZyA9ICIiCiAgICAgIHRyeToKICAgICAgICBpZiBhcHBsaWFuY2VzQ29uZiAhPSAiIjoKICAgICAgICAgIHNlbGYuY29uZiA9IGpzb24ubG9hZHMoYXBwbGlhbmNlc0NvbmYsIGVuY29kaW5nPSJpc284ODU5LTEiKQogICAgICAgIGVsc2U6CiAgICAgICAgICBzZWxmLmNvbmYgPSBOb25lCiAgICAgICAgc2VsZi5sb2dpay5TcGVpY2hlcldlcnRbMV0gPSBhcHBsaWFuY2VzQ29uZgogICAgICAgIHNlbGYuTUMuU2ljaFF1ZXVlLnB1dChbMTAwLCBzZWxmLmxvZ2lrLCBzZWxmLmxvZ2lrLlNwZWljaGVyV2VydF0pCiAgICAgIGV4Y2VwdDoKICAgICAgICBtc2cgPSAiRmFpbGVkIHRvIHBhcnNlIGFwcGxpYW5jZXMgY29uZmlndXJhdGlvbi4iCiAgICAgICAgc2VsZi5NQy5EZWJ1Zy5zZXRFcnIoc3lzLmV4Y19pbmZvKCksIG1zZykKICAgICAgcmV0dXJuIG1zZwogICAgZGVmIGluaXRBcHBsaWFuY2VzKHNlbGYpOgogICAgICBzZWxmLnJlYWRBcHBsaWFuY2VzQ29uZigpCiAgICAgIHNlbGYuYXBwbGlhbmNlcyA9IFtdCiAgICAgIGlmIHNlbGYuY29uZiBpcyBOb25lOgogICAgICAgIHNlbGYuZGlzY292ZXJBcHBsaWFuY2VzKCkKICAgIGRlZiBkaXNjb3ZlckFwcGxpYW5jZXMoc2VsZik6CiAgICAgIGltcG9ydCByZQogICAgICByZWdleCA9IHJlLmNvbXBpbGUoIiguKilcW1xzKihTd2l0Y2hhYmxlfExpZ2h0aW5nKVxzKlxdXHMqJCIpCiAgICAgIGZvciBpa28gaW4gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3Q6IAogICAgICAgIGtvID0gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3RbaWtvXQogICAgICAgIG1hdGNoID0gcmVnZXguc2VhcmNoKGtvLlJQQ1RleHQpCiAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICBhcHBsaWFuY2UgPSBBbWF6b25FY2hvLktOWEFwcGxpYW5jZShrbywgbWF0Y2guZ3JvdXBzKClbMF0uc3RyaXAoKSwgbWF0Y2guZ3JvdXBzKClbMV0pCiAgICAgICAgICBzZWxmLmFwcGxpYW5jZXMuYXBwZW5kKGFwcGxpYW5jZSkKICAgIGNsYXNzIEtOWEFwcGxpYW5jZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwga28sIGZyaWVuZGx5TmFtZSwgdHlwZSk6CiAgICAgICAgc2VsZi5rbyA9IGtvCiAgICAgICAgc2VsZi5mcmllbmRseU5hbWUgPSBmcmllbmRseU5hbWUKICAgICAgICBzZWxmLnR5cGUgPSB0eXBlCiAgICBkZWYgZGlzY292ZXJ5KHNlbGYsIG1lc3NhZ2VJZCk6CiAgICAgIHJlc3BvbnNlT2JqZWN0ID0gQW1hem9uRWNoby5EaXNjb3ZlcnlSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgIGlmIHNlbGYuY29uZiBpcyBub3QgTm9uZToKICAgICAgICBpZCA9IDAKICAgICAgICBmb3IgZGV2aWNlIGluIHNlbGYuY29uZjoKICAgICAgICAgIHJvb20gPSBkZXZpY2UuZ2V0KCdyb29tJykKICAgICAgICAgIGlkICs9IDEKICAgICAgICAgIGlkU3RyID0gc3RyKGlkKQogICAgICAgICAgamQgPSAwCiAgICAgICAgICBmb3IgYXBwbGlhbmNlIGluIGRldmljZS5nZXQoJ2FwcGxpYW5jZXMnKToKICAgICAgICAgICAgamQgKz0gMQogICAgICAgICAgICB0eXBlID0gJ1N3aXRjaGFibGUnCiAgICAgICAgICAgIHBlcmNlbnQgPSBhcHBsaWFuY2UuZ2V0KCdwZXJjZW50Jyk7CiAgICAgICAgICAgIGlmIHBlcmNlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgdHlwZSA9ICdMaWdodGluZycKICAgICAgICAgICAgaWYgcm9vbSBpcyBub3QgTm9uZSBhbmQgcm9vbSAhPSAiIjoKICAgICAgICAgICAgICBpZiBqZCA9PSAxOgogICAgICAgICAgICAgICAgZGlzY292ZXJ5QXBwbGlhbmNlID0gQW1hem9uRWNoby5EaXNjb3ZlcnlBcHBsaWFuY2UoaWRTdHIsIHJvb20sIHR5cGUpCiAgICAgICAgICAgICAgICByZXNwb25zZU9iamVjdC5hZGRBcHBsaWFuY2UoZGlzY292ZXJ5QXBwbGlhbmNlKQogICAgICAgICAgICAgIG5hbWUgPSBhcHBsaWFuY2UuZ2V0KCduYW1lJykKICAgICAgICAgICAgICBpZiBuYW1lIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBuYW1lID0gcm9vbQogICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuYW1lID0gcm9vbSArICIgIiArIG5hbWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICBuYW1lID0gYXBwbGlhbmNlLmdldCgnbmFtZScpCiAgICAgICAgICAgICAgaWYgbmFtZSBpcyBOb25lOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZGlzY292ZXJ5QXBwbGlhbmNlID0gQW1hem9uRWNoby5EaXNjb3ZlcnlBcHBsaWFuY2UoaWRTdHIgKyAiXyIgKyBzdHIoamQpLCBuYW1lLCB0eXBlKQogICAgICAgICAgICByZXNwb25zZU9iamVjdC5hZGRBcHBsaWFuY2UoZGlzY292ZXJ5QXBwbGlhbmNlKQogICAgICAgICAgICBhbGlhc2VzID0gYXBwbGlhbmNlLmdldCgnYWxpYXNlcycpOwogICAgICAgICAgICBpZiBhbGlhc2VzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgIGZvciBhbGlhcyBpbiBhbGlhc2VzOgogICAgICAgICAgICAgICAgamQgKz0gMQogICAgICAgICAgICAgICAgZGlzY292ZXJ5QXBwbGlhbmNlID0gQW1hem9uRWNoby5EaXNjb3ZlcnlBcHBsaWFuY2UoaWRTdHIgKyAiXyIgKyBzdHIoamQpLCBhbGlhcywgdHlwZSkKICAgICAgICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgIGVsc2U6CiAgICAgICAgZm9yIGFwcGxpYW5jZSBpbiBzZWxmLmFwcGxpYW5jZXM6CiAgICAgICAgICBrbyA9IGFwcGxpYW5jZS5rbwogICAgICAgICAgZGlzY292ZXJ5QXBwbGlhbmNlID0gQW1hem9uRWNoby5EaXNjb3ZlcnlBcHBsaWFuY2Uoc3RyKGtvLklEKSwgYXBwbGlhbmNlLmZyaWVuZGx5TmFtZSwgYXBwbGlhbmNlLnR5cGUpCiAgICAgICAgICByZXNwb25zZU9iamVjdC5hZGRBcHBsaWFuY2UoZGlzY292ZXJ5QXBwbGlhbmNlKQogICAgICByZXR1cm4gcmVzcG9uc2VPYmplY3QKICAgIGRlZiBjb250cm9sKHNlbGYsIG1lc3NhZ2VJZCwgYXBwbGlhbmNlSWQsIHJlcXVlc3QsIHZhbHVlKToKICAgICAgcmVzcG9uc2VPYmplY3QgPSBBbWF6b25FY2hvLkNvbnRyb2xSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoIlVuc3VwcG9ydGVkT3BlcmF0aW9uRXJyb3IiKQogICAgICBhcHBsaWFuY2UgPSBzZWxmLmZpbmRBcHBsaWFuY2UoYXBwbGlhbmNlSWQpCiAgICAgIGlmIGFwcGxpYW5jZSBpcyBub3QgTm9uZToKICAgICAgICBvblZhbHVlID0gMS4wCiAgICAgICAgb2ZmVmFsdWUgPSAwLjAKICAgICAgICBpZiB0eXBlKGFwcGxpYW5jZSkgaXMgbm90IEFtYXpvbkVjaG8uS05YQXBwbGlhbmNlOgogICAgICAgICAgb25PZmZLbyA9IHNlbGYuZmluZEtvKGFwcGxpYW5jZVsnb25PZmYnXSkKICAgICAgICAgIGlmIG9uT2ZmS28gaXMgTm9uZToKICAgICAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiTm9TdWNoVGFyZ2V0RXJyb3IiKQogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VPYmplY3QKICAgICAgICAgIHBlcmNlbnQgPSBhcHBsaWFuY2UuZ2V0KCdwZXJjZW50Jyk7CiAgICAgICAgICBpZiBwZXJjZW50IGlzIG5vdCBOb25lOgogICAgICAgICAgICBhcHBsaWFuY2VUeXBlID0gIkxpZ2h0aW5nIgogICAgICAgICAgICBwZXJjZW50S28gPSBzZWxmLmZpbmRLbyhhcHBsaWFuY2VbJ3BlcmNlbnQnXSkKICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFwcGxpYW5jZVR5cGUgPSAiU3dpdGNoYWJsZSIKICAgICAgICAgIGFwcGxpYW5jZVZhbHVlID0gYXBwbGlhbmNlLmdldCgndmFsdWUnKQogICAgICAgICAgaWYgYXBwbGlhbmNlVmFsdWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIG9uVmFsdWUgPSBhcHBsaWFuY2VWYWx1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICBhcHBsaWFuY2VUeXBlID0gYXBwbGlhbmNlLnR5cGUKICAgICAgICAgIG9uT2ZmS28gPSBwZXJjZW50S28gPSBhcHBsaWFuY2Uua28KICAgICAgICAgIGlmIGFwcGxpYW5jZVR5cGUgPT0gIkxpZ2h0aW5nIjoKICAgICAgICAgICAgb25WYWx1ZSA9IDEwMC4wCiAgICAgICAgaWYgYXBwbGlhbmNlVHlwZSA9PSAiTGlnaHRpbmciOgogICAgICAgICAgaWYgcmVxdWVzdCA9PSAnVHVybk9uUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKG9uT2ZmS28sIG9uVmFsdWUsICJUdXJuT25Db25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnVHVybk9mZlJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShvbk9mZktvLCBvZmZWYWx1ZSwgIlR1cm5PZmZDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnU2V0UGVyY2VudGFnZVJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRQZXJjZW50KHBlcmNlbnRLbywgdmFsdWUsICJTZXRQZXJjZW50YWdlQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgICBlbGlmIHJlcXVlc3QgPT0gJ0luY3JlbWVudFBlcmNlbnRhZ2VSZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YQWRkUGVyY2VudChwZXJjZW50S28sIHZhbHVlLCAxLCAiSW5jcmVtZW50UGVyY2VudGFnZUNvbmZpcm1hdGlvbiIsIHJlc3BvbnNlT2JqZWN0KQogICAgICAgICAgZWxpZiByZXF1ZXN0ID09ICdEZWNyZW1lbnRQZXJjZW50YWdlUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWEFkZFBlcmNlbnQocGVyY2VudEtvLCB2YWx1ZSwgLTEsICJEZWNyZW1lbnRQZXJjZW50YWdlQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxpZiBhcHBsaWFuY2VUeXBlID09ICJTd2l0Y2hhYmxlIjoKICAgICAgICAgIGlmIHJlcXVlc3QgPT0gJ1R1cm5PblJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShvbk9mZktvLCBvblZhbHVlLCAiVHVybk9uQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgICBlbGlmIHJlcXVlc3QgPT0gJ1R1cm5PZmZSZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YU2V0VmFsdWUob25PZmZLbywgb2ZmVmFsdWUsICJUdXJuT2ZmQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxzZToKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoIlVuZXhwZWN0ZWRJbmZvcm1hdGlvblJlY2VpdmVkRXJyb3IiKQogICAgICBlbHNlOgogICAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoIk5vU3VjaFRhcmdldEVycm9yIikKICAgICAgcmV0dXJuIHJlc3BvbnNlT2JqZWN0CiAgICBkZWYgX0tOWEFkZFBlcmNlbnQoc2VsZiwga28sIHZhbHVlLCBzaWduLCBuYW1lLCByZXNwb25zZU9iamVjdCk6CiAgICAgIHRyeToKICAgICAgICBmdmFsdWUgPSBrby5nZXRXZXJ0KCkgKyAoc2lnbiAqIGZsb2F0KHZhbHVlKSkKICAgICAgICBpZiBmdmFsdWUgPCAwLjA6CiAgICAgICAgICBmdmFsdWUgPSAwLjAKICAgICAgICBlbGlmIGZ2YWx1ZSA+IDEwMC4wOgogICAgICAgICAgZnZhbHVlID0gMTAwLjAKICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShrbywgZnZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCkKICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5zdXBwb3J0ZWRUYXJnZXRTZXR0aW5nRXJyb3IiKQogICAgZGVmIF9LTlhTZXRQZXJjZW50KHNlbGYsIGtvLCB2YWx1ZSwgbmFtZSwgcmVzcG9uc2VPYmplY3QpOgogICAgICB0cnk6CiAgICAgICAgZnZhbHVlID0gZmxvYXQodmFsdWUpCiAgICAgICAgaWYgZnZhbHVlID49IDAuMCBhbmQgZnZhbHVlIDw9IDEwMC4wOgogICAgICAgICAgc2VsZi5fS05YU2V0VmFsdWUoa28sIGZ2YWx1ZSwgbmFtZSwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxzZToKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoIlZhbHVlT3V0T2ZSYW5nZUVycm9yIikKICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5zdXBwb3J0ZWRUYXJnZXRTZXR0aW5nRXJyb3IiKQogICAgZGVmIF9LTlhTZXRWYWx1ZShzZWxmLCBrbywgZnZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCk6CiAgICAgIHNlbGYubG9naWsuTUMuVGFnTGlzdC5zZXRXZXJ0KEZMQUdfRUlCX0xPR0lLLCBrbywgZnZhbHVlKQogICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKG5hbWUpCiAgICBkZWYgZmluZEFwcGxpYW5jZShzZWxmLCBhcHBsaWFuY2VJZCk6CiAgICAgIGlmIHNlbGYuY29uZiBpcyBub3QgTm9uZToKICAgICAgICBpZCA9IDAKICAgICAgICBmb3IgZGV2aWNlIGluIHNlbGYuY29uZjoKICAgICAgICAgIHJvb20gPSBkZXZpY2UuZ2V0KCdyb29tJykKICAgICAgICAgIGlkICs9IDEKICAgICAgICAgIGlkU3RyID0gc3RyKGlkKQogICAgICAgICAgaWYgYXBwbGlhbmNlSWQgPT0gaWRTdHI6CiAgICAgICAgICAgIHJldHVybiBkZXZpY2VbJ2FwcGxpYW5jZXMnXVswXQogICAgICAgICAgamQgPSAwCiAgICAgICAgICBmb3IgYXBwbGlhbmNlIGluIGRldmljZVsnYXBwbGlhbmNlcyddOgogICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgIGlmIGFwcGxpYW5jZUlkID09IGlkU3RyICsgIl8iICsgc3RyKGpkKToKICAgICAgICAgICAgICByZXR1cm4gYXBwbGlhbmNlCiAgICAgICAgICAgIGFsaWFzZXMgPSBhcHBsaWFuY2UuZ2V0KCdhbGlhc2VzJyk7CiAgICAgICAgICAgIGlmIGFsaWFzZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgZm9yIGFsaWFzIGluIGFsaWFzZXM6CiAgICAgICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgICAgICBpZiBhcHBsaWFuY2VJZCA9PSBpZFN0ciArICJfIiArIHN0cihqZCk6CiAgICAgICAgICAgICAgICAgIHJldHVybiBhcHBsaWFuY2UKICAgICAgZWxzZToKICAgICAgICBmb3IgYXBwbGlhbmNlIGluIHNlbGYuYXBwbGlhbmNlczoKICAgICAgICAgIGtvID0gYXBwbGlhbmNlLmtvCiAgICAgICAgICBpZiBzdHIoa28uSUQpID09IGFwcGxpYW5jZUlkOgogICAgICAgICAgICByZXR1cm4gYXBwbGlhbmNlCiAgICAgIHJldHVybiBOb25lCiAgICBkZWYgZmluZEtvKHNlbGYsIGdycEFkclN0cik6CiAgICAgIGZvciBpa28gaW4gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3Q6IAogICAgICAgIGtvID0gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3RbaWtvXQogICAgICAgIGlmIGtvLkdycEFkclN0ciA9PSBncnBBZHJTdHI6CiAgICAgICAgICByZXR1cm4ga28KICAgICAgcmV0dXJuIE5vbmU7CiAgICBjbGFzcyBIZWFkZXIoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIG1lc3NhZ2VJZCwgbmFtZSwgbmFtZXNwYWNlLCBwYXlsb2FkVmVyc2lvbik6CiAgICAgICAgc2VsZi5tZXNzYWdlSWQgPSBtZXNzYWdlSWQKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCiAgICAgICAgc2VsZi5uYW1lc3BhY2UgPSBuYW1lc3BhY2UKICAgICAgICBzZWxmLnBheWxvYWRWZXJzaW9uID0gcGF5bG9hZFZlcnNpb24KICAgIGNsYXNzIENvbnRyb2xSZXNwb25zZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwgbWVzc2FnZUlkKToKICAgICAgICBzZWxmLmhlYWRlciA9IEFtYXpvbkVjaG8uSGVhZGVyKG1lc3NhZ2VJZCwgIiIsICJBbGV4YS5Db25uZWN0ZWRIb21lLkNvbnRyb2wiLCAiMiIpCiAgICAgICAgc2VsZi5wYXlsb2FkID0ge30KICAgICAgZGVmIHNldE5hbWUoc2VsZiwgbmFtZSk6CiAgICAgICAgc2VsZi5oZWFkZXIubmFtZSA9IG5hbWUKICAgIGNsYXNzIERpc2NvdmVyeVJlc3BvbnNlKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtZXNzYWdlSWQpOgogICAgICAgIHNlbGYuaGVhZGVyID0gQW1hem9uRWNoby5IZWFkZXIobWVzc2FnZUlkLCAiRGlzY292ZXJBcHBsaWFuY2VzUmVzcG9uc2UiLCAiQWxleGEuQ29ubmVjdGVkSG9tZS5EaXNjb3ZlcnkiLCAiMiIpCiAgICAgICAgc2VsZi5wYXlsb2FkID0gQW1hem9uRWNoby5EaXNjb3ZlcnlQYXlsb2FkKCkKICAgICAgZGVmIHNldE5hbWUoc2VsZiwgbmFtZSk6CiAgICAgICAgc2VsZi5oZWFkZXIubmFtZSA9IG5hbWUKICAgICAgZGVmIGFkZEFwcGxpYW5jZShzZWxmLCBhcHBsaWFuY2UpOgogICAgICAgIHNlbGYucGF5bG9hZC5kaXNjb3ZlcmVkQXBwbGlhbmNlcy5hcHBlbmQoYXBwbGlhbmNlKQogICAgY2xhc3MgRGlzY292ZXJ5UGF5bG9hZCgpOgogICAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5kaXNjb3ZlcmVkQXBwbGlhbmNlcyA9IFtdCiAgICBjbGFzcyBEaXNjb3ZlcnlBcHBsaWFuY2UoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIGFwcGxpYW5jZUlkLCBmcmllbmRseU5hbWUsIGFwcGxpYW5jZVR5cGUpOgogICAgICAgIHNlbGYuYXBwbGlhbmNlSWQgPSBhcHBsaWFuY2VJZAogICAgICAgIHNlbGYuZnJpZW5kbHlEZXNjcmlwdGlvbiA9IGZyaWVuZGx5TmFtZQogICAgICAgIHNlbGYuZnJpZW5kbHlOYW1lID0gZnJpZW5kbHlOYW1lCiAgICAgICAgc2VsZi5pc1JlYWNoYWJsZSA9IFRydWUKICAgICAgICBzZWxmLm1hbnVmYWN0dXJlck5hbWUgPSAibi5hLiIKICAgICAgICBzZWxmLm1vZGVsTmFtZSA9ICJuLmEuIgogICAgICAgIHNlbGYudmVyc2lvbiA9ICIxLjAiCiAgICAgICAgaWYgYXBwbGlhbmNlVHlwZSA9PSAiU3dpdGNoYWJsZSI6CiAgICAgICAgICBzZWxmLmFjdGlvbnMgPSBbInR1cm5PbiIsICJ0dXJuT2ZmIl0KICAgICAgICBlbGlmIGFwcGxpYW5jZVR5cGUgPT0gIkxpZ2h0aW5nIjoKICAgICAgICAgIHNlbGYuYWN0aW9ucyA9IFsidHVybk9uIiwgInR1cm5PZmYiLCAiaW5jcmVtZW50UGVyY2VudGFnZSIsICJkZWNyZW1lbnRQZXJjZW50YWdlIiwgInNldFBlcmNlbnRhZ2UiXQogICAgICAgIGVsaWYgYXBwbGljYW5jZVR5cGUgPT0gIlRoZXJtb3N0YXQiOgogICAgICAgICAgc2VsZi5hY3Rpb25zID0gWyJpbmNyZW1lbnRUYXJnZXRUZW1wZXJhdHVyZSIsICJkZWNyZW1lbnRUYXJnZXRUZW1wZXJhdHVyZSIsICJzZXRUYXJnZXRUZW1wZXJhdHVyZSJdCiAgICBjbGFzcyBIVFRQUmVxdWVzdEhhbmRsZXIoQmFzZUhUVFBSZXF1ZXN0SGFuZGxlcik6CiAgICAgIGRlZiBhZGRyZXNzX3N0cmluZyhzZWxmKToKICAgICAgICAgIGhvc3QsIHBvcnQgPSBzZWxmLmNsaWVudF9hZGRyZXNzWzoyXQogICAgICAgICAgcmV0dXJuIGhvc3QKICAgICAgZGVmIGxvZ19yZXF1ZXN0KHNlbGYsIGNvZGU9Tm9uZSwgc2l6ZT1Ob25lKToKICAgICAgICBwYXNzCiAgICAgIGRlZiBsb2dfbWVzc2FnZShzZWxmLCBmb3JtYXQsICphcmdzKToKICAgICAgICBwYXNzCiAgICAgIGRlZiBkb19QT1NUKHNlbGYpOgogICAgICAgIHNlbGYucG9zdHZhcnMgPSBzZWxmLnBhcnNlX1BPU1QoKQogICAgICAgIHNlbGYuZG9fUkVRKCkKICAgICAgZGVmIHBhcnNlX1BPU1Qoc2VsZik6CiAgICAgICAgZnJvbSBjZ2kgaW1wb3J0IHBhcnNlX2hlYWRlciwgcGFyc2VfbXVsdGlwYXJ0CiAgICAgICAgZnJvbSB1cmxwYXJzZSBpbXBvcnQgcGFyc2VfcXMKICAgICAgICBjdHlwZSwgcGRpY3QgPSBwYXJzZV9oZWFkZXIoc2VsZi5oZWFkZXJzWydjb250ZW50LXR5cGUnXSkKICAgICAgICBpZiBjdHlwZSA9PSAnbXVsdGlwYXJ0L2Zvcm0tZGF0YSc6CiAgICAgICAgICAgIHBvc3R2YXJzID0gcGFyc2VfbXVsdGlwYXJ0KHNlbGYucmZpbGUsIHBkaWN0KQogICAgICAgIGVsaWYgY3R5cGUgPT0gJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCc6CiAgICAgICAgICAgIGxlbmd0aCA9IGludChzZWxmLmhlYWRlcnNbJ2NvbnRlbnQtbGVuZ3RoJ10pCiAgICAgICAgICAgIHBvc3R2YXJzID0gcGFyc2VfcXMoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZmlsZS5yZWFkKGxlbmd0aCksIAogICAgICAgICAgICAgICAgICAgIGtlZXBfYmxhbmtfdmFsdWVzPTEpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcG9zdHZhcnMgPSB7fQogICAgICAgIHJldHVybiBwb3N0dmFycwogICAgICBkZWYgZG9fR0VUKHNlbGYpOgogICAgICAgIHNlbGYucG9zdHZhcnMgPSBOb25lCiAgICAgICAgc2VsZi5kb19SRVEoKQogICAgICBkZWYgZG9fUkVRKHNlbGYpOgogICAgICAgIGFjY2Vzc1Rva2VuID0gTm9uZQogICAgICAgIG1lc3NhZ2VJZCA9IE5vbmUKICAgICAgICB0cnk6CiAgICAgICAgICBpZHggPSBzZWxmLnBhdGguaW5kZXgoIj8iKQogICAgICAgICAgc2VsZi5jb21tYW5kID0gc2VsZi5wYXRoWzE6aWR4XQogICAgICAgICAgcmVxUGFyYW1zID0gc2VsZi5fYnVpbGRSZXFQYXJhbU1hcChzZWxmLnBhdGhbaWR4KzE6XSkKICAgICAgICAgIGFjY2Vzc1Rva2VuID0gcmVxUGFyYW1zLmdldCgnYWNjZXNzVG9rZW4nKQogICAgICAgICAgbWVzc2FnZUlkID0gcmVxUGFyYW1zLmdldCgnbWVzc2FnZUlkJykKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgIHNlbGYuY29tbWFuZCA9IHNlbGYucGF0aFsxOl0KICAgICAgICBpZiBzZWxmLmNvbW1hbmQgPT0gJ2NvbmZpZyc6CiAgICAgICAgICBpZiBhY2Nlc3NUb2tlbiAhPSBzZWxmLnNlcnZlci5hY2Nlc3NUb2tlbjoKICAgICAgICAgICAgc2VsZi5zZW5kX2Vycm9yKDQwMSwgJ01pc3Npbmcgb3IgaW52YWxpZCBhY2Nlc3MgdG9rZW4nKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgIHNlbGYuX2NvbmZpZygpCiAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBtZXNzYWdlSWQgaXMgTm9uZToKICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZSgiIiwgIlVuZXhwZWN0ZWRJbmZvcm1hdGlvblJlY2VpdmVkRXJyb3IiKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgYWNjZXNzVG9rZW4gaXMgTm9uZToKICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZShtZXNzYWdlSWQsICJVbmV4cGVjdGVkSW5mb3JtYXRpb25SZWNlaXZlZEVycm9yIikKICAgICAgICAgIHJldHVybgogICAgICAgIGlmIGFjY2Vzc1Rva2VuICE9IHNlbGYuc2VydmVyLmFjY2Vzc1Rva2VuOgogICAgICAgICAgc2VsZi5fc2VuZEpzb25FcnJvclJlc3BvbnNlKG1lc3NhZ2VJZCwgIkludmFsaWRBY2Nlc3NUb2tlbkVycm9yIikKICAgICAgICAgIHJldHVybgogICAgICAgIGlmIHNlbGYuY29tbWFuZCA9PSAnY29udHJvbCc6CiAgICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlcXVlc3QgPSByZXFQYXJhbXNbJ3JlcXVlc3QnXQogICAgICAgICAgICBhcHBsaWFuY2VJZCA9IHJlcVBhcmFtc1snYXBwbGlhbmNlSWQnXQogICAgICAgICAgICB2YWx1ZSA9IHJlcVBhcmFtcy5nZXQoJ3ZhbHVlJywgTm9uZSkKICAgICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IpOgogICAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UobWVzc2FnZUlkLCAiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBzZWxmLnNlcnZlci5jb250cm9sKG1lc3NhZ2VJZCwgYXBwbGlhbmNlSWQsIHJlcXVlc3QsIHZhbHVlKQogICAgICAgICAgc2VsZi5fc2VuZEpzb25SZXNwb25zZShyZXNwb25zZU9iamVjdCkKICAgICAgICBlbGlmIHNlbGYuY29tbWFuZCA9PSAnZGlzY292ZXJ5JzoKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gc2VsZi5zZXJ2ZXIuZGlzY292ZXJ5KG1lc3NhZ2VJZCkKICAgICAgICAgIHNlbGYuX3NlbmRKc29uUmVzcG9uc2UocmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxzZToKICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZShtZXNzYWdlSWQsICJVbmV4cGVjdGVkSW5mb3JtYXRpb25SZWNlaXZlZEVycm9yIikKICAgICAgZGVmIF9jb25maWcoc2VsZik6CiAgICAgICAgbXNnID0gIiIKICAgICAgICBpZiBzZWxmLnBvc3R2YXJzIGlzIG5vdCBOb25lOgogICAgICAgICAgY29uZkxpc3QgPSBzZWxmLnBvc3R2YXJzLmdldCgnY29uZicsIE5vbmUpCiAgICAgICAgICBpZiBjb25mTGlzdCBpcyBub3QgTm9uZToKICAgICAgICAgICAgbXNnID0gc2VsZi5zZXJ2ZXIuc2F2ZUFwcGxpYW5jZXNDb25mKGNvbmZMaXN0WzBdLnN0cmlwKCkpCiAgICAgICAgc2VsZi5zZW5kX3Jlc3BvbnNlKDIwMCkKICAgICAgICBzZWxmLnNlbmRfaGVhZGVyKCdDb250ZW50LVR5cGUnLCAndGV4dC9odG1sOyBjaGFyc2V0PUlTTy04ODU5LTEnKQogICAgICAgIHNlbGYuZW5kX2hlYWRlcnMoKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjxodG1sPjxoZWFkPjxtZXRhIGNoYXJzZXQ9J0lTTy04ODU5LTEnPjwvaGVhZD48Ym9keT4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjxmb3JtIG1ldGhvZD0ncG9zdCcgZW5jdHlwZT0nYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyBhY2NlcHQtY2hhcnNldD0nSVNPLTg4NTktMSc+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8dGFibGUgc3R5bGU9J3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCUnPjx0cj48dGQ+PGgxPkFtYXpvbiBFY2hvIC0gQXBwbGlhbmNlczwvaDE+PC90ZD48L3RyPiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPHRyIHN0eWxlPSdoZWlnaHQ6OTklJz48dGQ+PHRleHRhcmVhIG5hbWU9J2NvbmYnIHN0eWxlPSd3aWR0aDoxMDAlO2hlaWdodDoxMDAlJz4iKQogICAgICAgIGlmIHNlbGYuc2VydmVyLmNvbmYgaXMgbm90IE5vbmU6CiAgICAgICAgICByZXNwID0ganNvbi5kdW1wcyhzZWxmLnNlcnZlci5jb25mLCBkZWZhdWx0PWFzRGljdCwgZW5jb2Rpbmc9Imlzbzg4NTktMSIpCiAgICAgICAgZWxzZToKICAgICAgICAgIHJlc3AgPSAiIgogICAgICAgIHNlbGYud2ZpbGUud3JpdGUocmVzcCkKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8L3RleHRhcmVhPjwvdGQ+PC90cj4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjx0cj48dGQ+PGlucHV0IHR5cGU9J3N1Ym1pdCcvPjwvdGQ+PC90cj4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjx0cj48dGQgc3R5bGU9J2NvbG9yOnJlZCc+IiArIG1zZyArICI8L3RkPjwvdHI+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8L2Zvcm0+PC9ib2R5PjwvaHRtbD4iKQogICAgICBkZWYgX3NlbmRKc29uRXJyb3JSZXNwb25zZShzZWxmLCBtZXNzYWdlSWQsIGVycm9yTWVzc2FnZSk6CiAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBOb25lCiAgICAgICAgaWYgc2VsZi5jb21tYW5kID09ICdjb250cm9sJzoKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gQW1hem9uRWNoby5Db250cm9sUmVzcG9uc2UobWVzc2FnZUlkKQogICAgICAgIGVsaWYgc2VsZi5jb21tYW5kID09ICdkaXNjb3ZlcnknOgogICAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBBbWF6b25FY2hvLkRpc2NvdmVyeVJlc3BvbnNlKG1lc3NhZ2VJZCkKICAgICAgICBlbHNlOgogICAgICAgICAgc2VsZi5zZW5kX2Vycm9yKDQwNCwgJ05vdCBGb3VuZCcpCiAgICAgICAgICByZXR1cm4KICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKGVycm9yTWVzc2FnZSkKICAgICAgICBzZWxmLl9zZW5kSnNvblJlc3BvbnNlKHJlc3BvbnNlT2JqZWN0KQogICAgICBkZWYgX3NlbmRKc29uUmVzcG9uc2Uoc2VsZiwgcmVzcG9uc2VPYmplY3QpOgogICAgICAgIHJlc3AgPSBqc29uLmR1bXBzKHJlc3BvbnNlT2JqZWN0LCBkZWZhdWx0PWFzRGljdCwgZW5jb2Rpbmc9Imlzbzg4NTktMSIpCiAgICAgICAgc2VsZi5zZW5kX3Jlc3BvbnNlKDIwMCkKICAgICAgICBzZWxmLnNlbmRfaGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcpCiAgICAgICAgc2VsZi5lbmRfaGVhZGVycygpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZShyZXNwKQogICAgICBkZWYgX2J1aWxkUmVxUGFyYW1NYXAoc2VsZiwgcXVlcnkpOgogICAgICAgIGltcG9ydCB1cmxsaWIKICAgICAgICByZXFfcGFyYW1zID0ge30KICAgICAgICBwYXJhbXMgPSBxdWVyeS5zcGxpdCgnJicpCiAgICAgICAgZm9yIHBhcmFtIGluIHBhcmFtczoKICAgICAgICAgIGlkeCA9IHBhcmFtLmZpbmQoJz0nKQogICAgICAgICAgcmVxX3BhcmFtc1twYXJhbVswOmlkeF1dID0gdXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbVtpZHggKyAxOl0pCiAgICAgICAgcmV0dXJuIHJlcV9wYXJhbXMKICAgIGRlZiBzdGFydChzZWxmKToKICAgICAgc2VsZi5sb2coIlN0YXJ0ICIsIHNldmVyaXR5PSJpbmZvIikKICAgICAgaWYgc2VsZi5zZXJ2ZXJUaHJlYWQgaXMgTm9uZToKICAgICAgICBIVFRQU2VydmVyLl9faW5pdF9fKHNlbGYsIChzZWxmLmlwLCBzZWxmLnBvcnQpLCBzZWxmLkhUVFBSZXF1ZXN0SGFuZGxlcikKICAgICAgICBpZiBzZWxmLmNlcnRUZXh0ICE9ICIiOgogICAgICAgICAgd2l0aCBvcGVuKHNlbGYuRklMRVBBVEhfQ0VSVCwgIndiIikgYXMgb3V0cHV0OgogICAgICAgICAgICBvdXRwdXQud3JpdGUoc2VsZi5jZXJ0VGV4dCkKICAgICAgICAgIGltcG9ydCBzc2wKICAgICAgICAgIHNlbGYuc29ja2V0ID0gc3NsLndyYXBfc29ja2V0KHNlbGYuc29ja2V0LCBjZXJ0ZmlsZT1zZWxmLkZJTEVQQVRIX0NFUlQsIHNlcnZlcl9zaWRlPVRydWUpCiAgICAgICAgZnJvbSBoc19xdWV1ZSBpbXBvcnQgaHNfdGhyZWFkaW5nIGFzIHRocmVhZGluZwogICAgICAgIHNlbGYuc2VydmVyVGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9c2VsZi5zZXJ2ZV9mb3JldmVyLCBuYW1lPSdhbWF6b25fZWNob19zZXJ2ZXInKQogICAgICAgIHNlbGYuc2VydmVyVGhyZWFkLmRhZW1vbiA9IFRydWUKICAgICAgICBzZWxmLnNlcnZlclRocmVhZC5zdGFydCgpCiAgICBkZWYgc3RvcChzZWxmKToKICAgICAgc2VsZi5sb2coIlN0b3AgIiwgc2V2ZXJpdHk9ImluZm8iKQogICAgICBpZiBub3Qgc2VsZi5zZXJ2ZXJUaHJlYWQgaXMgTm9uZToKICAgICAgICBIVFRQU2VydmVyLnNodXRkb3duKHNlbGYpCiAgICAgICAgc2VsZi5zb2NrZXQuY2xvc2UoKQogICAgICAgIHNlbGYuc2VydmVyVGhyZWFkID0gTm9uZQogICAgZGVmIGdldFNTTENlcnQoc2VsZiwgaXAsIGNlcnRGaWxlbmFtZSk6CiAgICAgIHRyeToKICAgICAgICBpbXBvcnQgdXJsbGliMgogICAgICAgIHVybCA9ICJodHRwOi8vezB9L29wdC97MX0iLmZvcm1hdChpcCwgY2VydEZpbGVuYW1lKQogICAgICAgIHJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwpCiAgICAgICAgcmVzID0gdXJsbGliMi51cmxvcGVuKHJlcSkKICAgICAgICBpZiByZXMuZ2V0Y29kZSgpID09IDIwMDoKICAgICAgICAgIHJldHVybiByZXMuZnAucmVhZCgpCiAgICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICAgIHJldHVybiAiIgogICAgZGVmIHdlYkNhbGxiYWNrU1NMQ2VydChzZWxmLCBzdHJlYW09RmFsc2UpOgogICAgICBodG1sID0gIjxodG1sPjxoZWFkPiIKICAgICAgaHRtbCArPSAiPG1ldGEgY2hhcnNldD0nSVNPLTg4NTktMScvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0nY2FjaGUtY29udHJvbCcgY29udGVudD0nbWF4LWFnZT0wJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdjYWNoZS1jb250cm9sJyBjb250ZW50PSduby1jYWNoZScvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0nZXhwaXJlcycgY29udGVudD0nMCcvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0nZXhwaXJlcycgY29udGVudD0nVHVlLCAwMSBKYW4gMTk4MCAxOjAwOjAwIEdNVCcvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0ncHJhZ21hJyBjb250ZW50PSduby1jYWNoZScvPiIKICAgICAgaHRtbCArPSAiPC9oZWFkPjxib2R5PiIKICAgICAgaHRtbCArPSAiPGgxPkFtYXpvbiBFY2hvIC0gU1NMIENlcnRpZmljYXRlPC9oMT4iCiAgICAgIGh0bWwgKz0gIjxwcmU+PGNvZGU+IgogICAgICBodG1sICs9IHNlbGYuY2VydFRleHQKICAgICAgaHRtbCArPSAiPC9wcmU+PC9jb2RlPiIKICAgICAgaHRtbCArPSAiPC9ib2R5PjwvaHRtbD4iCiAgICAgIGlmIHN0cmVhbToKICAgICAgICAgIHN0cmVhbS53cml0ZShodG1sKQogICAgICBzZWxmLkRhdExlbiA9IGxlbihodG1sKQogICAgZGVmIGluaXRfZGVidWdfZW50cnkoc2VsZik6CiAgICAgIHByb3RvID0gImh0dHAiCiAgICAgIGlmIHNlbGYuY2VydFRleHQgIT0gIiI6CiAgICAgICAgcHJvdG8gPSAiaHR0cHMiCiAgICAgIGltcG9ydCB1cmxsaWIKICAgICAgc2VsZi5NQy5EZWJ1Zy5hZGRHcnVwcGUoCiAgICAgICAgW3NlbGYuaWQsIHNlbGYuaWRdLAogICAgICAgICAgWyAKICAgICAgICAgICAgWyIwVkVSU0lPTklORk8iLCJWZXJzaW9uIiwxLCdWMC4xIC0gKDIwMTYtMTEtMjYgMDk6NTEpJ10sCiAgICAgICAgICAgIFsiMVBPUlQiLCJQb3J0IiwxLHN0cihzZWxmLnBvcnQpXSwKICAgICAgICAgICAgWyIyU1NMIiwiU1NMLUNlcnRpZmljYXRlIiwxLCI8YSBocmVmPScvb3B0L3swfSc+c2hvdzwvYT48YnI+Ii5mb3JtYXQoc2VsZi5VUkxfU0hPV19TU0wpXSwKICAgICAgICAgICAgWyIzQ09ORklHIiwiQXBwbGlhbmNlcyBjb25maWd1cmF0aW9uIiwxLCI8YSBocmVmPSd7MH06Ly97MX06ezJ9L2NvbmZpZz9hY2Nlc3NUb2tlbj17M30nPmVkaXQ8L2E+PGJyPiIuZm9ybWF0KHByb3RvLCBzZWxmLmlwLCBzZWxmLnBvcnQsIHVybGxpYi5xdW90ZV9wbHVzKHNlbGYuYWNjZXNzVG9rZW4pKV0sCiAgICAgICAgICBdICAgCiAgICAgICkKICAgIGRlZiBkZWJ1ZyhzZWxmLCBtc2csIGx2bD01KToKICAgICAgaW1wb3J0IHRpbWUKICAgICAgc2VsZi5sb2cobXNnLCBzZXZlcml0eT0nZGVidWcnKQogICAgICBwcmludCAiJXMgREVCVUc6ICVyIiAlICh0aW1lLnN0cmZ0aW1lKCIlSDolTTolUyIpLCBtc2csICkKICAgIGRlZiBsb2coc2VsZiwgbXNnLCBzZXZlcml0eT0naW5mbycpOgogICAgICBpbXBvcnQgdGltZQogICAgICBmcm9tIGhhc2hsaWIgaW1wb3J0IG1kNQogICAgICBfbXNnX3VpZCA9IG1kNSggIiVzJXMiICUgKCBzZWxmLmlkLCB0aW1lLnRpbWUoKSApICkuaGV4ZGlnZXN0KCkKICAgICAgX21zZyA9ICc8bG9nPjxpZD4lczwvaWQ+PGZhY2lsaXR5PkFtYXpvbl9FY2hvX1NlcnZlcjwvZmFjaWxpdHk+PHNldmVyaXR5PiVzPC9zZXZlcml0eT48bWVzc2FnZT4lczwvbWVzc2FnZT48L2xvZz4nICUgKF9tc2dfdWlkLCBzZXZlcml0eSwgbXNnKQogICAgICBzZWxmLnNlbmRUb091dHB1dCgxLF9tc2cpCiAgICBkZWYgc2VuZFRvT3V0cHV0KHNlbGYsIG91dCwgbXNnKToKICAgICAgb3V0IC09IDEKICAgICAgc2VsZi5sb2NhbHNbIkFOIl1bb3V0XSA9IG1zZwogICAgICBzZWxmLmxvY2Fsc1siQUMiXVtvdXRdID0gMSAgCg=='),'<10013_Amazon Echo (10013)>','exec'))"|""|0|0|0|0
## MD5 der Formelzeile: 78a8db8b6ceab929a8f45575239581ec
### Klasse AmazonEcho
################################
## Quelltext nicht Öffentlich ##
################################




## Klasse auf SN1 
5012|1|"EI"|"1"|"10"|0|1|0|0
5012|0|"OC[1]"|"AmazonEcho(locals())"|""|0|0|1|0

#5012|abbruch bei bed. (0/1)|bedingung|formel|zeit|pin-ausgang|pin-offset|pin-speicher|pin-neg.ausgang
5012|0|"(OC[1] or EC[1]) and EN[1]"|"SN[1].start()"|""|0|0|0|0
5012|0|"EC[1] and not EN[1]"|"SN[1].stop()"|""|0|0|0|0



