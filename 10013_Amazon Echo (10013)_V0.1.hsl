# -*- coding: iso8859-1 -*-
## -----------------------------------------------------
## Amazon Echo (10013)   ### V0.1
##
## erstellt am: 2016-11-25 18:04
## -----------------------------------------------------
## Copyright © 2016, Werner Lindbüchl, All rights reserved.
##
## This program is free software; you can redistribute it and/or modify it under the terms
## of the GNU General Public License as published by the Free Software Foundation; either
## version 3 of the License, or (at your option) any later version.
##
## This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
## without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
## See the GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License along with this program;
## if not, see <http://www.gnu.de/documents/gpl-3.0.de.html>.

## -- 
## --  

#5000|"Text"|Remanent(1/0)|Anz.Eingänge|.n.|Anzahl Ausgänge|.n.|.n.
5000|"#WJL\Amazon Echo (10013)_V0.1"|0|3|"E1 Https-Server Start/Stop"|"E2 Https-Server Port"|"E3 Access Token"|1|"A1 Systemlog"|"V0.1"

#5001|Anzahl Eingänge|Ausgänge|Offset|Speicher|Berechnung bei Start
5001|3|1|1|1|1

# Eingaenge
#5002|Index Eingang|Default Wert|0=numerisch 1=alphanummerisch
5002|1|0|0	#* E1 Https-Server Start/Stop 
5002|2|0|0	#* E2 Https-Server Port 
5002|3|0|1	#* E3 Access Token 

# Speicher
#5003|Speicher|Initwert|Remanent
5003|1||0		  #* Klassenspeicher 

# Ausgaenge
#5004|ausgang|Initwert|runden binär (0/1)|typ (1-send/2-sbc)|0=numerisch 1=alphanummerisch
5004|1|""|0|1|1 

#################################################

5012|0|"OC[1]"|"eval(compile(__import__('base64').decodestring('CmlmIE9DWzFdPT0xOgogIGdsb2JhbCBhc0RpY3QKICBkZWYgYXNEaWN0KG8pOgogICAgICByZXR1cm4gby5fX2RpY3RfXwogIGdsb2JhbCBIVFRQU2VydmVyCiAgZ2xvYmFsIEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBmcm9tIEJhc2VIVFRQU2VydmVyIGltcG9ydCBIVFRQU2VydmVyLEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBnbG9iYWwgVGhyZWFkaW5nTWl4SW4KICBmcm9tIFNvY2tldFNlcnZlciBpbXBvcnQgVGhyZWFkaW5nTWl4SW4KICBnbG9iYWwgQW1hem9uRWNob1dlYkNhbGxiYWNrCiAgY2xhc3MgQW1hem9uRWNob1dlYkNhbGxiYWNrKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcEl0ZW0sIGNhbGxiYWNrLCBuYW1lLCB0eXBlPSd0ZXh0L2h0bWwnKToKICAgICAgc2VsZi5sb2dpayA9IHBJdGVtCiAgICAgIHNlbGYuY2FsbGJhY2sgPSBjYWxsYmFjawogICAgICBzZWxmLk1DID0gcEl0ZW0uTUMKICAgICAgc2VsZi5VcmxQZmFkID0gbmFtZS51cHBlcigpCiAgICAgIHNlbGYuRGF0TmFtZSA9ICJPUFQvJXMiICUgKHNlbGYuVXJsUGZhZCkKICAgICAgc2VsZi5EYXRMZW4gPSAwCiAgICAgIHNlbGYuVHlwID0gdHlwZQogICAgICBzZWxmLmlzUXVhZCA9IDAKICAgICAgc2VsZi5NQy5HVUkuRXh0RGF0VXJsW3NlbGYuVXJsUGZhZF0gPSBzZWxmCiAgICBkZWYgZ2V0RGF0ZW4oc2VsZik6CiAgICAgIHJldHVybgogICAgZGVmIGdldFF1YWREYXRlbihzZWxmKToKICAgICAgcmV0dXJuIAogICAgZGVmIGdldERhdGVuU3RyZWFtKHNlbGYsIHN0cmVhbSk6CiAgICAgIHNlbGYuRGF0TGVuID0gc2VsZi5jYWxsYmFjayhzdHJlYW0pCiAgICBkZWYgZ2V0UXVhZERhdGVuU3RyZWFtKHNlbGYsIHN0cmVhbSk6CiAgICAgIHNlbGYuZ2V0RGF0ZW5TdHJlYW0oc3RyZWFtKQogIGdsb2JhbCBBbWF6b25FY2hvCiAgY2xhc3MgQW1hem9uRWNobyhUaHJlYWRpbmdNaXhJbiwgSFRUUFNlcnZlcik6CiAgICBQQVRIX0JBU0UgPSAiL3RtcC8iCiAgICBGSUxFTkFNRV9DRVJUID0gImFtYXpvbkVjaG9TU0wuY2VydCIKICAgIEZJTEVQQVRIX0NFUlQgPSBQQVRIX0JBU0UgKyBGSUxFTkFNRV9DRVJUCiAgICBGSUxFTkFNRV9BUFBMSUFOQ0VTID0gImFtYXpvbkVjaG9BcHBsaWFuY2VzLmpzIgogICAgRklMRVBBVEhfQVBQTElBTkNFUyA9IFBBVEhfQkFTRSArIEZJTEVOQU1FX0FQUExJQU5DRVMKICAgIFVSTF9CQVNFID0gImFtYXpvbkVjaG8vIgogICAgVVJMX1NIT1dfU1NMID0gVVJMX0JBU0UgKyAic3NsQ2VydC5odG0iCiAgICBhbGxvd19yZXVzZV9hZGRyZXNzID0gVHJ1ZQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGxvY2Fscyk6CiAgICAgIHNlbGYubG9jYWxzID0gbG9jYWxzOwogICAgICBzZWxmLmxvZ2lrID0gbG9jYWxzWydwSXRlbSddCiAgICAgIHNlbGYuTUMgPSBzZWxmLmxvZ2lrLk1DCiAgICAgIHNlbGYuaXAgPSBzZWxmLk1DLkV0aGVybmV0LklQQWRyCiAgICAgIEVOID0gbG9jYWxzWydFTiddCiAgICAgIHNlbGYucG9ydCA9IGludChFTlsyXSkKICAgICAgc2VsZi5hY2Nlc3NUb2tlbiA9IEVOWzNdCiAgICAgIHNlbGYuaWQgPSAnQW1hem9uX0VjaG9fU2VydmVyJwogICAgICBzZWxmLnNlcnZlclRocmVhZCA9IE5vbmUKICAgICAgc2VsZi5jZXJ0VGV4dCA9IHNlbGYuZ2V0U1NMQ2VydChzZWxmLmlwLCBzZWxmLkZJTEVOQU1FX0NFUlQpCiAgICAgIHNlbGYuaW5pdEFwcGxpYW5jZXMoKQogICAgICBBbWF6b25FY2hvV2ViQ2FsbGJhY2soc2VsZi5sb2dpaywgc2VsZi53ZWJDYWxsYmFja1NTTENlcnQsIHNlbGYuVVJMX1NIT1dfU1NMKQogICAgICBzZWxmLmluaXRfZGVidWdfZW50cnkoKTsKICAgIGRlZiBpbml0QXBwbGlhbmNlcyhzZWxmKToKICAgICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihzZWxmLkZJTEVQQVRIX0FQUExJQU5DRVMsICdyJykgYXMgbXlmaWxlOgogICAgICAgICAgZGF0YT1teWZpbGUucmVhZCgpCiAgICAgICAgaW1wb3J0IGpzb24KICAgICAgICBzZWxmLmNvbmYgPSBqc29uLmxvYWRzKGRhdGEsIGVuY29kaW5nPSJpc284ODU5LTEiKQogICAgICBleGNlcHQ6CiAgICAgICAgc2VsZi5jb25mID0gIiIKICAgICAgc2VsZi5hcHBsaWFuY2VzID0gW10KICAgICAgaWYgc2VsZi5jb25mID09ICIiOgogICAgICAgIHNlbGYuZGlzY292ZXJBcHBsaWFuY2VzKCkKICAgIGRlZiBkaXNjb3ZlckFwcGxpYW5jZXMoc2VsZik6CiAgICAgIGltcG9ydCByZQogICAgICByZWdleCA9IHJlLmNvbXBpbGUoIiguKilcW1xzKihTd2l0Y2hhYmxlfExpZ2h0aW5nKVxzKlxdXHMqJCIpCiAgICAgIGZvciBpa28gaW4gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3Q6IAogICAgICAgIGtvID0gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3RbaWtvXQogICAgICAgIG1hdGNoID0gcmVnZXguc2VhcmNoKGtvLlJQQ1RleHQpCiAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICBhcHBsaWFuY2UgPSBBbWF6b25FY2hvLktOWEFwcGxpYW5jZShrbywgbWF0Y2guZ3JvdXBzKClbMF0uc3RyaXAoKSwgbWF0Y2guZ3JvdXBzKClbMV0pCiAgICAgICAgICBzZWxmLmFwcGxpYW5jZXMuYXBwZW5kKGFwcGxpYW5jZSkKICAgIGNsYXNzIEtOWEFwcGxpYW5jZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwga28sIGZyaWVuZGx5TmFtZSwgdHlwZSk6CiAgICAgICAgc2VsZi5rbyA9IGtvCiAgICAgICAgc2VsZi5mcmllbmRseU5hbWUgPSBmcmllbmRseU5hbWUKICAgICAgICBzZWxmLnR5cGUgPSB0eXBlCiAgICBkZWYgZGlzY292ZXJ5KHNlbGYsIG1lc3NhZ2VJZCk6CiAgICAgIHJlc3BvbnNlT2JqZWN0ID0gQW1hem9uRWNoby5EaXNjb3ZlcnlSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgIGlmIHNlbGYuY29uZiAhPSAiIjoKICAgICAgICBpZCA9IDAKICAgICAgICBmb3IgZGV2aWNlIGluIHNlbGYuY29uZjoKICAgICAgICAgIHJvb20gPSBkZXZpY2UuZ2V0KCdyb29tJykKICAgICAgICAgIGlkICs9IDEKICAgICAgICAgIGlkU3RyID0gc3RyKGlkKQogICAgICAgICAgamQgPSAwCiAgICAgICAgICBmb3IgYXBwbGlhbmNlIGluIGRldmljZS5nZXQoJ2FwcGxpYW5jZXMnKToKICAgICAgICAgICAgamQgKz0gMQogICAgICAgICAgICB0eXBlID0gJ1N3aXRjaGFibGUnCiAgICAgICAgICAgIHBlcmNlbnQgPSBhcHBsaWFuY2UuZ2V0KCdwZXJjZW50Jyk7CiAgICAgICAgICAgIGlmIHBlcmNlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgdHlwZSA9ICdMaWdodGluZycKICAgICAgICAgICAgaWYgcm9vbSBpcyBub3QgTm9uZSBhbmQgcm9vbSAhPSAiIjoKICAgICAgICAgICAgICBpZiBqZCA9PSAxOgogICAgICAgICAgICAgICAgZGlzY292ZXJ5QXBwbGlhbmNlID0gQW1hem9uRWNoby5EaXNjb3ZlcnlBcHBsaWFuY2UoaWRTdHIsIHJvb20sIHR5cGUpCiAgICAgICAgICAgICAgICByZXNwb25zZU9iamVjdC5hZGRBcHBsaWFuY2UoZGlzY292ZXJ5QXBwbGlhbmNlKQogICAgICAgICAgICAgIG5hbWUgPSBhcHBsaWFuY2UuZ2V0KCduYW1lJykKICAgICAgICAgICAgICBpZiBuYW1lIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBuYW1lID0gcm9vbQogICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBuYW1lID0gcm9vbSArICIgIiArIG5hbWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICBuYW1lID0gYXBwbGlhbmNlLmdldCgnbmFtZScpCiAgICAgICAgICAgICAgaWYgbmFtZSBpcyBOb25lOgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZGlzY292ZXJ5QXBwbGlhbmNlID0gQW1hem9uRWNoby5EaXNjb3ZlcnlBcHBsaWFuY2UoaWRTdHIgKyAiXyIgKyBzdHIoamQpLCBuYW1lLCB0eXBlKQogICAgICAgICAgICByZXNwb25zZU9iamVjdC5hZGRBcHBsaWFuY2UoZGlzY292ZXJ5QXBwbGlhbmNlKQogICAgICAgICAgICBhbGlhc2VzID0gYXBwbGlhbmNlLmdldCgnYWxpYXNlcycpOwogICAgICAgICAgICBpZiBhbGlhc2VzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgIGZvciBhbGlhcyBpbiBhbGlhc2VzOgogICAgICAgICAgICAgICAgamQgKz0gMQogICAgICAgICAgICAgICAgZGlzY292ZXJ5QXBwbGlhbmNlID0gQW1hem9uRWNoby5EaXNjb3ZlcnlBcHBsaWFuY2UoaWRTdHIgKyAiXyIgKyBzdHIoamQpLCBhbGlhcywgdHlwZSkKICAgICAgICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgIGVsc2U6CiAgICAgICAgZm9yIGFwcGxpYW5jZSBpbiBzZWxmLmFwcGxpYW5jZXM6CiAgICAgICAgICBrbyA9IGFwcGxpYW5jZS5rbwogICAgICAgICAgZGlzY292ZXJ5QXBwbGlhbmNlID0gQW1hem9uRWNoby5EaXNjb3ZlcnlBcHBsaWFuY2Uoc3RyKGtvLklEKSwgYXBwbGlhbmNlLmZyaWVuZGx5TmFtZSwgYXBwbGlhbmNlLnR5cGUpCiAgICAgICAgICByZXNwb25zZU9iamVjdC5hZGRBcHBsaWFuY2UoZGlzY292ZXJ5QXBwbGlhbmNlKQogICAgICByZXR1cm4gcmVzcG9uc2VPYmplY3QKICAgIGRlZiBjb250cm9sKHNlbGYsIG1lc3NhZ2VJZCwgYXBwbGlhbmNlSWQsIHJlcXVlc3QsIHZhbHVlKToKICAgICAgcmVzcG9uc2VPYmplY3QgPSBBbWF6b25FY2hvLkNvbnRyb2xSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoIlVuc3VwcG9ydGVkT3BlcmF0aW9uRXJyb3IiKQogICAgICBhcHBsaWFuY2UgPSBzZWxmLmZpbmRBcHBsaWFuY2UoYXBwbGlhbmNlSWQpCiAgICAgIGlmIGFwcGxpYW5jZSBpcyBub3QgTm9uZToKICAgICAgICBvblZhbHVlID0gMS4wCiAgICAgICAgb2ZmVmFsdWUgPSAwLjAKICAgICAgICBpZiB0eXBlKGFwcGxpYW5jZSkgaXMgbm90IEFtYXpvbkVjaG8uS05YQXBwbGlhbmNlOgogICAgICAgICAgb25PZmZLbyA9IHNlbGYuZmluZEtvKGFwcGxpYW5jZVsnb25PZmYnXSkKICAgICAgICAgIGlmIG9uT2ZmS28gaXMgTm9uZToKICAgICAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiTm9TdWNoVGFyZ2V0RXJyb3IiKQogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2VPYmplY3QKICAgICAgICAgIHBlcmNlbnQgPSBhcHBsaWFuY2UuZ2V0KCdwZXJjZW50Jyk7CiAgICAgICAgICBpZiBwZXJjZW50IGlzIG5vdCBOb25lOgogICAgICAgICAgICBhcHBsaWFuY2VUeXBlID0gIkxpZ2h0aW5nIgogICAgICAgICAgICBwZXJjZW50S28gPSBzZWxmLmZpbmRLbyhhcHBsaWFuY2VbJ3BlcmNlbnQnXSkKICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgIGFwcGxpYW5jZVR5cGUgPSAiU3dpdGNoYWJsZSIKICAgICAgICAgIGFwcGxpYW5jZVZhbHVlID0gYXBwbGlhbmNlLmdldCgndmFsdWUnKQogICAgICAgICAgaWYgYXBwbGlhbmNlVmFsdWUgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIG9uVmFsdWUgPSBhcHBsaWFuY2VWYWx1ZQogICAgICAgIGVsc2U6CiAgICAgICAgICBhcHBsaWFuY2VUeXBlID0gYXBwbGlhbmNlLnR5cGUKICAgICAgICAgIG9uT2ZmS28gPSBwZXJjZW50S28gPSBhcHBsaWFuY2Uua28KICAgICAgICAgIGlmIGFwcGxpYW5jZVR5cGUgPT0gIkxpZ2h0aW5nIjoKICAgICAgICAgICAgb25WYWx1ZSA9IDEwMC4wCiAgICAgICAgaWYgYXBwbGlhbmNlVHlwZSA9PSAiTGlnaHRpbmciOgogICAgICAgICAgaWYgcmVxdWVzdCA9PSAnVHVybk9uUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKG9uT2ZmS28sIG9uVmFsdWUsICJUdXJuT25Db25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnVHVybk9mZlJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShvbk9mZktvLCBvZmZWYWx1ZSwgIlR1cm5PZmZDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnU2V0UGVyY2VudGFnZVJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRQZXJjZW50KHBlcmNlbnRLbywgdmFsdWUsICJTZXRQZXJjZW50YWdlQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgICBlbGlmIHJlcXVlc3QgPT0gJ0luY3JlbWVudFBlcmNlbnRhZ2VSZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YQWRkUGVyY2VudChwZXJjZW50S28sIHZhbHVlLCAxLCAiSW5jcmVtZW50UGVyY2VudGFnZUNvbmZpcm1hdGlvbiIsIHJlc3BvbnNlT2JqZWN0KQogICAgICAgICAgZWxpZiByZXF1ZXN0ID09ICdEZWNyZW1lbnRQZXJjZW50YWdlUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWEFkZFBlcmNlbnQocGVyY2VudEtvLCB2YWx1ZSwgLTEsICJEZWNyZW1lbnRQZXJjZW50YWdlQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxpZiBhcHBsaWFuY2VUeXBlID09ICJTd2l0Y2hhYmxlIjoKICAgICAgICAgIGlmIHJlcXVlc3QgPT0gJ1R1cm5PblJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShvbk9mZktvLCBvblZhbHVlLCAiVHVybk9uQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgICBlbGlmIHJlcXVlc3QgPT0gJ1R1cm5PZmZSZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YU2V0VmFsdWUob25PZmZLbywgb2ZmVmFsdWUsICJUdXJuT2ZmQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxzZToKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoIlVuZXhwZWN0ZWRJbmZvcm1hdGlvblJlY2VpdmVkRXJyb3IiKQogICAgICBlbHNlOgogICAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoIk5vU3VjaFRhcmdldEVycm9yIikKICAgICAgcmV0dXJuIHJlc3BvbnNlT2JqZWN0CiAgICBkZWYgX0tOWEFkZFBlcmNlbnQoc2VsZiwga28sIHZhbHVlLCBzaWduLCBuYW1lLCByZXNwb25zZU9iamVjdCk6CiAgICAgIHRyeToKICAgICAgICBmdmFsdWUgPSBrby5nZXRXZXJ0KCkgKyAoc2lnbiAqIGZsb2F0KHZhbHVlKSkKICAgICAgICBpZiBmdmFsdWUgPCAwLjA6CiAgICAgICAgICBmdmFsdWUgPSAwLjAKICAgICAgICBlbGlmIGZ2YWx1ZSA+IDEwMC4wOgogICAgICAgICAgZnZhbHVlID0gMTAwLjAKICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShrbywgZnZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCkKICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5zdXBwb3J0ZWRUYXJnZXRTZXR0aW5nRXJyb3IiKQogICAgZGVmIF9LTlhTZXRQZXJjZW50KHNlbGYsIGtvLCB2YWx1ZSwgbmFtZSwgcmVzcG9uc2VPYmplY3QpOgogICAgICB0cnk6CiAgICAgICAgZnZhbHVlID0gZmxvYXQodmFsdWUpCiAgICAgICAgaWYgZnZhbHVlID49IDAuMCBhbmQgZnZhbHVlIDw9IDEwMC4wOgogICAgICAgICAgc2VsZi5fS05YU2V0VmFsdWUoa28sIGZ2YWx1ZSwgbmFtZSwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxzZToKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUoIlZhbHVlT3V0T2ZSYW5nZUVycm9yIikKICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5zdXBwb3J0ZWRUYXJnZXRTZXR0aW5nRXJyb3IiKQogICAgZGVmIF9LTlhTZXRWYWx1ZShzZWxmLCBrbywgZnZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCk6CiAgICAgIHNlbGYubG9naWsuTUMuVGFnTGlzdC5zZXRXZXJ0KEZMQUdfRUlCX0xPR0lLLCBrbywgZnZhbHVlKQogICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKG5hbWUpCiAgICBkZWYgZmluZEFwcGxpYW5jZShzZWxmLCBhcHBsaWFuY2VJZCk6CiAgICAgIGlmIHNlbGYuY29uZiAhPSAiIjoKICAgICAgICBpZCA9IDAKICAgICAgICBmb3IgZGV2aWNlIGluIHNlbGYuY29uZjoKICAgICAgICAgIHJvb20gPSBkZXZpY2UuZ2V0KCdyb29tJykKICAgICAgICAgIGlkICs9IDEKICAgICAgICAgIGlkU3RyID0gc3RyKGlkKQogICAgICAgICAgaWYgYXBwbGlhbmNlSWQgPT0gaWRTdHI6CiAgICAgICAgICAgIHJldHVybiBkZXZpY2VbJ2FwcGxpYW5jZXMnXVswXQogICAgICAgICAgamQgPSAwCiAgICAgICAgICBmb3IgYXBwbGlhbmNlIGluIGRldmljZVsnYXBwbGlhbmNlcyddOgogICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgIGlmIGFwcGxpYW5jZUlkID09IGlkU3RyICsgIl8iICsgc3RyKGpkKToKICAgICAgICAgICAgICByZXR1cm4gYXBwbGlhbmNlCiAgICAgICAgICAgIGFsaWFzZXMgPSBhcHBsaWFuY2UuZ2V0KCdhbGlhc2VzJyk7CiAgICAgICAgICAgIGlmIGFsaWFzZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgZm9yIGFsaWFzIGluIGFsaWFzZXM6CiAgICAgICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgICAgICBpZiBhcHBsaWFuY2VJZCA9PSBpZFN0ciArICJfIiArIHN0cihqZCk6CiAgICAgICAgICAgICAgICAgIHJldHVybiBhcHBsaWFuY2UKICAgICAgZWxzZToKICAgICAgICBmb3IgYXBwbGlhbmNlIGluIHNlbGYuYXBwbGlhbmNlczoKICAgICAgICAgIGtvID0gYXBwbGlhbmNlLmtvCiAgICAgICAgICBpZiBzdHIoa28uSUQpID09IGFwcGxpYW5jZUlkOgogICAgICAgICAgICByZXR1cm4gYXBwbGlhbmNlCiAgICAgIHJldHVybiBOb25lCiAgICBkZWYgZmluZEtvKHNlbGYsIGdycEFkclN0cik6CiAgICAgIGZvciBpa28gaW4gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3Q6IAogICAgICAgIGtvID0gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3RbaWtvXQogICAgICAgIGlmIGtvLkdycEFkclN0ciA9PSBncnBBZHJTdHI6CiAgICAgICAgICByZXR1cm4ga28KICAgICAgcmV0dXJuIE5vbmU7CiAgICBjbGFzcyBIZWFkZXIoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIG1lc3NhZ2VJZCwgbmFtZSwgbmFtZXNwYWNlLCBwYXlsb2FkVmVyc2lvbik6CiAgICAgICAgc2VsZi5tZXNzYWdlSWQgPSBtZXNzYWdlSWQKICAgICAgICBzZWxmLm5hbWUgPSBuYW1lCiAgICAgICAgc2VsZi5uYW1lc3BhY2UgPSBuYW1lc3BhY2UKICAgICAgICBzZWxmLnBheWxvYWRWZXJzaW9uID0gcGF5bG9hZFZlcnNpb24KICAgIGNsYXNzIENvbnRyb2xSZXNwb25zZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwgbWVzc2FnZUlkKToKICAgICAgICBzZWxmLmhlYWRlciA9IEFtYXpvbkVjaG8uSGVhZGVyKG1lc3NhZ2VJZCwgIiIsICJBbGV4YS5Db25uZWN0ZWRIb21lLkNvbnRyb2wiLCAiMiIpCiAgICAgICAgc2VsZi5wYXlsb2FkID0ge30KICAgICAgZGVmIHNldE5hbWUoc2VsZiwgbmFtZSk6CiAgICAgICAgc2VsZi5oZWFkZXIubmFtZSA9IG5hbWUKICAgIGNsYXNzIERpc2NvdmVyeVJlc3BvbnNlKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtZXNzYWdlSWQpOgogICAgICAgIHNlbGYuaGVhZGVyID0gQW1hem9uRWNoby5IZWFkZXIobWVzc2FnZUlkLCAiRGlzY292ZXJBcHBsaWFuY2VzUmVzcG9uc2UiLCAiQWxleGEuQ29ubmVjdGVkSG9tZS5EaXNjb3ZlcnkiLCAiMiIpCiAgICAgICAgc2VsZi5wYXlsb2FkID0gQW1hem9uRWNoby5EaXNjb3ZlcnlQYXlsb2FkKCkKICAgICAgZGVmIHNldE5hbWUoc2VsZiwgbmFtZSk6CiAgICAgICAgc2VsZi5oZWFkZXIubmFtZSA9IG5hbWUKICAgICAgZGVmIGFkZEFwcGxpYW5jZShzZWxmLCBhcHBsaWFuY2UpOgogICAgICAgIHNlbGYucGF5bG9hZC5kaXNjb3ZlcmVkQXBwbGlhbmNlcy5hcHBlbmQoYXBwbGlhbmNlKQogICAgY2xhc3MgRGlzY292ZXJ5UGF5bG9hZCgpOgogICAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi5kaXNjb3ZlcmVkQXBwbGlhbmNlcyA9IFtdCiAgICBjbGFzcyBEaXNjb3ZlcnlBcHBsaWFuY2UoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIGFwcGxpYW5jZUlkLCBmcmllbmRseU5hbWUsIGFwcGxpYW5jZVR5cGUpOgogICAgICAgIHNlbGYuYXBwbGlhbmNlSWQgPSBhcHBsaWFuY2VJZAogICAgICAgIHNlbGYuZnJpZW5kbHlEZXNjcmlwdGlvbiA9IGZyaWVuZGx5TmFtZQogICAgICAgIHNlbGYuZnJpZW5kbHlOYW1lID0gZnJpZW5kbHlOYW1lCiAgICAgICAgc2VsZi5pc1JlYWNoYWJsZSA9IFRydWUKICAgICAgICBzZWxmLm1hbnVmYWN0dXJlck5hbWUgPSAibi5hLiIKICAgICAgICBzZWxmLm1vZGVsTmFtZSA9ICJuLmEuIgogICAgICAgIHNlbGYudmVyc2lvbiA9ICIxLjAiCiAgICAgICAgaWYgYXBwbGlhbmNlVHlwZSA9PSAiU3dpdGNoYWJsZSI6CiAgICAgICAgICBzZWxmLmFjdGlvbnMgPSBbInR1cm5PbiIsICJ0dXJuT2ZmIl0KICAgICAgICBlbGlmIGFwcGxpYW5jZVR5cGUgPT0gIkxpZ2h0aW5nIjoKICAgICAgICAgIHNlbGYuYWN0aW9ucyA9IFsidHVybk9uIiwgInR1cm5PZmYiLCAiaW5jcmVtZW50UGVyY2VudGFnZSIsICJkZWNyZW1lbnRQZXJjZW50YWdlIiwgInNldFBlcmNlbnRhZ2UiXQogICAgICAgIGVsaWYgYXBwbGljYW5jZVR5cGUgPT0gIlRoZXJtb3N0YXQiOgogICAgICAgICAgc2VsZi5hY3Rpb25zID0gWyJpbmNyZW1lbnRUYXJnZXRUZW1wZXJhdHVyZSIsICJkZWNyZW1lbnRUYXJnZXRUZW1wZXJhdHVyZSIsICJzZXRUYXJnZXRUZW1wZXJhdHVyZSJdCiAgICBjbGFzcyBIVFRQUmVxdWVzdEhhbmRsZXIoQmFzZUhUVFBSZXF1ZXN0SGFuZGxlcik6CiAgICAgIGRlZiBhZGRyZXNzX3N0cmluZyhzZWxmKToKICAgICAgICAgIGhvc3QsIHBvcnQgPSBzZWxmLmNsaWVudF9hZGRyZXNzWzoyXQogICAgICAgICAgcmV0dXJuIGhvc3QKICAgICAgZGVmIGxvZ19yZXF1ZXN0KHNlbGYsIGNvZGU9Tm9uZSwgc2l6ZT1Ob25lKToKICAgICAgICBwYXNzCiAgICAgIGRlZiBsb2dfbWVzc2FnZShzZWxmLCBmb3JtYXQsICphcmdzKToKICAgICAgICBwYXNzCiAgICAgIGRlZiBkb19QT1NUKHNlbGYpOgogICAgICAgIHNlbGYucG9zdHZhcnMgPSBzZWxmLnBhcnNlX1BPU1QoKQogICAgICAgIHNlbGYuZG9fUkVRKCkKICAgICAgZGVmIHBhcnNlX1BPU1Qoc2VsZik6CiAgICAgICAgZnJvbSBjZ2kgaW1wb3J0IHBhcnNlX2hlYWRlciwgcGFyc2VfbXVsdGlwYXJ0CiAgICAgICAgZnJvbSB1cmxwYXJzZSBpbXBvcnQgcGFyc2VfcXMKICAgICAgICBjdHlwZSwgcGRpY3QgPSBwYXJzZV9oZWFkZXIoc2VsZi5oZWFkZXJzWydjb250ZW50LXR5cGUnXSkKICAgICAgICBpZiBjdHlwZSA9PSAnbXVsdGlwYXJ0L2Zvcm0tZGF0YSc6CiAgICAgICAgICAgIHBvc3R2YXJzID0gcGFyc2VfbXVsdGlwYXJ0KHNlbGYucmZpbGUsIHBkaWN0KQogICAgICAgIGVsaWYgY3R5cGUgPT0gJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCc6CiAgICAgICAgICAgIGxlbmd0aCA9IGludChzZWxmLmhlYWRlcnNbJ2NvbnRlbnQtbGVuZ3RoJ10pCiAgICAgICAgICAgIHBvc3R2YXJzID0gcGFyc2VfcXMoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5yZmlsZS5yZWFkKGxlbmd0aCksIAogICAgICAgICAgICAgICAgICAgIGtlZXBfYmxhbmtfdmFsdWVzPTEpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcG9zdHZhcnMgPSB7fQogICAgICAgIHJldHVybiBwb3N0dmFycwogICAgICBkZWYgZG9fR0VUKHNlbGYpOgogICAgICAgIHNlbGYucG9zdHZhcnMgPSBOb25lCiAgICAgICAgc2VsZi5kb19SRVEoKQogICAgICBkZWYgZG9fUkVRKHNlbGYpOgogICAgICAgIGFjY2Vzc1Rva2VuID0gTm9uZQogICAgICAgIG1lc3NhZ2VJZCA9IE5vbmUKICAgICAgICB0cnk6CiAgICAgICAgICBpZHggPSBzZWxmLnBhdGguaW5kZXgoIj8iKQogICAgICAgICAgc2VsZi5jb21tYW5kID0gc2VsZi5wYXRoWzE6aWR4XQogICAgICAgICAgcmVxUGFyYW1zID0gc2VsZi5fYnVpbGRSZXFQYXJhbU1hcChzZWxmLnBhdGhbaWR4KzE6XSkKICAgICAgICAgIGFjY2Vzc1Rva2VuID0gcmVxUGFyYW1zLmdldCgnYWNjZXNzVG9rZW4nKQogICAgICAgICAgbWVzc2FnZUlkID0gcmVxUGFyYW1zLmdldCgnbWVzc2FnZUlkJykKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgIHNlbGYuY29tbWFuZCA9IHNlbGYucGF0aFsxOl0KICAgICAgICBpZiBzZWxmLmNvbW1hbmQgPT0gJ2NvbmZpZyc6CiAgICAgICAgICBpZiBhY2Nlc3NUb2tlbiAhPSBzZWxmLnNlcnZlci5hY2Nlc3NUb2tlbjoKICAgICAgICAgICAgc2VsZi5zZW5kX2Vycm9yKDQwMSwgJ01pc3Npbmcgb3IgaW52YWxpZCBhY2Nlc3MgdG9rZW4nKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgIHNlbGYuX2NvbmZpZygpCiAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBtZXNzYWdlSWQgaXMgTm9uZToKICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZSgiIiwgIlVuZXhwZWN0ZWRJbmZvcm1hdGlvblJlY2VpdmVkRXJyb3IiKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgYWNjZXNzVG9rZW4gaXMgTm9uZToKICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZShtZXNzYWdlSWQsICJVbmV4cGVjdGVkSW5mb3JtYXRpb25SZWNlaXZlZEVycm9yIikKICAgICAgICAgIHJldHVybgogICAgICAgIGlmIGFjY2Vzc1Rva2VuICE9IHNlbGYuc2VydmVyLmFjY2Vzc1Rva2VuOgogICAgICAgICAgc2VsZi5fc2VuZEpzb25FcnJvclJlc3BvbnNlKG1lc3NhZ2VJZCwgIkludmFsaWRBY2Nlc3NUb2tlbkVycm9yIikKICAgICAgICAgIHJldHVybgogICAgICAgIGlmIHNlbGYuY29tbWFuZCA9PSAnY29udHJvbCc6CiAgICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlcXVlc3QgPSByZXFQYXJhbXNbJ3JlcXVlc3QnXQogICAgICAgICAgICBhcHBsaWFuY2VJZCA9IHJlcVBhcmFtc1snYXBwbGlhbmNlSWQnXQogICAgICAgICAgICB2YWx1ZSA9IHJlcVBhcmFtcy5nZXQoJ3ZhbHVlJywgTm9uZSkKICAgICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IpOgogICAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UobWVzc2FnZUlkLCAiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgICAgICAgIHJldHVybgogICAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBzZWxmLnNlcnZlci5jb250cm9sKG1lc3NhZ2VJZCwgYXBwbGlhbmNlSWQsIHJlcXVlc3QsIHZhbHVlKQogICAgICAgICAgc2VsZi5fc2VuZEpzb25SZXNwb25zZShyZXNwb25zZU9iamVjdCkKICAgICAgICBlbGlmIHNlbGYuY29tbWFuZCA9PSAnZGlzY292ZXJ5JzoKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gc2VsZi5zZXJ2ZXIuZGlzY292ZXJ5KG1lc3NhZ2VJZCkKICAgICAgICAgIHNlbGYuX3NlbmRKc29uUmVzcG9uc2UocmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxzZToKICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZShtZXNzYWdlSWQsICJVbmV4cGVjdGVkSW5mb3JtYXRpb25SZWNlaXZlZEVycm9yIikKICAgICAgZGVmIF9jb25maWcoc2VsZik6CiAgICAgICAgaW1wb3J0IGpzb24KICAgICAgICBtc2cgPSAiIgogICAgICAgIGlmIHNlbGYucG9zdHZhcnMgaXMgbm90IE5vbmU6CiAgICAgICAgICBjb25mTGlzdCA9IHNlbGYucG9zdHZhcnMuZ2V0KCdjb25mJywgTm9uZSkKICAgICAgICAgIGlmIGNvbmZMaXN0IGlzIG5vdCBOb25lOgogICAgICAgICAgICBzZWxmLnNlcnZlci5sb2coIlNhdmluZyBhcHBsaWFuY2VzIGNvbmZpZ3VyYXRpb24gdG8gezB9Ii5mb3JtYXQoc2VsZi5zZXJ2ZXIuRklMRVBBVEhfQVBQTElBTkNFUyksIHNldmVyaXR5PSJpbmZvIikKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgIHNlbGYuc2VydmVyLmNvbmYgPSBqc29uLmxvYWRzKGNvbmZMaXN0WzBdLCBlbmNvZGluZz0iaXNvODg1OS0xIikKICAgICAgICAgICAgICB3aXRoIG9wZW4oc2VsZi5zZXJ2ZXIuRklMRVBBVEhfQVBQTElBTkNFUywgIndiIikgYXMgb3V0cHV0OgogICAgICAgICAgICAgICAgb3V0cHV0LndyaXRlKGNvbmZMaXN0WzBdKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgbXNnID0gIkZhaWxlZCB0byBwYXJzZSBhcHBsaWFuY2VzIGNvbmZpZ3VyYXRpb24uIgogICAgICAgICAgICAgIHNlbGYuc2VydmVyLk1DLkRlYnVnLnNldEVycihzeXMuZXhjX2luZm8oKSwgbXNnKQogICAgICAgIHNlbGYuc2VuZF9yZXNwb25zZSgyMDApCiAgICAgICAgc2VsZi5zZW5kX2hlYWRlcignQ29udGVudC1UeXBlJywgJ3RleHQvaHRtbDsgY2hhcnNldD1JU08tODg1OS0xJykKICAgICAgICBzZWxmLmVuZF9oZWFkZXJzKCkKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8aHRtbD48aGVhZD48bWV0YSBjaGFyc2V0PSdJU08tODg1OS0xJz48L2hlYWQ+PGJvZHk+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8Zm9ybSBtZXRob2Q9J3Bvc3QnIGVuY3R5cGU9J2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgYWNjZXB0LWNoYXJzZXQ9J0lTTy04ODU5LTEnPiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPHRhYmxlIHN0eWxlPSd3aWR0aDoxMDAlO2hlaWdodDoxMDAlJz48dHI+PHRkPjxoMT5BbWF6b24gRWNobyAtIEFwcGxpYW5jZXM8L2gxPjwvdGQ+PC90cj4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjx0ciBzdHlsZT0naGVpZ2h0Ojk5JSc+PHRkPjx0ZXh0YXJlYSBuYW1lPSdjb25mJyBzdHlsZT0nd2lkdGg6MTAwJTtoZWlnaHQ6MTAwJSc+IikKICAgICAgICBpZiBzZWxmLnNlcnZlci5jb25mICE9ICIiOgogICAgICAgICAgcmVzcCA9IGpzb24uZHVtcHMoc2VsZi5zZXJ2ZXIuY29uZiwgZGVmYXVsdD1hc0RpY3QsIGVuY29kaW5nPSJpc284ODU5LTEiKQogICAgICAgIGVsc2U6CiAgICAgICAgICByZXNwID0gIiIKICAgICAgICBzZWxmLndmaWxlLndyaXRlKHJlc3ApCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPC90ZXh0YXJlYT48L3RkPjwvdHI+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8dHI+PHRkPjxpbnB1dCB0eXBlPSdzdWJtaXQnLz48L3RkPjwvdHI+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8dHI+PHRkIHN0eWxlPSdjb2xvcjpyZWQnPiIgKyBtc2cgKyAiPC90ZD48L3RyPiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPC9mb3JtPjwvYm9keT48L2h0bWw+IikKICAgICAgZGVmIF9zZW5kSnNvbkVycm9yUmVzcG9uc2Uoc2VsZiwgbWVzc2FnZUlkLCBlcnJvck1lc3NhZ2UpOgogICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gTm9uZQogICAgICAgIGlmIHNlbGYuY29tbWFuZCA9PSAnY29udHJvbCc6CiAgICAgICAgICByZXNwb25zZU9iamVjdCA9IEFtYXpvbkVjaG8uQ29udHJvbFJlc3BvbnNlKG1lc3NhZ2VJZCkKICAgICAgICBlbGlmIHNlbGYuY29tbWFuZCA9PSAnZGlzY292ZXJ5JzoKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gQW1hem9uRWNoby5EaXNjb3ZlcnlSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgICAgZWxzZToKICAgICAgICAgIHNlbGYuc2VuZF9lcnJvcig0MDQsICdOb3QgRm91bmQnKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZShlcnJvck1lc3NhZ2UpCiAgICAgICAgc2VsZi5fc2VuZEpzb25SZXNwb25zZShyZXNwb25zZU9iamVjdCkKICAgICAgZGVmIF9zZW5kSnNvblJlc3BvbnNlKHNlbGYsIHJlc3BvbnNlT2JqZWN0KToKICAgICAgICBpbXBvcnQganNvbgogICAgICAgIHJlc3AgPSBqc29uLmR1bXBzKHJlc3BvbnNlT2JqZWN0LCBkZWZhdWx0PWFzRGljdCwgZW5jb2Rpbmc9Imlzbzg4NTktMSIpCiAgICAgICAgc2VsZi5zZW5kX3Jlc3BvbnNlKDIwMCkKICAgICAgICBzZWxmLnNlbmRfaGVhZGVyKCdDb250ZW50LVR5cGUnLCAnYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCcpCiAgICAgICAgc2VsZi5lbmRfaGVhZGVycygpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZShyZXNwKQogICAgICBkZWYgX2J1aWxkUmVxUGFyYW1NYXAoc2VsZiwgcXVlcnkpOgogICAgICAgIGltcG9ydCB1cmxsaWIKICAgICAgICByZXFfcGFyYW1zID0ge30KICAgICAgICBwYXJhbXMgPSBxdWVyeS5zcGxpdCgnJicpCiAgICAgICAgZm9yIHBhcmFtIGluIHBhcmFtczoKICAgICAgICAgIGlkeCA9IHBhcmFtLmZpbmQoJz0nKQogICAgICAgICAgcmVxX3BhcmFtc1twYXJhbVswOmlkeF1dID0gdXJsbGliLnVucXVvdGVfcGx1cyhwYXJhbVtpZHggKyAxOl0pCiAgICAgICAgcmV0dXJuIHJlcV9wYXJhbXMKICAgIGRlZiBzdGFydChzZWxmKToKICAgICAgc2VsZi5sb2coIlN0YXJ0ICIsIHNldmVyaXR5PSJpbmZvIikKICAgICAgaWYgc2VsZi5zZXJ2ZXJUaHJlYWQgaXMgTm9uZToKICAgICAgICBIVFRQU2VydmVyLl9faW5pdF9fKHNlbGYsIChzZWxmLmlwLCBzZWxmLnBvcnQpLCBzZWxmLkhUVFBSZXF1ZXN0SGFuZGxlcikKICAgICAgICBpZiBzZWxmLmNlcnRUZXh0ICE9ICIiOgogICAgICAgICAgd2l0aCBvcGVuKHNlbGYuRklMRVBBVEhfQ0VSVCwgIndiIikgYXMgb3V0cHV0OgogICAgICAgICAgICBvdXRwdXQud3JpdGUoc2VsZi5jZXJ0VGV4dCkKICAgICAgICAgIGltcG9ydCBzc2wKICAgICAgICAgIHNlbGYuc29ja2V0ID0gc3NsLndyYXBfc29ja2V0KHNlbGYuc29ja2V0LCBjZXJ0ZmlsZT1zZWxmLkZJTEVQQVRIX0NFUlQsIHNlcnZlcl9zaWRlPVRydWUpCiAgICAgICAgZnJvbSBoc19xdWV1ZSBpbXBvcnQgaHNfdGhyZWFkaW5nIGFzIHRocmVhZGluZwogICAgICAgIHNlbGYuc2VydmVyVGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9c2VsZi5zZXJ2ZV9mb3JldmVyLCBuYW1lPSdhbWF6b25fZWNob19zZXJ2ZXInKQogICAgICAgIHNlbGYuc2VydmVyVGhyZWFkLmRhZW1vbiA9IFRydWUKICAgICAgICBzZWxmLnNlcnZlclRocmVhZC5zdGFydCgpCiAgICBkZWYgc3RvcChzZWxmKToKICAgICAgc2VsZi5sb2coIlN0b3AgIiwgc2V2ZXJpdHk9ImluZm8iKQogICAgICBpZiBub3Qgc2VsZi5zZXJ2ZXJUaHJlYWQgaXMgTm9uZToKICAgICAgICBIVFRQU2VydmVyLnNodXRkb3duKHNlbGYpCiAgICAgICAgc2VsZi5zb2NrZXQuY2xvc2UoKQogICAgICAgIHNlbGYuc2VydmVyVGhyZWFkID0gTm9uZQogICAgZGVmIGdldFNTTENlcnQoc2VsZiwgaXAsIGNlcnRGaWxlbmFtZSk6CiAgICAgIHRyeToKICAgICAgICBpbXBvcnQgdXJsbGliMgogICAgICAgIHVybCA9ICJodHRwOi8vezB9L29wdC97MX0iLmZvcm1hdChpcCwgY2VydEZpbGVuYW1lKQogICAgICAgIHJlcSA9IHVybGxpYjIuUmVxdWVzdCh1cmwpCiAgICAgICAgcmVzID0gdXJsbGliMi51cmxvcGVuKHJlcSkKICAgICAgICBpZiByZXMuZ2V0Y29kZSgpID09IDIwMDoKICAgICAgICAgIHJldHVybiByZXMuZnAucmVhZCgpCiAgICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICAgIHJldHVybiAiIgogICAgZGVmIHdlYkNhbGxiYWNrU1NMQ2VydChzZWxmLCBzdHJlYW09RmFsc2UpOgogICAgICBodG1sID0gIjxodG1sPjxoZWFkPiIKICAgICAgaHRtbCArPSAiPG1ldGEgY2hhcnNldD0nSVNPLTg4NTktMScvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0nY2FjaGUtY29udHJvbCcgY29udGVudD0nbWF4LWFnZT0wJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdjYWNoZS1jb250cm9sJyBjb250ZW50PSduby1jYWNoZScvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0nZXhwaXJlcycgY29udGVudD0nMCcvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0nZXhwaXJlcycgY29udGVudD0nVHVlLCAwMSBKYW4gMTk4MCAxOjAwOjAwIEdNVCcvPiIKICAgICAgaHRtbCArPSAiPG1ldGEgaHR0cC1lcXVpdj0ncHJhZ21hJyBjb250ZW50PSduby1jYWNoZScvPiIKICAgICAgaHRtbCArPSAiPC9oZWFkPjxib2R5PiIKICAgICAgaHRtbCArPSAiPGgxPkFtYXpvbiBFY2hvIC0gU1NMIENlcnRpZmljYXRlPC9oMT4iCiAgICAgIGh0bWwgKz0gIjxwcmU+PGNvZGU+IgogICAgICBodG1sICs9IHNlbGYuY2VydFRleHQKICAgICAgaHRtbCArPSAiPC9wcmU+PC9jb2RlPiIKICAgICAgaHRtbCArPSAiPC9ib2R5PjwvaHRtbD4iCiAgICAgIGlmIHN0cmVhbToKICAgICAgICAgIHN0cmVhbS53cml0ZShodG1sKQogICAgICBzZWxmLkRhdExlbiA9IGxlbihodG1sKQogICAgZGVmIGluaXRfZGVidWdfZW50cnkoc2VsZik6CiAgICAgIHByb3RvID0gImh0dHAiCiAgICAgIGlmIHNlbGYuY2VydFRleHQgIT0gIiI6CiAgICAgICAgcHJvdG8gPSAiaHR0cHMiCiAgICAgIGltcG9ydCB1cmxsaWIKICAgICAgc2VsZi5NQy5EZWJ1Zy5hZGRHcnVwcGUoCiAgICAgICAgW3NlbGYuaWQsIHNlbGYuaWRdLAogICAgICAgICAgWyAKICAgICAgICAgICAgWyIwVkVSU0lPTklORk8iLCJWZXJzaW9uIiwxLCdWMC4xIC0gKDIwMTYtMTEtMjUgMTg6MDQpJ10sCiAgICAgICAgICAgIFsiMVBPUlQiLCJQb3J0IiwxLHN0cihzZWxmLnBvcnQpXSwKICAgICAgICAgICAgWyIyU1NMIiwiU1NMLUNlcnRpZmljYXRlIiwxLCI8YSBocmVmPScvb3B0L3swfSc+c2hvdzwvYT48YnI+Ii5mb3JtYXQoc2VsZi5VUkxfU0hPV19TU0wpXSwKICAgICAgICAgICAgWyIzQ09ORklHIiwiQXBwbGlhbmNlcyBjb25maWd1cmF0aW9uIiwxLCI8YSBocmVmPSd7MH06Ly97MX06ezJ9L2NvbmZpZz9hY2Nlc3NUb2tlbj17M30nPmVkaXQ8L2E+PGJyPiIuZm9ybWF0KHByb3RvLCBzZWxmLmlwLCBzZWxmLnBvcnQsIHVybGxpYi5xdW90ZV9wbHVzKHNlbGYuYWNjZXNzVG9rZW4pKV0sCiAgICAgICAgICBdICAgCiAgICAgICkKICAgIGRlZiBkZWJ1ZyhzZWxmLCBtc2csIGx2bD01KToKICAgICAgaW1wb3J0IHRpbWUKICAgICAgc2VsZi5sb2cobXNnLCBzZXZlcml0eT0nZGVidWcnKQogICAgICBwcmludCAiJXMgREVCVUc6ICVyIiAlICh0aW1lLnN0cmZ0aW1lKCIlSDolTTolUyIpLCBtc2csICkKICAgIGRlZiBsb2coc2VsZiwgbXNnLCBzZXZlcml0eT0naW5mbycpOgogICAgICBpbXBvcnQgdGltZQogICAgICBmcm9tIGhhc2hsaWIgaW1wb3J0IG1kNQogICAgICBfbXNnX3VpZCA9IG1kNSggIiVzJXMiICUgKCBzZWxmLmlkLCB0aW1lLnRpbWUoKSApICkuaGV4ZGlnZXN0KCkKICAgICAgX21zZyA9ICc8bG9nPjxpZD4lczwvaWQ+PGZhY2lsaXR5PkFtYXpvbl9FY2hvX1NlcnZlcjwvZmFjaWxpdHk+PHNldmVyaXR5PiVzPC9zZXZlcml0eT48bWVzc2FnZT4lczwvbWVzc2FnZT48L2xvZz4nICUgKF9tc2dfdWlkLCBzZXZlcml0eSwgbXNnKQogICAgICBzZWxmLnNlbmRUb091dHB1dCgxLF9tc2cpCiAgICBkZWYgc2VuZFRvT3V0cHV0KHNlbGYsIG91dCwgbXNnKToKICAgICAgb3V0IC09IDEKICAgICAgc2VsZi5sb2NhbHNbIkFOIl1bb3V0XSA9IG1zZwogICAgICBzZWxmLmxvY2Fsc1siQUMiXVtvdXRdID0gMSAgCg=='),'<10013_Amazon Echo (10013)>','exec'))"|""|0|0|0|0
## MD5 der Formelzeile: 5154fb4ea9144ce813175bde2b4a52ca
### Klasse AmazonEcho
################################
## Quelltext nicht Öffentlich ##
################################




## Klasse auf SN1 
5012|1|"EI"|"1"|"10"|0|1|0|0
5012|0|"OC[1]"|"AmazonEcho(locals())"|""|0|0|1|0

#5012|abbruch bei bed. (0/1)|bedingung|formel|zeit|pin-ausgang|pin-offset|pin-speicher|pin-neg.ausgang
5012|0|"(OC[1] or EC[1]) and EN[1]"|"SN[1].start()"|""|0|0|0|0
5012|0|"EC[1] and not EN[1]"|"SN[1].stop()"|""|0|0|0|0



