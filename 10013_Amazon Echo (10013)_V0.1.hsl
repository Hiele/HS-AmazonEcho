# -*- coding: iso8859-1 -*-
## -----------------------------------------------------
## Amazon Echo (10013)   ### V0.1
##
## erstellt am: 2016-11-25 13:58
## -----------------------------------------------------
## Copyright © 2016, Werner Lindbüchl, All rights reserved.
##
## This program is free software; you can redistribute it and/or modify it under the terms
## of the GNU General Public License as published by the Free Software Foundation; either
## version 3 of the License, or (at your option) any later version.
##
## This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
## without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
## See the GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License along with this program;
## if not, see <http://www.gnu.de/documents/gpl-3.0.de.html>.

## -- 
## --  

#5000|"Text"|Remanent(1/0)|Anz.Eingänge|.n.|Anzahl Ausgänge|.n.|.n.
5000|"#WJL\Amazon Echo (10013)_V0.1"|0|3|"E1 Https-Server Start/Stop"|"E2 Https-Server Port"|"E3 Access Token"|1|"A1 Systemlog"|"V0.1"

#5001|Anzahl Eingänge|Ausgänge|Offset|Speicher|Berechnung bei Start
5001|3|1|1|1|1

# Eingaenge
#5002|Index Eingang|Default Wert|0=numerisch 1=alphanummerisch
5002|1|0|0	#* E1 Https-Server Start/Stop 
5002|2|0|0	#* E2 Https-Server Port 
5002|3|0|1	#* E3 Access Token 

# Speicher
#5003|Speicher|Initwert|Remanent
5003|1||0		  #* Klassenspeicher 

# Ausgaenge
#5004|ausgang|Initwert|runden binär (0/1)|typ (1-send/2-sbc)|0=numerisch 1=alphanummerisch
5004|1|""|0|1|1 

#################################################

5012|0|"OC[1]"|"eval(compile(__import__('base64').decodestring('CmlmIE9DWzFdPT0xOgogIGdsb2JhbCBhc0RpY3QKICBkZWYgYXNEaWN0KG8pOgogICAgICByZXR1cm4gby5fX2RpY3RfXwogIGdsb2JhbCBIVFRQU2VydmVyCiAgZ2xvYmFsIEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBmcm9tIEJhc2VIVFRQU2VydmVyIGltcG9ydCBIVFRQU2VydmVyLEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIKICBnbG9iYWwgVGhyZWFkaW5nTWl4SW4KICBmcm9tIFNvY2tldFNlcnZlciBpbXBvcnQgVGhyZWFkaW5nTWl4SW4KICBnbG9iYWwgQW1hem9uRWNob1dlYkNhbGxiYWNrCiAgY2xhc3MgQW1hem9uRWNob1dlYkNhbGxiYWNrKG9iamVjdCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgcEl0ZW0sIGNhbGxiYWNrLCBuYW1lLCB0eXBlPSd0ZXh0L2h0bWwnKToKICAgICAgc2VsZi5sb2dpayA9IHBJdGVtCiAgICAgIHNlbGYuY2FsbGJhY2sgPSBjYWxsYmFjawogICAgICBzZWxmLk1DID0gcEl0ZW0uTUMKICAgICAgc2VsZi5VcmxQZmFkID0gbmFtZS51cHBlcigpCiAgICAgIHNlbGYuRGF0TmFtZSA9ICJPUFQvJXMiICUgKHNlbGYuVXJsUGZhZCkKICAgICAgc2VsZi5EYXRMZW4gPSAwCiAgICAgIHNlbGYuVHlwID0gdHlwZQogICAgICBzZWxmLmlzUXVhZCA9IDAKICAgICAgc2VsZi5NQy5HVUkuRXh0RGF0VXJsW3NlbGYuVXJsUGZhZF0gPSBzZWxmCiAgICBkZWYgZ2V0RGF0ZW4oc2VsZik6CiAgICAgIHJldHVybgogICAgZGVmIGdldFF1YWREYXRlbihzZWxmKToKICAgICAgcmV0dXJuIAogICAgZGVmIGdldERhdGVuU3RyZWFtKHNlbGYsIHN0cmVhbSk6CiAgICAgIHNlbGYuRGF0TGVuID0gc2VsZi5jYWxsYmFjayhzdHJlYW0pCiAgICBkZWYgZ2V0UXVhZERhdGVuU3RyZWFtKHNlbGYsIHN0cmVhbSk6CiAgICAgIHNlbGYuZ2V0RGF0ZW5TdHJlYW0oc3RyZWFtKQogIGdsb2JhbCBBbWF6b25FY2hvCiAgY2xhc3MgQW1hem9uRWNobyhUaHJlYWRpbmdNaXhJbiwgSFRUUFNlcnZlcik6CiAgICBQQVRIX0JBU0UgPSAiL3RtcC8iCiAgICBGSUxFTkFNRV9DRVJUID0gImFtYXpvbkVjaG9TU0wuY2VydCIKICAgIEZJTEVQQVRIX0NFUlQgPSBQQVRIX0JBU0UgKyBGSUxFTkFNRV9DRVJUCiAgICBGSUxFTkFNRV9BUFBMSUFOQ0VTID0gImFtYXpvbkVjaG9BcHBsaWFuY2VzLmpzIgogICAgRklMRVBBVEhfQVBQTElBTkNFUyA9IFBBVEhfQkFTRSArIEZJTEVOQU1FX0FQUExJQU5DRVMKICAgIFVSTF9CQVNFID0gImFtYXpvbkVjaG8vIgogICAgVVJMX1NIT1dfU1NMID0gVVJMX0JBU0UgKyAic3NsQ2VydC5odG0iCiAgICBhbGxvd19yZXVzZV9hZGRyZXNzID0gVHJ1ZQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGxvY2Fscyk6CiAgICAgIHNlbGYubG9jYWxzID0gbG9jYWxzOwogICAgICBzZWxmLmxvZ2lrID0gbG9jYWxzWydwSXRlbSddCiAgICAgIHNlbGYuTUMgPSBzZWxmLmxvZ2lrLk1DCiAgICAgIHNlbGYuaXAgPSBzZWxmLk1DLkV0aGVybmV0LklQQWRyCiAgICAgIEVOID0gbG9jYWxzWydFTiddCiAgICAgIHNlbGYucG9ydCA9IGludChFTlsyXSkKICAgICAgc2VsZi5hY2Nlc3NUb2tlbiA9IEVOWzNdCiAgICAgIHNlbGYuaWQgPSAnQW1hem9uX0VjaG9fU2VydmVyJwogICAgICBzZWxmLnNlcnZlclRocmVhZCA9IE5vbmUKICAgICAgc2VsZi5jZXJ0VGV4dCA9IHNlbGYuZ2V0U1NMQ2VydChzZWxmLmlwLCBzZWxmLkZJTEVOQU1FX0NFUlQpCiAgICAgIHNlbGYuaW5pdEFwcGxpYW5jZXMoKQogICAgICBBbWF6b25FY2hvV2ViQ2FsbGJhY2soc2VsZi5sb2dpaywgc2VsZi53ZWJDYWxsYmFja1NTTENlcnQsIHNlbGYuVVJMX1NIT1dfU1NMKQogICAgICBzZWxmLmluaXRfZGVidWdfZW50cnkoKTsKICAgIGRlZiBpbml0QXBwbGlhbmNlcyhzZWxmKToKICAgICAgdHJ5OgogICAgICAgIHdpdGggb3BlbihzZWxmLkZJTEVQQVRIX0FQUExJQU5DRVMsICdyJykgYXMgbXlmaWxlOgogICAgICAgICAgZGF0YT1teWZpbGUucmVhZCgpCiAgICAgICAgaW1wb3J0IGpzb24KICAgICAgICBzZWxmLmNvbmYgPSBqc29uLmxvYWRzKGRhdGEsIGVuY29kaW5nPSJpc284ODU5LTEiKQogICAgICBleGNlcHQ6CiAgICAgICAgc2VsZi5jb25mID0gIiIKICAgICAgc2VsZi5hcHBsaWFuY2VzID0gW10KICAgICAgaWYgc2VsZi5jb25mID09ICIiOgogICAgICAgIHNlbGYuZGlzY292ZXJBcHBsaWFuY2VzKCkKICAgIGRlZiBkaXNjb3ZlckFwcGxpYW5jZXMoc2VsZik6CiAgICAgIGltcG9ydCByZQogICAgICByZWdleCA9IHJlLmNvbXBpbGUoIiguKilcW1xzKihTd2l0Y2hhYmxlfExpZ2h0aW5nKVxzKlxdXHMqJCIpCiAgICAgIGZvciBpa28gaW4gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3Q6IAogICAgICAgIGtvID0gc2VsZi5NQy5UYWdMaXN0LlRhZ0xpc3RbaWtvXQogICAgICAgIG1hdGNoID0gcmVnZXguc2VhcmNoKGtvLlJQQ1RleHQpCiAgICAgICAgaWYgbWF0Y2g6CiAgICAgICAgICBhcHBsaWFuY2UgPSBBbWF6b25FY2hvLktOWEFwcGxpYW5jZShrbywgbWF0Y2guZ3JvdXBzKClbMF0uc3RyaXAoKSwgbWF0Y2guZ3JvdXBzKClbMV0pCiAgICAgICAgICBzZWxmLmFwcGxpYW5jZXMuYXBwZW5kKGFwcGxpYW5jZSkKICAgIGNsYXNzIEtOWEFwcGxpYW5jZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwga28sIGZyaWVuZGx5TmFtZSwgdHlwZSk6CiAgICAgICAgc2VsZi5rbyA9IGtvCiAgICAgICAgc2VsZi5mcmllbmRseU5hbWUgPSBmcmllbmRseU5hbWUKICAgICAgICBzZWxmLnR5cGUgPSB0eXBlCiAgICBkZWYgZGlzY292ZXJ5KHNlbGYsIG1lc3NhZ2VJZCk6CiAgICAgIHJlc3BvbnNlT2JqZWN0ID0gQW1hem9uRWNoby5EaXNjb3ZlcnlSZXNwb25zZShtZXNzYWdlSWQpCiAgICAgIGlmIHNlbGYuY29uZiAhPSAiIjoKICAgICAgICBpZCA9IDAKICAgICAgICBmb3IgZGV2aWNlIGluIHNlbGYuY29uZjoKICAgICAgICAgIHJvb20gPSBkZXZpY2UuZ2V0KCdyb29tJykKICAgICAgICAgIGlkICs9IDEKICAgICAgICAgIGlkU3RyID0gc3RyKGlkKQogICAgICAgICAgamQgPSAwCiAgICAgICAgICBmb3IgYXBwbGlhbmNlIGluIGRldmljZVsnYXBwbGlhbmNlcyddOgogICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgIHR5cGUgPSAnU3dpdGNoYWJsZScKICAgICAgICAgICAgcGVyY2VudCA9IGFwcGxpYW5jZS5nZXQoJ3BlcmNlbnQnKTsKICAgICAgICAgICAgaWYgcGVyY2VudCBpcyBub3QgTm9uZToKICAgICAgICAgICAgICB0eXBlID0gJ0xpZ2h0aW5nJwogICAgICAgICAgICBpZiByb29tICE9ICIiOgogICAgICAgICAgICAgIGlmIGpkID09IDE6CiAgICAgICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciwgcm9vbSwgdHlwZSkKICAgICAgICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgICAgICAgICAgbmFtZSA9IHJvb20gKyAiICIgKyBhcHBsaWFuY2VbJ25hbWUnXQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgIG5hbWUgPSBhcHBsaWFuY2VbJ25hbWUnXQogICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciArICJfIiArIHN0cihqZCksIG5hbWUsIHR5cGUpCiAgICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgICAgICAgIGFsaWFzZXMgPSBhcHBsaWFuY2UuZ2V0KCdhbGlhc2VzJyk7CiAgICAgICAgICAgIGlmIGFsaWFzZXMgaXMgbm90IE5vbmU6CiAgICAgICAgICAgICAgZm9yIGFsaWFzIGluIGFsaWFzZXM6CiAgICAgICAgICAgICAgICBqZCArPSAxCiAgICAgICAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShpZFN0ciArICJfIiArIHN0cihqZCksIGFsaWFzLCB0eXBlKQogICAgICAgICAgICAgICAgcmVzcG9uc2VPYmplY3QuYWRkQXBwbGlhbmNlKGRpc2NvdmVyeUFwcGxpYW5jZSkKICAgICAgZWxzZToKICAgICAgICBmb3IgYXBwbGlhbmNlIGluIHNlbGYuYXBwbGlhbmNlczoKICAgICAgICAgIGtvID0gYXBwbGlhbmNlLmtvCiAgICAgICAgICBkaXNjb3ZlcnlBcHBsaWFuY2UgPSBBbWF6b25FY2hvLkRpc2NvdmVyeUFwcGxpYW5jZShzdHIoa28uSUQpLCBhcHBsaWFuY2UuZnJpZW5kbHlOYW1lLCBhcHBsaWFuY2UudHlwZSkKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0LmFkZEFwcGxpYW5jZShkaXNjb3ZlcnlBcHBsaWFuY2UpCiAgICAgIHJldHVybiByZXNwb25zZU9iamVjdAogICAgZGVmIGNvbnRyb2woc2VsZiwgbWVzc2FnZUlkLCBhcHBsaWFuY2VJZCwgcmVxdWVzdCwgdmFsdWUpOgogICAgICByZXNwb25zZU9iamVjdCA9IEFtYXpvbkVjaG8uQ29udHJvbFJlc3BvbnNlKG1lc3NhZ2VJZCkKICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5zdXBwb3J0ZWRPcGVyYXRpb25FcnJvciIpCiAgICAgIGFwcGxpYW5jZSA9IHNlbGYuZmluZEFwcGxpYW5jZShhcHBsaWFuY2VJZCkKICAgICAgaWYgYXBwbGlhbmNlIGlzIG5vdCBOb25lOgogICAgICAgIG9uVmFsdWUgPSAxLjAKICAgICAgICBvZmZWYWx1ZSA9IDAuMAogICAgICAgIGlmIHR5cGUoYXBwbGlhbmNlKSBpcyBub3QgQW1hem9uRWNoby5LTlhBcHBsaWFuY2U6CiAgICAgICAgICBvbk9mZktvID0gc2VsZi5maW5kS28oYXBwbGlhbmNlWydvbk9mZiddKQogICAgICAgICAgaWYgb25PZmZLbyBpcyBOb25lOgogICAgICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJOb1N1Y2hUYXJnZXRFcnJvciIpCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZU9iamVjdAogICAgICAgICAgcGVyY2VudCA9IGFwcGxpYW5jZS5nZXQoJ3BlcmNlbnQnKTsKICAgICAgICAgIGlmIHBlcmNlbnQgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIGFwcGxpYW5jZVR5cGUgPSAiTGlnaHRpbmciCiAgICAgICAgICAgIHBlcmNlbnRLbyA9IHNlbGYuZmluZEtvKGFwcGxpYW5jZVsncGVyY2VudCddKQogICAgICAgICAgZWxzZToKICAgICAgICAgICAgYXBwbGlhbmNlVHlwZSA9ICJTd2l0Y2hhYmxlIgogICAgICAgICAgYXBwbGlhbmNlVmFsdWUgPSBhcHBsaWFuY2UuZ2V0KCd2YWx1ZScpCiAgICAgICAgICBpZiBhcHBsaWFuY2VWYWx1ZSBpcyBub3QgTm9uZToKICAgICAgICAgICAgb25WYWx1ZSA9IGFwcGxpYW5jZVZhbHVlCiAgICAgICAgZWxzZToKICAgICAgICAgIGFwcGxpYW5jZVR5cGUgPSBhcHBsaWFuY2UudHlwZQogICAgICAgICAgb25PZmZLbyA9IHBlcmNlbnRLbyA9IGFwcGxpYW5jZS5rbwogICAgICAgICAgaWYgYXBwbGlhbmNlVHlwZSA9PSAiTGlnaHRpbmciOgogICAgICAgICAgICBvblZhbHVlID0gMTAwLjAKICAgICAgICBpZiBhcHBsaWFuY2VUeXBlID09ICJMaWdodGluZyI6CiAgICAgICAgICBpZiByZXF1ZXN0ID09ICdUdXJuT25SZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YU2V0VmFsdWUob25PZmZLbywgb25WYWx1ZSwgIlR1cm5PbkNvbmZpcm1hdGlvbiIsIHJlc3BvbnNlT2JqZWN0KQogICAgICAgICAgZWxpZiByZXF1ZXN0ID09ICdUdXJuT2ZmUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKG9uT2ZmS28sIG9mZlZhbHVlLCAiVHVybk9mZkNvbmZpcm1hdGlvbiIsIHJlc3BvbnNlT2JqZWN0KQogICAgICAgICAgZWxpZiByZXF1ZXN0ID09ICdTZXRQZXJjZW50YWdlUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFBlcmNlbnQocGVyY2VudEtvLCB2YWx1ZSwgIlNldFBlcmNlbnRhZ2VDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnSW5jcmVtZW50UGVyY2VudGFnZVJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhBZGRQZXJjZW50KHBlcmNlbnRLbywgdmFsdWUsIDEsICJJbmNyZW1lbnRQZXJjZW50YWdlQ29uZmlybWF0aW9uIiwgcmVzcG9uc2VPYmplY3QpCiAgICAgICAgICBlbGlmIHJlcXVlc3QgPT0gJ0RlY3JlbWVudFBlcmNlbnRhZ2VSZXF1ZXN0JzoKICAgICAgICAgICAgc2VsZi5fS05YQWRkUGVyY2VudChwZXJjZW50S28sIHZhbHVlLCAtMSwgIkRlY3JlbWVudFBlcmNlbnRhZ2VDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbGlmIGFwcGxpYW5jZVR5cGUgPT0gIlN3aXRjaGFibGUiOgogICAgICAgICAgaWYgcmVxdWVzdCA9PSAnVHVybk9uUmVxdWVzdCc6CiAgICAgICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKG9uT2ZmS28sIG9uVmFsdWUsICJUdXJuT25Db25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICAgIGVsaWYgcmVxdWVzdCA9PSAnVHVybk9mZlJlcXVlc3QnOgogICAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShvbk9mZktvLCBvZmZWYWx1ZSwgIlR1cm5PZmZDb25maXJtYXRpb24iLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbHNlOgogICAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgIGVsc2U6CiAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiTm9TdWNoVGFyZ2V0RXJyb3IiKQogICAgICByZXR1cm4gcmVzcG9uc2VPYmplY3QKICAgIGRlZiBfS05YQWRkUGVyY2VudChzZWxmLCBrbywgdmFsdWUsIHNpZ24sIG5hbWUsIHJlc3BvbnNlT2JqZWN0KToKICAgICAgdHJ5OgogICAgICAgIGZ2YWx1ZSA9IGtvLmdldFdlcnQoKSArIChzaWduICogZmxvYXQodmFsdWUpKQogICAgICAgIGlmIGZ2YWx1ZSA8IDAuMDoKICAgICAgICAgIGZ2YWx1ZSA9IDAuMAogICAgICAgIGVsaWYgZnZhbHVlID4gMTAwLjA6CiAgICAgICAgICBmdmFsdWUgPSAxMDAuMAogICAgICAgIHNlbGYuX0tOWFNldFZhbHVlKGtvLCBmdmFsdWUsIG5hbWUsIHJlc3BvbnNlT2JqZWN0KQogICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJVbnN1cHBvcnRlZFRhcmdldFNldHRpbmdFcnJvciIpCiAgICBkZWYgX0tOWFNldFBlcmNlbnQoc2VsZiwga28sIHZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCk6CiAgICAgIHRyeToKICAgICAgICBmdmFsdWUgPSBmbG9hdCh2YWx1ZSkKICAgICAgICBpZiBmdmFsdWUgPj0gMC4wIGFuZCBmdmFsdWUgPD0gMTAwLjA6CiAgICAgICAgICBzZWxmLl9LTlhTZXRWYWx1ZShrbywgZnZhbHVlLCBuYW1lLCByZXNwb25zZU9iamVjdCkKICAgICAgICBlbHNlOgogICAgICAgICAgcmVzcG9uc2VPYmplY3Quc2V0TmFtZSgiVmFsdWVPdXRPZlJhbmdlRXJyb3IiKQogICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKCJVbnN1cHBvcnRlZFRhcmdldFNldHRpbmdFcnJvciIpCiAgICBkZWYgX0tOWFNldFZhbHVlKHNlbGYsIGtvLCBmdmFsdWUsIG5hbWUsIHJlc3BvbnNlT2JqZWN0KToKICAgICAgc2VsZi5sb2dpay5NQy5UYWdMaXN0LnNldFdlcnQoRkxBR19FSUJfTE9HSUssIGtvLCBmdmFsdWUpCiAgICAgIHJlc3BvbnNlT2JqZWN0LnNldE5hbWUobmFtZSkKICAgIGRlZiBmaW5kQXBwbGlhbmNlKHNlbGYsIGFwcGxpYW5jZUlkKToKICAgICAgaWYgc2VsZi5jb25mICE9ICIiOgogICAgICAgIGlkID0gMAogICAgICAgIGZvciBkZXZpY2UgaW4gc2VsZi5jb25mOgogICAgICAgICAgcm9vbSA9IGRldmljZVsncm9vbSddCiAgICAgICAgICBpZCArPSAxCiAgICAgICAgICBpZFN0ciA9IHN0cihpZCkKICAgICAgICAgIGlmIGFwcGxpYW5jZUlkID09IGlkU3RyOgogICAgICAgICAgICByZXR1cm4gZGV2aWNlWydhcHBsaWFuY2VzJ11bMF0KICAgICAgICAgIGpkID0gMAogICAgICAgICAgZm9yIGFwcGxpYW5jZSBpbiBkZXZpY2VbJ2FwcGxpYW5jZXMnXToKICAgICAgICAgICAgamQgKz0gMQogICAgICAgICAgICBpZiBhcHBsaWFuY2VJZCA9PSBpZFN0ciArICJfIiArIHN0cihqZCk6CiAgICAgICAgICAgICAgcmV0dXJuIGFwcGxpYW5jZQogICAgICAgICAgICBhbGlhc2VzID0gYXBwbGlhbmNlLmdldCgnYWxpYXNlcycpOwogICAgICAgICAgICBpZiBhbGlhc2VzIGlzIG5vdCBOb25lOgogICAgICAgICAgICAgIGZvciBhbGlhcyBpbiBhbGlhc2VzOgogICAgICAgICAgICAgICAgamQgKz0gMQogICAgICAgICAgICAgICAgaWYgYXBwbGlhbmNlSWQgPT0gaWRTdHIgKyAiXyIgKyBzdHIoamQpOgogICAgICAgICAgICAgICAgICByZXR1cm4gYXBwbGlhbmNlCiAgICAgIGVsc2U6CiAgICAgICAgZm9yIGFwcGxpYW5jZSBpbiBzZWxmLmFwcGxpYW5jZXM6CiAgICAgICAgICBrbyA9IGFwcGxpYW5jZS5rbwogICAgICAgICAgaWYgc3RyKGtvLklEKSA9PSBhcHBsaWFuY2VJZDoKICAgICAgICAgICAgcmV0dXJuIGFwcGxpYW5jZQogICAgICByZXR1cm4gTm9uZQogICAgZGVmIGZpbmRLbyhzZWxmLCBncnBBZHJTdHIpOgogICAgICBmb3IgaWtvIGluIHNlbGYuTUMuVGFnTGlzdC5UYWdMaXN0OiAKICAgICAgICBrbyA9IHNlbGYuTUMuVGFnTGlzdC5UYWdMaXN0W2lrb10KICAgICAgICBpZiBrby5HcnBBZHJTdHIgPT0gZ3JwQWRyU3RyOgogICAgICAgICAgcmV0dXJuIGtvCiAgICAgIHJldHVybiBOb25lOwogICAgY2xhc3MgSGVhZGVyKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBtZXNzYWdlSWQsIG5hbWUsIG5hbWVzcGFjZSwgcGF5bG9hZFZlcnNpb24pOgogICAgICAgIHNlbGYubWVzc2FnZUlkID0gbWVzc2FnZUlkCiAgICAgICAgc2VsZi5uYW1lID0gbmFtZQogICAgICAgIHNlbGYubmFtZXNwYWNlID0gbmFtZXNwYWNlCiAgICAgICAgc2VsZi5wYXlsb2FkVmVyc2lvbiA9IHBheWxvYWRWZXJzaW9uCiAgICBjbGFzcyBDb250cm9sUmVzcG9uc2UoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYsIG1lc3NhZ2VJZCk6CiAgICAgICAgc2VsZi5oZWFkZXIgPSBBbWF6b25FY2hvLkhlYWRlcihtZXNzYWdlSWQsICIiLCAiQWxleGEuQ29ubmVjdGVkSG9tZS5Db250cm9sIiwgIjIiKQogICAgICAgIHNlbGYucGF5bG9hZCA9IHt9CiAgICAgIGRlZiBzZXROYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYuaGVhZGVyLm5hbWUgPSBuYW1lCiAgICBjbGFzcyBEaXNjb3ZlcnlSZXNwb25zZSgpOgogICAgICBkZWYgX19pbml0X18oc2VsZiwgbWVzc2FnZUlkKToKICAgICAgICBzZWxmLmhlYWRlciA9IEFtYXpvbkVjaG8uSGVhZGVyKG1lc3NhZ2VJZCwgIkRpc2NvdmVyQXBwbGlhbmNlc1Jlc3BvbnNlIiwgIkFsZXhhLkNvbm5lY3RlZEhvbWUuRGlzY292ZXJ5IiwgIjIiKQogICAgICAgIHNlbGYucGF5bG9hZCA9IEFtYXpvbkVjaG8uRGlzY292ZXJ5UGF5bG9hZCgpCiAgICAgIGRlZiBzZXROYW1lKHNlbGYsIG5hbWUpOgogICAgICAgIHNlbGYuaGVhZGVyLm5hbWUgPSBuYW1lCiAgICAgIGRlZiBhZGRBcHBsaWFuY2Uoc2VsZiwgYXBwbGlhbmNlKToKICAgICAgICBzZWxmLnBheWxvYWQuZGlzY292ZXJlZEFwcGxpYW5jZXMuYXBwZW5kKGFwcGxpYW5jZSkKICAgIGNsYXNzIERpc2NvdmVyeVBheWxvYWQoKToKICAgICAgZGVmIF9faW5pdF9fKHNlbGYpOgogICAgICAgIHNlbGYuZGlzY292ZXJlZEFwcGxpYW5jZXMgPSBbXQogICAgY2xhc3MgRGlzY292ZXJ5QXBwbGlhbmNlKCk6CiAgICAgIGRlZiBfX2luaXRfXyhzZWxmLCBhcHBsaWFuY2VJZCwgZnJpZW5kbHlOYW1lLCBhcHBsaWFuY2VUeXBlKToKICAgICAgICBzZWxmLmFwcGxpYW5jZUlkID0gYXBwbGlhbmNlSWQKICAgICAgICBzZWxmLmZyaWVuZGx5RGVzY3JpcHRpb24gPSBmcmllbmRseU5hbWUKICAgICAgICBzZWxmLmZyaWVuZGx5TmFtZSA9IGZyaWVuZGx5TmFtZQogICAgICAgIHNlbGYuaXNSZWFjaGFibGUgPSBUcnVlCiAgICAgICAgc2VsZi5tYW51ZmFjdHVyZXJOYW1lID0gIm4uYS4iCiAgICAgICAgc2VsZi5tb2RlbE5hbWUgPSAibi5hLiIKICAgICAgICBzZWxmLnZlcnNpb24gPSAiMS4wIgogICAgICAgIGlmIGFwcGxpYW5jZVR5cGUgPT0gIlN3aXRjaGFibGUiOgogICAgICAgICAgc2VsZi5hY3Rpb25zID0gWyJ0dXJuT24iLCAidHVybk9mZiJdCiAgICAgICAgZWxpZiBhcHBsaWFuY2VUeXBlID09ICJMaWdodGluZyI6CiAgICAgICAgICBzZWxmLmFjdGlvbnMgPSBbInR1cm5PbiIsICJ0dXJuT2ZmIiwgImluY3JlbWVudFBlcmNlbnRhZ2UiLCAiZGVjcmVtZW50UGVyY2VudGFnZSIsICJzZXRQZXJjZW50YWdlIl0KICAgICAgICBlbGlmIGFwcGxpY2FuY2VUeXBlID09ICJUaGVybW9zdGF0IjoKICAgICAgICAgIHNlbGYuYWN0aW9ucyA9IFsiaW5jcmVtZW50VGFyZ2V0VGVtcGVyYXR1cmUiLCAiZGVjcmVtZW50VGFyZ2V0VGVtcGVyYXR1cmUiLCAic2V0VGFyZ2V0VGVtcGVyYXR1cmUiXQogICAgY2xhc3MgSFRUUFJlcXVlc3RIYW5kbGVyKEJhc2VIVFRQUmVxdWVzdEhhbmRsZXIpOgogICAgICBkZWYgYWRkcmVzc19zdHJpbmcoc2VsZik6CiAgICAgICAgICBob3N0LCBwb3J0ID0gc2VsZi5jbGllbnRfYWRkcmVzc1s6Ml0KICAgICAgICAgIHJldHVybiBob3N0CiAgICAgIGRlZiBsb2dfcmVxdWVzdChzZWxmLCBjb2RlPU5vbmUsIHNpemU9Tm9uZSk6CiAgICAgICAgcGFzcwogICAgICBkZWYgbG9nX21lc3NhZ2Uoc2VsZiwgZm9ybWF0LCAqYXJncyk6CiAgICAgICAgcGFzcwogICAgICBkZWYgZG9fUE9TVChzZWxmKToKICAgICAgICBzZWxmLnBvc3R2YXJzID0gc2VsZi5wYXJzZV9QT1NUKCkKICAgICAgICBzZWxmLmRvX1JFUSgpCiAgICAgIGRlZiBwYXJzZV9QT1NUKHNlbGYpOgogICAgICAgIGZyb20gY2dpIGltcG9ydCBwYXJzZV9oZWFkZXIsIHBhcnNlX211bHRpcGFydAogICAgICAgIGZyb20gdXJscGFyc2UgaW1wb3J0IHBhcnNlX3FzCiAgICAgICAgY3R5cGUsIHBkaWN0ID0gcGFyc2VfaGVhZGVyKHNlbGYuaGVhZGVyc1snY29udGVudC10eXBlJ10pCiAgICAgICAgaWYgY3R5cGUgPT0gJ211bHRpcGFydC9mb3JtLWRhdGEnOgogICAgICAgICAgICBwb3N0dmFycyA9IHBhcnNlX211bHRpcGFydChzZWxmLnJmaWxlLCBwZGljdCkKICAgICAgICBlbGlmIGN0eXBlID09ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnOgogICAgICAgICAgICBsZW5ndGggPSBpbnQoc2VsZi5oZWFkZXJzWydjb250ZW50LWxlbmd0aCddKQogICAgICAgICAgICBwb3N0dmFycyA9IHBhcnNlX3FzKAogICAgICAgICAgICAgICAgICAgIHNlbGYucmZpbGUucmVhZChsZW5ndGgpLCAKICAgICAgICAgICAgICAgICAgICBrZWVwX2JsYW5rX3ZhbHVlcz0xKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHBvc3R2YXJzID0ge30KICAgICAgICByZXR1cm4gcG9zdHZhcnMKICAgICAgZGVmIGRvX0dFVChzZWxmKToKICAgICAgICBzZWxmLnBvc3R2YXJzID0gTm9uZQogICAgICAgIHNlbGYuZG9fUkVRKCkKICAgICAgZGVmIGRvX1JFUShzZWxmKToKICAgICAgICBhY2Nlc3NUb2tlbiA9IE5vbmUKICAgICAgICBtZXNzYWdlSWQgPSBOb25lCiAgICAgICAgdHJ5OgogICAgICAgICAgaWR4ID0gc2VsZi5wYXRoLmluZGV4KCI/IikKICAgICAgICAgIHNlbGYuY29tbWFuZCA9IHNlbGYucGF0aFsxOmlkeF0KICAgICAgICAgIHJlcVBhcmFtcyA9IHNlbGYuX2J1aWxkUmVxUGFyYW1NYXAoc2VsZi5wYXRoW2lkeCsxOl0pCiAgICAgICAgICBhY2Nlc3NUb2tlbiA9IHJlcVBhcmFtcy5nZXQoJ2FjY2Vzc1Rva2VuJykKICAgICAgICAgIG1lc3NhZ2VJZCA9IHJlcVBhcmFtcy5nZXQoJ21lc3NhZ2VJZCcpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICBzZWxmLmNvbW1hbmQgPSBzZWxmLnBhdGhbMTpdCiAgICAgICAgaWYgc2VsZi5jb21tYW5kID09ICdjb25maWcnOgogICAgICAgICAgaWYgYWNjZXNzVG9rZW4gIT0gc2VsZi5zZXJ2ZXIuYWNjZXNzVG9rZW46CiAgICAgICAgICAgIHNlbGYuc2VuZF9lcnJvcig0MDEsICdNaXNzaW5nIG9yIGludmFsaWQgYWNjZXNzIHRva2VuJykKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICBzZWxmLl9jb25maWcoKQogICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgbWVzc2FnZUlkIGlzIE5vbmU6CiAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UoIiIsICJVbmV4cGVjdGVkSW5mb3JtYXRpb25SZWNlaXZlZEVycm9yIikKICAgICAgICAgIHJldHVybgogICAgICAgIGlmIGFjY2Vzc1Rva2VuIGlzIE5vbmU6CiAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UobWVzc2FnZUlkLCAiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBhY2Nlc3NUb2tlbiAhPSBzZWxmLnNlcnZlci5hY2Nlc3NUb2tlbjoKICAgICAgICAgIHNlbGYuX3NlbmRKc29uRXJyb3JSZXNwb25zZShtZXNzYWdlSWQsICJJbnZhbGlkQWNjZXNzVG9rZW5FcnJvciIpCiAgICAgICAgICByZXR1cm4KICAgICAgICBpZiBzZWxmLmNvbW1hbmQgPT0gJ2NvbnRyb2wnOgogICAgICAgICAgdHJ5OgogICAgICAgICAgICByZXF1ZXN0ID0gcmVxUGFyYW1zWydyZXF1ZXN0J10KICAgICAgICAgICAgYXBwbGlhbmNlSWQgPSByZXFQYXJhbXNbJ2FwcGxpYW5jZUlkJ10KICAgICAgICAgICAgdmFsdWUgPSByZXFQYXJhbXMuZ2V0KCd2YWx1ZScsIE5vbmUpCiAgICAgICAgICBleGNlcHQgKEtleUVycm9yKToKICAgICAgICAgICAgc2VsZi5fc2VuZEpzb25FcnJvclJlc3BvbnNlKG1lc3NhZ2VJZCwgIlVuZXhwZWN0ZWRJbmZvcm1hdGlvblJlY2VpdmVkRXJyb3IiKQogICAgICAgICAgICByZXR1cm4KICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gc2VsZi5zZXJ2ZXIuY29udHJvbChtZXNzYWdlSWQsIGFwcGxpYW5jZUlkLCByZXF1ZXN0LCB2YWx1ZSkKICAgICAgICAgIHNlbGYuX3NlbmRKc29uUmVzcG9uc2UocmVzcG9uc2VPYmplY3QpCiAgICAgICAgZWxpZiBzZWxmLmNvbW1hbmQgPT0gJ2Rpc2NvdmVyeSc6CiAgICAgICAgICByZXNwb25zZU9iamVjdCA9IHNlbGYuc2VydmVyLmRpc2NvdmVyeShtZXNzYWdlSWQpCiAgICAgICAgICBzZWxmLl9zZW5kSnNvblJlc3BvbnNlKHJlc3BvbnNlT2JqZWN0KQogICAgICAgIGVsc2U6CiAgICAgICAgICBzZWxmLl9zZW5kSnNvbkVycm9yUmVzcG9uc2UobWVzc2FnZUlkLCAiVW5leHBlY3RlZEluZm9ybWF0aW9uUmVjZWl2ZWRFcnJvciIpCiAgICAgIGRlZiBfY29uZmlnKHNlbGYpOgogICAgICAgIGltcG9ydCBqc29uCiAgICAgICAgaWYgc2VsZi5wb3N0dmFycyBpcyBub3QgTm9uZToKICAgICAgICAgIGNvbmZMaXN0ID0gc2VsZi5wb3N0dmFycy5nZXQoJ2NvbmYnLCBOb25lKQogICAgICAgICAgaWYgY29uZkxpc3QgaXMgbm90IE5vbmU6CiAgICAgICAgICAgIHNlbGYuc2VydmVyLmxvZygiU2F2aW5nIGFwcGxpYW5jZXMgY29uZmlndXJhdGlvbiB0byB7MH0iLmZvcm1hdChzZWxmLnNlcnZlci5GSUxFUEFUSF9BUFBMSUFOQ0VTKSwgc2V2ZXJpdHk9ImluZm8iKQogICAgICAgICAgICBzZWxmLnNlcnZlci5jb25mID0ganNvbi5sb2Fkcyhjb25mTGlzdFswXSwgZW5jb2Rpbmc9Imlzbzg4NTktMSIpCiAgICAgICAgICAgIHdpdGggb3BlbihzZWxmLnNlcnZlci5GSUxFUEFUSF9BUFBMSUFOQ0VTLCAid2IiKSBhcyBvdXRwdXQ6CiAgICAgICAgICAgICAgb3V0cHV0LndyaXRlKGNvbmZMaXN0WzBdKQogICAgICAgIHNlbGYuc2VuZF9yZXNwb25zZSgyMDApCiAgICAgICAgc2VsZi5zZW5kX2hlYWRlcignQ29udGVudC1UeXBlJywgJ3RleHQvaHRtbDsgY2hhcnNldD1JU08tODg1OS0xJykKICAgICAgICBzZWxmLmVuZF9oZWFkZXJzKCkKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8aHRtbD48aGVhZD48bWV0YSBjaGFyc2V0PSdJU08tODg1OS0xJz48L2hlYWQ+PGJvZHk+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8Zm9ybSBtZXRob2Q9J3Bvc3QnIGVuY3R5cGU9J2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcgYWNjZXB0LWNoYXJzZXQ9J0lTTy04ODU5LTEnPiIpCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPHRhYmxlIHN0eWxlPSd3aWR0aDoxMDAlO2hlaWdodDoxMDAlJz48dHI+PHRkPjxoMT5BbWF6b24gRWNobyAtIEFwcGxpYW5jZXM8L2gxPjwvdGQ+PC90cj4iKQogICAgICAgIHNlbGYud2ZpbGUud3JpdGUoIjx0ciBzdHlsZT0naGVpZ2h0Ojk5JSc+PHRkPjx0ZXh0YXJlYSBuYW1lPSdjb25mJyBzdHlsZT0nd2lkdGg6MTAwJTtoZWlnaHQ6MTAwJSc+IikKICAgICAgICBpZiBzZWxmLnNlcnZlci5jb25mICE9ICIiOgogICAgICAgICAgcmVzcCA9IGpzb24uZHVtcHMoc2VsZi5zZXJ2ZXIuY29uZiwgZGVmYXVsdD1hc0RpY3QsIGVuY29kaW5nPSJpc284ODU5LTEiKQogICAgICAgIGVsc2U6CiAgICAgICAgICByZXNwID0gIiIKICAgICAgICBzZWxmLndmaWxlLndyaXRlKHJlc3ApCiAgICAgICAgc2VsZi53ZmlsZS53cml0ZSgiPC90ZXh0YXJlYT48L3RkPjwvdHI+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8dHI+PHRkPjxpbnB1dCB0eXBlPSdzdWJtaXQnLz48L3RkPjwvdHI+IikKICAgICAgICBzZWxmLndmaWxlLndyaXRlKCI8L2Zvcm0+PC9ib2R5PjwvaHRtbD4iKQogICAgICBkZWYgX3NlbmRKc29uRXJyb3JSZXNwb25zZShzZWxmLCBtZXNzYWdlSWQsIGVycm9yTWVzc2FnZSk6CiAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBOb25lCiAgICAgICAgaWYgc2VsZi5jb21tYW5kID09ICdjb250cm9sJzoKICAgICAgICAgIHJlc3BvbnNlT2JqZWN0ID0gQW1hem9uRWNoby5Db250cm9sUmVzcG9uc2UobWVzc2FnZUlkKQogICAgICAgIGVsaWYgc2VsZi5jb21tYW5kID09ICdkaXNjb3ZlcnknOgogICAgICAgICAgcmVzcG9uc2VPYmplY3QgPSBBbWF6b25FY2hvLkRpc2NvdmVyeVJlc3BvbnNlKG1lc3NhZ2VJZCkKICAgICAgICBlbHNlOgogICAgICAgICAgc2VsZi5zZW5kX2Vycm9yKDQwNCwgJ05vdCBGb3VuZCcpCiAgICAgICAgICByZXR1cm4KICAgICAgICByZXNwb25zZU9iamVjdC5zZXROYW1lKGVycm9yTWVzc2FnZSkKICAgICAgICBzZWxmLl9zZW5kSnNvblJlc3BvbnNlKHJlc3BvbnNlT2JqZWN0KQogICAgICBkZWYgX3NlbmRKc29uUmVzcG9uc2Uoc2VsZiwgcmVzcG9uc2VPYmplY3QpOgogICAgICAgIGltcG9ydCBqc29uCiAgICAgICAgcmVzcCA9IGpzb24uZHVtcHMocmVzcG9uc2VPYmplY3QsIGRlZmF1bHQ9YXNEaWN0LCBlbmNvZGluZz0iaXNvODg1OS0xIikKICAgICAgICBzZWxmLnNlbmRfcmVzcG9uc2UoMjAwKQogICAgICAgIHNlbGYuc2VuZF9oZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JykKICAgICAgICBzZWxmLmVuZF9oZWFkZXJzKCkKICAgICAgICBzZWxmLndmaWxlLndyaXRlKHJlc3ApCiAgICAgIGRlZiBfYnVpbGRSZXFQYXJhbU1hcChzZWxmLCBxdWVyeSk6CiAgICAgICAgaW1wb3J0IHVybGxpYgogICAgICAgIHJlcV9wYXJhbXMgPSB7fQogICAgICAgIHBhcmFtcyA9IHF1ZXJ5LnNwbGl0KCcmJykKICAgICAgICBmb3IgcGFyYW0gaW4gcGFyYW1zOgogICAgICAgICAgaWR4ID0gcGFyYW0uZmluZCgnPScpCiAgICAgICAgICByZXFfcGFyYW1zW3BhcmFtWzA6aWR4XV0gPSB1cmxsaWIudW5xdW90ZV9wbHVzKHBhcmFtW2lkeCArIDE6XSkKICAgICAgICByZXR1cm4gcmVxX3BhcmFtcwogICAgZGVmIHN0YXJ0KHNlbGYpOgogICAgICBzZWxmLmxvZygiU3RhcnQgIiwgc2V2ZXJpdHk9ImluZm8iKQogICAgICBpZiBzZWxmLnNlcnZlclRocmVhZCBpcyBOb25lOgogICAgICAgIEhUVFBTZXJ2ZXIuX19pbml0X18oc2VsZiwgKHNlbGYuaXAsIHNlbGYucG9ydCksIHNlbGYuSFRUUFJlcXVlc3RIYW5kbGVyKQogICAgICAgIGlmIHNlbGYuY2VydFRleHQgIT0gIiI6CiAgICAgICAgICB3aXRoIG9wZW4oc2VsZi5GSUxFUEFUSF9DRVJULCAid2IiKSBhcyBvdXRwdXQ6CiAgICAgICAgICAgIG91dHB1dC53cml0ZShzZWxmLmNlcnRUZXh0KQogICAgICAgICAgaW1wb3J0IHNzbAogICAgICAgICAgc2VsZi5zb2NrZXQgPSBzc2wud3JhcF9zb2NrZXQoc2VsZi5zb2NrZXQsIGNlcnRmaWxlPXNlbGYuRklMRVBBVEhfQ0VSVCwgc2VydmVyX3NpZGU9VHJ1ZSkKICAgICAgICBmcm9tIGhzX3F1ZXVlIGltcG9ydCBoc190aHJlYWRpbmcgYXMgdGhyZWFkaW5nCiAgICAgICAgc2VsZi5zZXJ2ZXJUaHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldD1zZWxmLnNlcnZlX2ZvcmV2ZXIsIG5hbWU9J2FtYXpvbl9lY2hvX3NlcnZlcicpCiAgICAgICAgc2VsZi5zZXJ2ZXJUaHJlYWQuZGFlbW9uID0gVHJ1ZQogICAgICAgIHNlbGYuc2VydmVyVGhyZWFkLnN0YXJ0KCkKICAgIGRlZiBzdG9wKHNlbGYpOgogICAgICBzZWxmLmxvZygiU3RvcCAiLCBzZXZlcml0eT0iaW5mbyIpCiAgICAgIGlmIG5vdCBzZWxmLnNlcnZlclRocmVhZCBpcyBOb25lOgogICAgICAgIEhUVFBTZXJ2ZXIuc2h1dGRvd24oc2VsZikKICAgICAgICBzZWxmLnNvY2tldC5jbG9zZSgpCiAgICAgICAgc2VsZi5zZXJ2ZXJUaHJlYWQgPSBOb25lCiAgICBkZWYgZ2V0U1NMQ2VydChzZWxmLCBpcCwgY2VydEZpbGVuYW1lKToKICAgICAgdHJ5OgogICAgICAgIGltcG9ydCB1cmxsaWIyCiAgICAgICAgdXJsID0gImh0dHA6Ly97MH0vb3B0L3sxfSIuZm9ybWF0KGlwLCBjZXJ0RmlsZW5hbWUpCiAgICAgICAgcmVxID0gdXJsbGliMi5SZXF1ZXN0KHVybCkKICAgICAgICByZXMgPSB1cmxsaWIyLnVybG9wZW4ocmVxKQogICAgICAgIGlmIHJlcy5nZXRjb2RlKCkgPT0gMjAwOgogICAgICAgICAgcmV0dXJuIHJlcy5mcC5yZWFkKCkKICAgICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgICAgcmV0dXJuICIiCiAgICBkZWYgd2ViQ2FsbGJhY2tTU0xDZXJ0KHNlbGYsIHN0cmVhbT1GYWxzZSk6CiAgICAgIGh0bWwgPSAiPGh0bWw+PGhlYWQ+IgogICAgICBodG1sICs9ICI8bWV0YSBjaGFyc2V0PSdJU08tODg1OS0xJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdjYWNoZS1jb250cm9sJyBjb250ZW50PSdtYXgtYWdlPTAnLz4iCiAgICAgIGh0bWwgKz0gIjxtZXRhIGh0dHAtZXF1aXY9J2NhY2hlLWNvbnRyb2wnIGNvbnRlbnQ9J25vLWNhY2hlJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdleHBpcmVzJyBjb250ZW50PScwJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdleHBpcmVzJyBjb250ZW50PSdUdWUsIDAxIEphbiAxOTgwIDE6MDA6MDAgR01UJy8+IgogICAgICBodG1sICs9ICI8bWV0YSBodHRwLWVxdWl2PSdwcmFnbWEnIGNvbnRlbnQ9J25vLWNhY2hlJy8+IgogICAgICBodG1sICs9ICI8L2hlYWQ+PGJvZHk+IgogICAgICBodG1sICs9ICI8aDE+QW1hem9uIEVjaG8gLSBTU0wgQ2VydGlmaWNhdGU8L2gxPiIKICAgICAgaHRtbCArPSAiPHByZT48Y29kZT4iCiAgICAgIGh0bWwgKz0gc2VsZi5jZXJ0VGV4dAogICAgICBodG1sICs9ICI8L3ByZT48L2NvZGU+IgogICAgICBodG1sICs9ICI8L2JvZHk+PC9odG1sPiIKICAgICAgaWYgc3RyZWFtOgogICAgICAgICAgc3RyZWFtLndyaXRlKGh0bWwpCiAgICAgIHNlbGYuRGF0TGVuID0gbGVuKGh0bWwpCiAgICBkZWYgaW5pdF9kZWJ1Z19lbnRyeShzZWxmKToKICAgICAgcHJvdG8gPSAiaHR0cCIKICAgICAgaWYgc2VsZi5jZXJ0VGV4dCAhPSAiIjoKICAgICAgICBwcm90byA9ICJodHRwcyIKICAgICAgaW1wb3J0IHVybGxpYgogICAgICBzZWxmLk1DLkRlYnVnLmFkZEdydXBwZSgKICAgICAgICBbc2VsZi5pZCwgc2VsZi5pZF0sCiAgICAgICAgICBbIAogICAgICAgICAgICBbIjBWRVJTSU9OSU5GTyIsIlZlcnNpb24iLDEsJ1YwLjEgLSAoMjAxNi0xMS0yNSAxMzo1OCknXSwKICAgICAgICAgICAgWyIxUE9SVCIsIlBvcnQiLDEsc3RyKHNlbGYucG9ydCldLAogICAgICAgICAgICBbIjJTU0wiLCJTU0wtQ2VydGlmaWNhdGUiLDEsIjxhIGhyZWY9Jy9vcHQvezB9Jz5zaG93PC9hPjxicj4iLmZvcm1hdChzZWxmLlVSTF9TSE9XX1NTTCldLAogICAgICAgICAgICBbIjNDT05GSUciLCJBcHBsaWFuY2VzIGNvbmZpZ3VyYXRpb24iLDEsIjxhIGhyZWY9J3swfTovL3sxfTp7Mn0vY29uZmlnP2FjY2Vzc1Rva2VuPXszfSc+ZWRpdDwvYT48YnI+Ii5mb3JtYXQocHJvdG8sIHNlbGYuaXAsIHNlbGYucG9ydCwgdXJsbGliLnF1b3RlX3BsdXMoc2VsZi5hY2Nlc3NUb2tlbikpXSwKICAgICAgICAgIF0gICAKICAgICAgKQogICAgZGVmIGRlYnVnKHNlbGYsIG1zZywgbHZsPTUpOgogICAgICBpbXBvcnQgdGltZQogICAgICBzZWxmLmxvZyhtc2csIHNldmVyaXR5PSdkZWJ1ZycpCiAgICAgIHByaW50ICIlcyBERUJVRzogJXIiICUgKHRpbWUuc3RyZnRpbWUoIiVIOiVNOiVTIiksIG1zZywgKQogICAgZGVmIGxvZyhzZWxmLCBtc2csIHNldmVyaXR5PSdpbmZvJyk6CiAgICAgIGltcG9ydCB0aW1lCiAgICAgIGZyb20gaGFzaGxpYiBpbXBvcnQgbWQ1CiAgICAgIF9tc2dfdWlkID0gbWQ1KCAiJXMlcyIgJSAoIHNlbGYuaWQsIHRpbWUudGltZSgpICkgKS5oZXhkaWdlc3QoKQogICAgICBfbXNnID0gJzxsb2c+PGlkPiVzPC9pZD48ZmFjaWxpdHk+QW1hem9uX0VjaG9fU2VydmVyPC9mYWNpbGl0eT48c2V2ZXJpdHk+JXM8L3NldmVyaXR5PjxtZXNzYWdlPiVzPC9tZXNzYWdlPjwvbG9nPicgJSAoX21zZ191aWQsIHNldmVyaXR5LCBtc2cpCiAgICAgIHNlbGYuc2VuZFRvT3V0cHV0KDEsX21zZykKICAgIGRlZiBzZW5kVG9PdXRwdXQoc2VsZiwgb3V0LCBtc2cpOgogICAgICBvdXQgLT0gMQogICAgICBzZWxmLmxvY2Fsc1siQU4iXVtvdXRdID0gbXNnCiAgICAgIHNlbGYubG9jYWxzWyJBQyJdW291dF0gPSAxICAK'),'<10013_Amazon Echo (10013)>','exec'))"|""|0|0|0|0
## MD5 der Formelzeile: fb01968ba9c84e34fc45daff1c47075d
### Klasse AmazonEcho
################################
## Quelltext nicht Öffentlich ##
################################




## Klasse auf SN1 
5012|1|"EI"|"1"|"10"|0|1|0|0
5012|0|"OC[1]"|"AmazonEcho(locals())"|""|0|0|1|0

#5012|abbruch bei bed. (0/1)|bedingung|formel|zeit|pin-ausgang|pin-offset|pin-speicher|pin-neg.ausgang
5012|0|"(OC[1] or EC[1]) and EN[1]"|"SN[1].start()"|""|0|0|0|0
5012|0|"EC[1] and not EN[1]"|"SN[1].stop()"|""|0|0|0|0



